<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Sample size justification | Improving Your Statistical Inferences</title>
<meta name="author" content="Daniel Lakens">
<meta name="description" content="Scientists perform empirical studies to collect data that helps to answer a research question. The more data that is collected, the more informative the study will be with respect to its...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 8 Sample size justification | Improving Your Statistical Inferences">
<meta property="og:type" content="book">
<meta property="og:description" content="Scientists perform empirical studies to collect data that helps to answer a research question. The more data that is collected, the more informative the study will be with respect to its...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Sample size justification | Improving Your Statistical Inferences">
<meta name="twitter:description" content="Scientists perform empirical studies to collect data that helps to answer a research question. The more data that is collected, the more informative the study will be with respect to its...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Improving Your Statistical Inferences</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="pvalue.html"><span class="header-section-number">1</span> Using p-values to test a hypothesis</a></li>
<li><a class="" href="errorcontrol.html"><span class="header-section-number">2</span> Error control</a></li>
<li><a class="" href="likelihoods.html"><span class="header-section-number">3</span> Likelihoods</a></li>
<li><a class="" href="bayes.html"><span class="header-section-number">4</span> Bayesian statistics</a></li>
<li><a class="" href="questions.html"><span class="header-section-number">5</span> Asking Statistical Questions</a></li>
<li><a class="" href="effectsize.html"><span class="header-section-number">6</span> Effect Sizes</a></li>
<li><a class="" href="confint.html"><span class="header-section-number">7</span> Confidence Intervals</a></li>
<li><a class="active" href="power.html"><span class="header-section-number">8</span> Sample size justification</a></li>
<li><a class="" href="references.html"><span class="header-section-number">9</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/Lakens/statistical_inferences">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="power" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Sample size justification<a class="anchor" aria-label="anchor" href="#power"><i class="fas fa-link"></i></a>
</h1>
<p>Scientists perform empirical studies to collect data that helps to answer a research question. The more data that is collected, the more informative the study will be with respect to its inferential goals. A sample size justification should consider how informative the data will be given an inferential goal, such as estimating an effect size, or testing a hypothesis. Even though a sample size justification is sometimes requested in manuscript submission guidelines, when submitting a grant to a funder, or submitting a proposal to an ethical review board, the number of observations is often simply <em>stated</em>, but not <em>justified</em>. This makes it difficult to evaluate how informative a study will be. To prevent such concerns from emerging when it is too late (e.g., after a non-significant hypothesis test has been observed), researchers should carefully justify their sample size before data is collected.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table-pow-just">Table 8.1: </span>Overview of possible justifications for the sample size in a study.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
<div id="six-approaches-to-justify-sample-sizes" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Six Approaches to Justify Sample Sizes<a class="anchor" aria-label="anchor" href="#six-approaches-to-justify-sample-sizes"><i class="fas fa-link"></i></a>
</h2>
<p>Researchers often find it difficult to justify their sample size (i.e., a number of participants, observations, or any combination thereof). In this review article six possible approaches are discussed that can be used to justify the sample size in a quantitative study (see Table <a href="power.html#tab:table-pow-just">8.1</a>). This is not an exhaustive overview, but it includes the most common and applicable approaches for single studies.<a href="references.html#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The first justification is that data from (almost) the entire population has been collected. The second justification centers on resource constraints, which are almost always present, but rarely explicitly evaluated. The third and fourth justifications are based on a desired statistical power or a desired accuracy. The fifth justification relies on heuristics, and finally, researchers can choose a sample size without any justification. Each of these justifications can be stronger or weaker depending on which conclusions researchers want to draw from the data they plan to collect.</p>
<p>All of these approaches to the justification of sample sizes, even the 'no justification' approach, give others insight into the reasons that led to the decision for a sample size in a study. It should not be surprising that the 'heuristics' and 'no justification' approaches are often unlikely to impress peers. However, it is important to note that the value of the information that is collected depends on the extent to which the final sample size allows a researcher to achieve their inferential goals, and not on the sample size justification that is chosen.</p>
<p>The extent to which these approaches make other researchers judge the data that is collected as <em>informative</em> depends on the details of the question a researcher aimed to answer and the parameters they chose when determining the sample size for their study. For example, a badly performed a-priori power analysis can quickly lead to a study with very low informational value. These six justifications are not mutually exclusive, and multiple approaches can be considered when designing a study.</p>
</div>
<div id="six-ways-to-evaluate-which-effect-sizes-are-interesting" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Six Ways to Evaluate Which Effect Sizes are Interesting<a class="anchor" aria-label="anchor" href="#six-ways-to-evaluate-which-effect-sizes-are-interesting"><i class="fas fa-link"></i></a>
</h2>
<p>The informativeness of the data that is collected depends on the inferential goals a researcher has, or in some cases, the inferential goals scientific peers will have. A shared feature of the different inferential goals considered in this review article is the question which effect sizes a researcher considers meaningful to distinguish. This implies that researchers need to evaluate which effect sizes they consider interesting. These evaluations rely on a combination of statistical properties and domain knowledge. In Table <a href="power.html#tab:table-effect-eval">8.2</a> six possibly useful considerations are provided. This is not intended to be an exhaustive overview, but it presents common and useful approaches that can be applied in practice. Not all evaluations are equally relevant for all types of sample size justifications. The online Shiny app accompanying this manuscript provides researchers with an interactive form that guides researchers through the considerations for a sample size justification. These considerations often rely on the same information (e.g., effect sizes, the number of observations, the standard deviation, etc.) so these six considerations should be seen as a set of complementary approaches that can be used to evaluate which effect sizes are of interest.</p>
<p>To start, researchers should consider what their smallest effect size of interest is. Second, although only relevant when performing a hypothesis test, researchers should consider which effect sizes could be statistically significant given a choice of an alpha level and sample size. Third, it is important to consider the (range of) effect sizes that are expected. This requires a careful consideration of the source of this expectation and the presence of possible biases in these expectations. Fourth, it is useful to consider the width of the confidence interval around possible values of the effect size in the population, and whether we can expect this confidence interval to reject effects we considered a-priori plausible. Fifth, it is worth evaluating the power of the test across a wide range of possible effect sizes in a sensitivity power analysis. Sixth, a researcher can consider the effect size distribution of related studies in the literature.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table-effect-eval">Table 8.2: </span>Overview of possible ways to evaluate which effect sizes are interesting.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="the-value-of-information" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> The Value of Information<a class="anchor" aria-label="anchor" href="#the-value-of-information"><i class="fas fa-link"></i></a>
</h2>
<p>Since all scientists are faced with resource limitations, they need to balance the cost of collecting each additional datapoint against the increase in information that datapoint provides. This is referred to as the <em>value of information</em> <span class="citation">(<a href="references.html#ref-eckermann_value_2010" role="doc-biblioref">Eckermann et al., 2010</a>)</span>. Calculating the value of information is notoriously difficult <span class="citation">(<a href="references.html#ref-detsky_using_1990" role="doc-biblioref">Detsky, 1990</a>)</span>. Researchers need to specify the cost of collecting data, and weigh the costs of data collection against the increase in utility that having access to the data provides. From a value of information perspective not every data point that can be collected is equally valuable <span class="citation">(<a href="references.html#ref-halpern_sample_2001" role="doc-biblioref">J. Halpern et al., 2001</a>; <a href="references.html#ref-wilson_practical_2015" role="doc-biblioref">Wilson, 2015</a>)</span>. Whenever additional observations do not change inferences in a meaningful way, the costs of data collection can outweigh the benefits.</p>
<p>The value of additional information will in most cases be a non-monotonic function, especially when it depends on multiple inferential goals. A researcher might be interested in comparing an effect against a previously observed large effect in the literature, a theoretically predicted medium effect, and the smallest effect that would be practically relevant. In such a situation the expected value of sampling information will lead to different optimal sample sizes for each inferential goal. It could be valuable to collect informative data about a large effect, with additional data having less (or even a negative) marginal utility, up to a point where the data becomes increasingly informative about a medium effect size, with the value of sampling additional information decreasing once more until the study becomes increasingly informative about the presence or absence of a smallest effect of interest.</p>
<!-- ```{r, non-monotonic, fig.cap="Example of a non-monotonically increasing value of information as a function of the sample size."} -->
<!-- plot(-1000, xlim = c(0,1600), ylim = c(0,1000), xlab = "Sample Size", ylab = "Value of Information", main = "", cex.lab = 1.3, cex.axis = 1.2, yaxt ='n') -->
<!-- g <- function(x) x/2 + 110 * sin(0.01 * x) -->
<!-- curve(g, 0, 1600, lwd = 3, add = TRUE) -->
<!-- ``` -->
<p>Because of the difficulty of quantifying the value of information, scientists typically use less formal approaches to justify the amount of data they set out to collect in a study. Even though the cost-benefit analysis is not always made explicit in reported sample size justifications, the value of information perspective is almost always implicitly the underlying framework that sample size justifications are based on. Throughout the subsequent discussion of sample size justifications, the importance of considering the value of information given inferential goals will repeatedly be highlighted.</p>
</div>
<div id="measuring-almost-the-entire-population" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Measuring (Almost) the Entire Population<a class="anchor" aria-label="anchor" href="#measuring-almost-the-entire-population"><i class="fas fa-link"></i></a>
</h2>
<p>In some instances it might be possible to collect data from (almost) the entire population under investigation. For example, researchers might use census data, are able to collect data from all employees at a firm or study a small population of top athletes. Whenever it is possible to measure the entire population, the sample size justification becomes straightforward: the researcher used all the data that is available.</p>
</div>
<div id="resource-constraints" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Resource Constraints<a class="anchor" aria-label="anchor" href="#resource-constraints"><i class="fas fa-link"></i></a>
</h2>
<p>A common reason for the number of observations in a study is that resource constraints limit the amount of data that can be collected at a reasonable cost <span class="citation">(<a href="references.html#ref-lenth_practical_2001" role="doc-biblioref">Lenth, 2001</a>)</span>. In practice, sample sizes are always limited by the resources that are available. Researchers practically always have resource limitations, and therefore even when resource constraints are not the primary justification for the sample size in a study, it is always a secondary justification.</p>
<p>Despite the omnipresence of resource limitations, the topic often receives little attention in texts on experimental design (for an example of an exception, see <span class="citation">Bulus &amp; Dong (<a href="references.html#ref-bulus_bound_2021" role="doc-biblioref">2021</a>)</span>). This might make it feel like acknowledging resource constraints is not appropriate, but the opposite is true: Because resource limitations always play a role, a responsible scientist carefully evaluates resource constraints when designing a study. Resource constraint justifications are based on a trade-off between the costs of data collection, and the value of having access to the information the data provides. Even if researchers do not explicitly quantify this trade-off, it is revealed in their actions. For example, researchers rarely spend all the resources they have on a single study. Given resource constraints, researchers are confronted with an optimization problem of how to spend resources across multiple research questions.</p>
<p>Time and money are two resource limitations all scientists face. A PhD student has a certain time to complete a PhD thesis, and is typically expected to complete multiple research lines in this time. In addition to time limitations, researchers have limited financial resources that often directly influence how much data can be collected. A third limitation in some research lines is that there might simply be a very small number of individuals from whom data can be collected, such as when studying patients with a rare disease. A resource constraint justification puts limited resources at the center of the justification for the sample size that will be collected, and <em>starts</em> with the resources a scientist has available. These resources are translated into an expected number of observations (<em>N</em>) that a researcher expects they will be able to collect with an amount of money in a given time. The challenge is to evaluate whether collecting <em>N</em> observations is worthwhile. How do we decide if a study will be informative, and when should we conclude that data collection is <em>not</em> worthwhile?</p>
<p>When evaluating whether resource constraints make data collection uninformative, researchers need to explicitly consider which inferential goals they have when collecting data <span class="citation">(<a href="references.html#ref-parker_sample_2003" role="doc-biblioref">Parker &amp; Berman, 2003</a>)</span>. Having data always provides more knowledge about the research question than not having data, so in an absolute sense, all data that is collected has value. However, it is possible that the benefits of collecting the data are outweighed by the costs of data collection.</p>
<p>It is most straightforward to evaluate whether data collection has value when we know for certain that someone will make a decision, with or without data. In such situations any additional data will reduce the error rates of a well-calibrated decision process, even if only ever so slightly. For example, without data we will not perform better than a coin flip if we guess which of two conditions has a higher true mean score on a measure. With some data, we can perform better than a coin flip by picking the condition that has the highest mean. With a small amount of data we would still very likely make a mistake, but the error rate is smaller than without any data. In these cases, the value of information might be positive, as long as the reduction in error rates is more beneficial than the cost of data collection.</p>
<p>Another way in which a small dataset can be valuable is if its existence eventually makes it possible to perform a meta-analysis <span class="citation">(<a href="references.html#ref-maxwell_ethics_2011" role="doc-biblioref">Maxwell &amp; Kelley, 2011</a>)</span>. This argument in favor of collecting a small dataset requires 1) that researchers share the data in a way that a future meta-analyst can find it, and 2) that there is a decent probability that someone will perform a high-quality meta-analysis that will include this data in the future <span class="citation">(<a href="references.html#ref-halpern_continuing_2002" role="doc-biblioref">S. D. Halpern et al., 2002</a>)</span>. The uncertainty about whether there will ever be such a meta-analysis should be weighed against the costs of data collection.</p>
<p>One way to increase the probability of a future meta-analysis is if researchers commit to performing this meta-analysis themselves, by combining several studies they have performed into a small-scale meta-analysis <span class="citation">(<a href="references.html#ref-cumming_new_2014" role="doc-biblioref">Cumming, 2014</a>)</span>. For example, a researcher might plan to repeat a study for the next 12 years in a class they teach, with the expectation that after 12 years a meta-analysis of 12 studies would be sufficient to draw informative inferences (but see <span class="citation">ter Schure &amp; Gr√ºnwald (<a href="references.html#ref-ter_schure_accumulation_2019" role="doc-biblioref">2019</a>)</span>). If it is not plausible that a researcher will collect all the required data by themselves, they can attempt to set up a collaboration where fellow researchers in their field commit to collecting similar data with identical measures. If it is not likely that sufficient data will emerge over time to reach the inferential goals, there might be no value in collecting the data.</p>
<p>Even if a researcher believes it is worth collecting data because a future meta-analysis will be performed, they will most likely perform a statistical test on the data. To make sure their expectations about the results of such a test are well-calibrated, it is important to consider which effect sizes are of interest, and to perform a sensitivity power analysis to evaluate the probability of a Type II error for effects of interest. From the six ways to evaluate which effect sizes are interesting that will be discussed in the second part of this review, it is useful to consider the smallest effect size that can be statistically significant, the expected width of the confidence interval around the effect size, and effects that can be expected in a specific research area, and to evaluate the power for these effect sizes in a sensitivity power analysis. If a decision or claim is made, a compromise power analysis is worthwhile to consider when deciding upon the error rates while planning the study. When reporting a resource constraints sample size justification it is recommended to address the five considerations in Table <a href="power.html#tab:table-pow-rec">8.3</a>. Addressing these points explicitly facilitates evaluating if the data is worthwhile to collect. To make it easier to address all relevant points explicitly, an interactive form to implement the recommendations in this manuscript can be found at <a href="https://shiny.ieis.tue.nl/sample_size_justification/" class="uri">https://shiny.ieis.tue.nl/sample_size_justification/</a>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table-pow-rec">Table 8.3: </span>Overview of recommendations when reporting a sample size justification based on resource constraints.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="a-priori-power-analysis" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> A-priori Power Analysis<a class="anchor" aria-label="anchor" href="#a-priori-power-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>When designing a study where the goal is to test whether a statistically significant effect is present, researchers often want to make sure their sample size is large enough to prevent erroneous conclusions for a range of effect sizes they care about. In this approach to justifying a sample size, the value of information is to collect observations up to the point that the probability of an erroneous inference is, in the long run, not larger than a desired value. If a researcher performs a hypothesis test, there are four possible outcomes:</p>
<ol style="list-style-type: decimal">
<li>A false positive (or Type I error), determined by the <span class="math inline">\(\alpha\)</span> level. A test yields a significant result, even though the null hypothesis is true.</li>
<li>A false negative (or Type II error), determined by <span class="math inline">\(\beta\)</span>, or 1 - power. A test yields a non-significant result, even though the alternative hypothesis is true.</li>
<li>A true negative, determined by 1-<span class="math inline">\(\alpha\)</span>. A test yields a non-significant result when the null hypothesis is true.</li>
<li>A true positive, determined by 1-<span class="math inline">\(\beta\)</span>. A test yields a significant result when the alternative hypothesis is true.</li>
</ol>
<p>Given a specified effect size, alpha level, and power, an a-priori power analysis can be used to calculate the number of observations required to achieve the desired error rates, given the effect size.<a href="references.html#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Figure <a href="power.html#fig:power-2">8.1</a> illustrates how the statistical power increases as the number of observations (per group) increases in an independent <em>t</em> test with a two-sided alpha level of 0.05. If we are interested in detecting an effect of <em>d</em> = 0.5, a sample size of 90 per condition would give us more than 90% power. Statistical power can be computed to determine the number of participants, or the number of items <span class="citation">(<a href="references.html#ref-westfall_statistical_2014" role="doc-biblioref">Westfall et al., 2014</a>)</span> but can also be performed for single case studies <span class="citation">(<a href="references.html#ref-ferron_power_1996" role="doc-biblioref">Ferron &amp; Onghena, 1996</a>; <a href="references.html#ref-mcintosh_power_2020" role="doc-biblioref">McIntosh &amp; Rittmo, 2020</a>)</span></p>
<p>Although it is common to set the Type I error rate to 5% and aim for 80% power, error rates should be justified <span class="citation">(<a href="references.html#ref-lakens_justify_2018" role="doc-biblioref">Lakens, Adolfi, et al., 2018</a>)</span>. As explained in the section on compromise power analysis, the default recommendation to aim for 80% power lacks a solid justification. In general, the lower the error rates (and thus the higher the power), the more informative a study will be, but the more resources are required. Researchers should carefully weigh the costs of increasing the sample size against the benefits of lower error rates, which would probably make studies designed to achieve a power of 90% or 95% more common for articles reporting a single study. An additional consideration is whether the researcher plans to publish an article consisting of a set of replication and extension studies, in which case the probability of observing multiple Type I errors will be very low, but the probability of observing mixed results even when there is a true effect increases <span class="citation">(<a href="references.html#ref-lakens_too_2017" role="doc-biblioref">Lakens &amp; Etz, 2017</a>)</span>, which would also be a reason to aim for studies with low Type II error rates, perhaps even by slightly increasing the alpha level for each individual study.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:power-2"></span>
<img src="08-samplesizejustification_files/figure-html/power-2-1.png" alt="Power curve for an independent *t* test with an effect of *d* = 0.5 and $\alpha$ = 0.05 as a function of the sample size." width="100%"><p class="caption">
Figure 8.1: Power curve for an independent <em>t</em> test with an effect of <em>d</em> = 0.5 and <span class="math inline">\(\alpha\)</span> = 0.05 as a function of the sample size.
</p>
</div>
<p>Figure <a href="power.html#fig:power-3">8.2</a> visualizes two distributions. The left distribution (dashed line) is centered at 0. This is a model for the null hypothesis. If the null hypothesis is true a statistically significant result will be observed if the effect size is extreme enough (in a two-sided test either in the positive or negative direction), but any significant result would be a Type I error (the dark grey areas under the curve). If there is no true effect, formally statistical power for a null hypothesis significance test is undefined. Any significant effects observed if the null hypothesis is true are Type I errors, or false positives, which occur at the chosen alpha level. The right distribution (solid line) is centered on an effect of <em>d</em> = 0.5. This is the specified model for the alternative hypothesis in this study, illustrating the expectation of an effect of <em>d</em> = 0.5 if the alternative hypothesis is true. Even though there is a true effect, studies will not always find a statistically significant result. This happens when, due to random variation, the observed effect size is too close to 0 to be statistically significant. Such results are false negatives (the light grey area under the curve on the right). To increase power, we can collect a larger sample size. As the sample size increases, the distributions become more narrow, reducing the probability of a Type II error.<a href="references.html#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">p_upper</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">ncp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">d</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># Calculate non-centrality parameter d</span>
<span class="va">crit_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">p_upper</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">low_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">-</span> <span class="va">crit_d</span><span class="op">)</span>
<span class="va">high_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">d</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">crit_d</span><span class="op">)</span>
<span class="co"># calc d-distribution</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">low_x</span>, <span class="va">high_x</span>, length <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="co"># create x values</span>
<span class="co"># Set max Y for graph</span>
<span class="va">d_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, df <span class="op">=</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, ncp <span class="op">=</span> <span class="va">ncp</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># calculate distribution of d based on t-distribution</span>
<span class="va">y_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">d_dist</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>
<span class="co"># create plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">low_x</span>, <span class="va">high_x</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">y_max</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Cohen's d"</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, main <span class="op">=</span> <span class="st">""</span>, cex.lab <span class="op">=</span> <span class="fl">1.3</span>, cex.axis <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>
<span class="co"># abline(v = seq(low_x,high_x,0.1), h = seq(0,0.5,0.1), col = "lightgrey", lty = 1)</span>
<span class="co">#    axis(side = 1, at = seq(low_x,high_x,0.1), labels = FALSE)</span>
<span class="co"># Add Type I error rate right</span>
<span class="va">crit_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">p_upper</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">crit_d</span>, <span class="fl">10</span>, length <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, df <span class="op">=</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># determine upperbounds polygon</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">crit_d</span>, <span class="va">y</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">z</span>, <span class="fl">0</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Add Type I error rate left</span>
<span class="va">crit_d</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">p_upper</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="va">crit_d</span>, length <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, df <span class="op">=</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># determine upperbounds polygon</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">crit_d</span>, <span class="va">crit_d</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Add Type II error rate</span>
<span class="va">crit_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">p_upper</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="va">crit_d</span>, length <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, df <span class="op">=</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, ncp <span class="op">=</span> <span class="va">ncp</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># determine upperbounds polygon</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">crit_d</span>, <span class="va">crit_d</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">z</span>, <span class="fl">0</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span><span class="op">)</span>, border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>
<span class="co"># add d = 0 line</span>
<span class="va">d_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, df <span class="op">=</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, ncp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">d_dist</span>, col <span class="op">=</span> <span class="st">"grey40"</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co"># add effect line</span>
<span class="va">d_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, df <span class="op">=</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, ncp <span class="op">=</span> <span class="va">ncp</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># calculate distribution of d based on t-distribution</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">d_dist</span>, col <span class="op">=</span> <span class="st">"black"</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:power-3"></span>
<img src="08-samplesizejustification_files/figure-html/power-3-1.png" alt="Null (*d* = 0, grey dashed line) and alternative (*d* = 0.5, solid black line) hypothesis, with $\alpha$ = 0.05 and n = 80 per group." width="100%"><p class="caption">
Figure 8.2: Null (<em>d</em> = 0, grey dashed line) and alternative (<em>d</em> = 0.5, solid black line) hypothesis, with <span class="math inline">\(\alpha\)</span> = 0.05 and n = 80 per group.
</p>
</div>
<p>It is important to highlight that the goal of an a-priori power analysis is <em>not</em> to achieve sufficient power for the true effect size. The true effect size is unknown. The goal of an a-priori power analysis is to achieve sufficient power, given a specific <em>assumption</em> of the effect size a researcher wants to detect. Just like a Type I error rate is the maximum probability of making a Type I error conditional on the assumption that the null hypothesis is true, an a-priori power analysis is computed under the assumption of a specific effect size. It is unknown if this assumption is correct. All a researcher can do is to make sure their assumptions are well justified. Statistical inferences based on a test where the Type II error is controlled are conditional on the assumption of a specific effect size. They allow the inference that, assuming the true effect size is at least as large as that used in the a-priori power analysis, the maximum Type II error rate in a study is not larger than a desired value.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pow_eq</span> <span class="op">&lt;-</span> <span class="fu">TOSTER</span><span class="fu">::</span><span class="fu"><a href="https://aaroncaldwell.us/TOSTERpkg/reference/powerTOSTtwo.html">powerTOSTtwo</a></span><span class="op">(</span>
  alpha <span class="op">=</span> <span class="fl">0.05</span>, 
  statistical_power <span class="op">=</span> <span class="fl">0.9</span>, 
  low_eqbound_d <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span>, 
  high_eqbound_d <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></code></pre></div>
<p>This point is perhaps best illustrated if we consider a study where an a-priori power analysis is performed both for a test of the <em>presence</em> of an effect, as for a test of the <em>absence</em> of an effect. When designing a study, it essential to consider the possibility that there is no effect (e.g., a mean difference of zero). An a-priori power analysis can be performed both for a null hypothesis significance test, as for a test of the absence of a meaningful effect, such as an equivalence test that can statistically provide support for the null hypothesis by rejecting the presence of effects that are large enough to matter <span class="citation">(<a href="references.html#ref-lakens_equivalence_2017" role="doc-biblioref">Lakens, 2017</a>; <a href="references.html#ref-meyners_equivalence_2012" role="doc-biblioref">Meyners, 2012</a>; <a href="references.html#ref-rogers_using_1993" role="doc-biblioref">Rogers et al., 1993</a>)</span>. When multiple primary tests will be performed based on the same sample, each analysis requires a dedicated sample size justification. If possible, a sample size is collected that guarantees that all tests are informative, which means that the collected sample size is based on the largest sample size returned by any of the a-priori power analyses.</p>
<p>For example, if the goal of a study is to detect or reject an effect size of <em>d</em> = 0.4 with 90% power, and the alpha level is set to 0.05 for a two-sided independent <em>t</em> test, a researcher would need to collect 133 participants in each condition for an informative null hypothesis test, and 136 participants in each condition for an informative equivalence test. Therefore, the researcher should aim to collect 272 participants in total for an informative result for both tests that are planned. This does not guarantee a study has sufficient power for the true effect size (which can never be known), but it guarantees the study has sufficient power given an assumption of the effect a researcher is interested in detecting or rejecting. Therefore, an a-priori power analysis is useful, as long as a researcher can justify the effect sizes they are interested in.</p>
<p>If researchers correct the alpha level when testing multiple hypotheses, the a-priori power analysis should be based on this corrected alpha level. For example, if four tests are performed, an overall Type I error rate of 5% is desired, and a Bonferroni correction is used, the a-priori power analysis should be based on a corrected alpha level of .0125.</p>
<p>An a-priori power analysis can be performed analytically, or by performing computer simulations. Analytic solutions are faster but less flexible. A common challenge researchers face when attempting to perform power analyses for more complex or uncommon tests is that available software does not offer analytic solutions. In these cases simulations can provide a flexible solution to perform power analyses for any test <span class="citation">(<a href="references.html#ref-morris_using_2019" role="doc-biblioref">Morris et al., 2019</a>)</span>. The following code is an example of a power analysis in R based on 10000 simulations for a one-sample <em>t</em> test against zero for a sample size of 20, assuming a true effect of <em>d</em> = 0.5. All simulations consist of first randomly generating data based on assumptions of the data generating mechanism (e.g., a normal distribution with a mean of 0.5 and a standard deviation of 1), followed by a test performed on the data. By computing the percentage of significant results, power can be computed for any design.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span>   <span class="co"># to store p-values</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span>  <span class="co">#simulate 10k tests</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">0.5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co"># store p-value</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10000</span> <span class="co"># Compute power</span></code></pre></div>
<p>There is a wide range of tools available to perform power analyses. Whichever tool a researcher decides to use, it will take time to learn how to use the software correctly to perform a meaningful a-priori power analysis. Resources to educate psychologists about power analysis consist of book-length treatments <span class="citation">(<a href="references.html#ref-aberson_applied_2019" role="doc-biblioref">Aberson, 2019</a>; <a href="references.html#ref-cohen_statistical_1988" role="doc-biblioref">Cohen, 1988</a>; <a href="references.html#ref-julious_sample_2004" role="doc-biblioref">Julious, 2004</a>; <a href="references.html#ref-murphy_statistical_2014" role="doc-biblioref">Murphy et al., 2014</a>)</span>, general introductions <span class="citation">(<a href="references.html#ref-baguley_understanding_2004" role="doc-biblioref">Baguley, 2004</a>; <a href="references.html#ref-brysbaert_how_2019-1" role="doc-biblioref">Brysbaert, 2019</a>; <a href="references.html#ref-faul_gpower_2007" role="doc-biblioref">Faul et al., 2007</a>; <a href="references.html#ref-maxwell_sample_2008" role="doc-biblioref">Maxwell et al., 2008</a>; <a href="references.html#ref-perugini_practical_2018" role="doc-biblioref">Perugini et al., 2018</a>)</span>, and an increasing number of applied tutorials for specific tests <span class="citation">(<a href="references.html#ref-brysbaert_power_2018" role="doc-biblioref">Brysbaert &amp; Stevens, 2018</a>; <a href="references.html#ref-debruine_understanding_2021" role="doc-biblioref">DeBruine &amp; Barr, 2021</a>; <a href="references.html#ref-green_simr_2016" role="doc-biblioref">P. Green &amp; MacLeod, 2016</a>; <a href="references.html#ref-kruschke_bayesian_2013" role="doc-biblioref">J. K. Kruschke, 2013</a>; <a href="references.html#ref-lakens_simulation-based_2021" role="doc-biblioref">Lakens &amp; Caldwell, 2021</a>; <a href="references.html#ref-schoemann_determining_2017" role="doc-biblioref">Schoemann et al., 2017</a>; <a href="references.html#ref-westfall_statistical_2014" role="doc-biblioref">Westfall et al., 2014</a>)</span>. It is important to be trained in the basics of power analysis, and it can be extremely beneficial to learn how to perform simulation-based power analyses. At the same time, it is often recommended to enlist the help of an expert, especially when a researcher lacks experience with a power analysis for a specific test.</p>
<p>When reporting an a-priori power analysis, make sure that the power analysis is completely reproducible. If power analyses are performed in R it is possible to share the analysis script and information about the version of the package. In many software packages it is possible to export the power analysis that is performed as a PDF file. For example, in G*Power analyses can be exported under the 'protocol of power analysis' tab. If the software package provides no way to export the analysis, add a screenshot of the power analysis to the supplementary files.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gpowprotocol"></span>
<img src="images/gpowprotocol.png" alt="All details about the power analysis that is performed can be exported in G*Power." width="240"><p class="caption">
Figure 8.3: All details about the power analysis that is performed can be exported in G*Power.
</p>
</div>
<p>The reproducible report needs to be accompanied by justifications for the choices that were made with respect to the values used in the power analysis. If the effect size used in the power analysis is based on previous research the factors presented in Table <a href="power.html#tab:tablemetajust">8.5</a> (if the effect size is based on a meta-analysis) or Table <a href="power.html#tab:table-es-just">8.6</a> (if the effect size is based on a single study) should be discussed. If an effect size estimate is based on the existing literature, provide a full citation, and preferably a direct quote from the article where the effect size estimate is reported. If the effect size is based on a smallest effect size of interest, this value should not just be stated, but justified (e.g., based on theoretical predictions or practical implications, see <span class="citation">Lakens, Scheel, et al. (<a href="references.html#ref-lakens_equivalence_2018" role="doc-biblioref">2018</a>)</span>). For an overview of all aspects that should be reported when describing an a-priori power analysis, see Table <a href="power.html#tab:table-pow-rec-2">8.4</a>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table-pow-rec-2">Table 8.4: </span>Overview of recommendations when reporting an a-priori power analysis.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="planning-for-precision" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> Planning for Precision<a class="anchor" aria-label="anchor" href="#planning-for-precision"><i class="fas fa-link"></i></a>
</h2>
<p>Some researchers have suggested to justify sample sizes based on a desired level of precision of the estimate <span class="citation">(<a href="references.html#ref-cumming_introduction_2016" role="doc-biblioref">Cumming &amp; Calin-Jageman, 2016</a>; <a href="references.html#ref-kruschke_rejecting_2018" role="doc-biblioref">J. K. Kruschke, 2018</a>; <a href="references.html#ref-maxwell_sample_2008" role="doc-biblioref">Maxwell et al., 2008</a>)</span>. The goal when justifying a sample size based on precision is to collect data to achieve a desired width of the confidence interval around a parameter estimate. The width of the confidence interval around the parameter estimate depends on the standard deviation and the number of observations. The only aspect a researcher needs to justify for a sample size justification based on accuracy is the desired width of the confidence interval with respect to their inferential goal, and their assumption about the population standard deviation of the measure.</p>
<p>If a researcher has determined the desired accuracy, and has a good estimate of the true standard deviation of the measure, it is straightforward to calculate the sample size needed for a desired level of accuracy. For example, when measuring the IQ of a group of individuals a researcher might desire to estimate the IQ score within an error range of 2 IQ points for 95% of the observed means, in the long run. The required sample size to achieve this desired level of accuracy (assuming normally distributed data) can be computed by:</p>
<p><span class="math display">\[N = \left(\frac{z \cdot sd}{error}\right)^2\]</span></p>
<p>where <em>N</em> is the number of observations, <em>z</em> is the critical value related to the desired confidence interval, <em>sd</em> is the standard deviation of IQ scores in the population, and <em>error</em> is the width of the confidence interval within which the mean should fall, with the desired error rate. In this example, (1.96 √ó 15 / 2)^2 = 216.1 observations. If a researcher desires 95% of the means to fall within a 2 IQ point range around the true population mean, 217 observations should be collected. If a desired accuracy for a non-zero mean difference is computed, accuracy is based on a non-central <em>t</em>-distribution. For these calculations an expected effect size estimate needs to be provided, but it has relatively little influence on the required sample size <span class="citation">(<a href="references.html#ref-maxwell_sample_2008" role="doc-biblioref">Maxwell et al., 2008</a>)</span>. It is also possible to incorporate uncertainty about the observed effect size in the sample size calculation, known as <em>assurance</em> <span class="citation">(<a href="references.html#ref-kelley_sample_2006" role="doc-biblioref">Kelley &amp; Rausch, 2006</a>)</span>. The MBESS package in R provides functions to compute sample sizes for a wide range of tests <span class="citation">(<a href="references.html#ref-kelley_confidence_2007" role="doc-biblioref">Kelley, 2007</a>)</span>.</p>
<p>What is less straightforward is to justify how a desired level of accuracy is related to inferential goals. There is no literature that helps researchers to choose a desired width of the confidence interval. Morey <span class="citation">(<a href="references.html#ref-morey_power_2020" role="doc-biblioref">2020</a>)</span> convincingly argues that most practical use-cases of planning for precision involve an inferential goal of distinguishing an observed effect from other effect sizes (for a Bayesian perspective, see <span class="citation">J. K. Kruschke (<a href="references.html#ref-kruschke_rejecting_2018" role="doc-biblioref">2018</a>)</span>). For example, a researcher might expect an effect size of <em>r</em> = 0.4 and would treat observed correlations that differ more than 0.2 (i.e., 0.2 &lt; <em>r</em> &lt; 0.6) differently, in that effects of <em>r</em> = 0.6 or larger are considered too large to be caused by the assumed underlying mechanism <span class="citation">(<a href="references.html#ref-hilgard_maximal_2021" role="doc-biblioref">Hilgard, 2021</a>)</span>, while effects smaller than <em>r</em> = 0.2 are considered too small to support the theoretical prediction. If the goal is indeed to get an effect size estimate that is precise enough so that two effects can be differentiated with high probability, the inferential goal is actually a hypothesis test, which requires designing a study with sufficient power to reject effects (e.g., testing a range prediction of correlations between 0.2 and 0.6).</p>
<p>If researchers do not want to test a hypothesis, for example because they prefer an estimation approach over a testing approach, then in the absence of clear guidelines that help researchers to justify a desired level of precision, one solution might be to rely on a generally accepted norm of precision to aim for. This norm could be based on ideas about a certain resolution below which measurements in a research area no longer lead to noticeably different inferences. Just as researchers normatively use an alpha level of 0.05, they could plan studies to achieve a desired confidence interval width around the observed effect that is determined by a norm. Future work is needed to help researchers choose a confidence interval width when planning for accuracy.</p>
</div>
<div id="heuristics" class="section level2" number="8.8">
<h2>
<span class="header-section-number">8.8</span> Heuristics<a class="anchor" aria-label="anchor" href="#heuristics"><i class="fas fa-link"></i></a>
</h2>
<p>When a researcher uses a heuristic, they are not able to justify their sample size themselves, but they trust in a sample size recommended by some authority. When I started as a PhD student in 2005 it was common to collect 15 participants in each between subject condition. When asked why this was a common practice, no one was really sure, but people trusted there was a justification somewhere in the literature. Now, I realize there was no justification for the heuristics we used. As <span class="citation">Berkeley (<a href="references.html#ref-berkeley_defence_1735" role="doc-biblioref">1735</a>)</span> already observed: "Men learn the elements of science from others: And every learner hath a deference more or less to authority, especially the young learners, few of that kind caring to dwell long upon principles, but inclining rather to take them upon trust: And things early admitted by repetition become familiar: And this familiarity at length passeth for evidence."</p>
<p>Some papers provide researchers with simple rules of thumb about the sample size that should be collected. Such papers clearly fill a need, and are cited a lot, even when the advice in these articles is flawed. For example, <span class="citation">Wilson VanVoorhis &amp; Morgan (<a href="references.html#ref-wilson_vanvoorhis_understanding_2007" role="doc-biblioref">2007</a>)</span> translate an absolute <em>minimum</em> of 50+8 observations for regression analyses suggested by a rule of thumb examined in <span class="citation">S. B. Green (<a href="references.html#ref-green_how_1991" role="doc-biblioref">1991</a>)</span> into the recommendation to collect ~50 observations. Green actually concludes in his article that "In summary, no specific minimum number of subjects or minimum ratio of subjects-to-predictors was supported". He does discuss how a general rule of thumb of N = 50 + 8 provided an accurate minimum number of observations for the 'typical' study in the social sciences because these have a 'medium' effect size, as Green claims by citing Cohen (1988). Cohen actually didn't claim that the typical study in the social sciences has a 'medium' effect size, and instead said (1988, p. 13): "Many effects sought in personality, social, and clinical-psychological research are likely to be small effects as here defined". We see how a string of mis-citations eventually leads to a misleading rule of thumb.</p>
<p>Rules of thumb seem to primarily emerge due to mis-citations and/or overly simplistic recommendations. Simonsohn, Nelson, and Simmons <span class="citation">(<a href="references.html#ref-simmons_false-positive_2011" role="doc-biblioref">2011</a>)</span> recommended that "Authors must collect at least 20 observations per cell". A later recommendation by the same authors presented at a conference suggested to use n &gt; 50, unless you study large effects <span class="citation">(<a href="references.html#ref-simmons_life_2013" role="doc-biblioref">Simmons et al., 2013</a>)</span>. Regrettably, this advice is now often mis-cited as a justification to collect no more than 50 observations per condition without considering the expected effect size. If authors justify a specific sample size (e.g., n = 50) based on a general recommendation in another paper, either they are mis-citing the paper, or the paper they are citing is flawed.</p>
<p>Another common heuristic is to collect the same number of observations as were collected in a previous study. This strategy is not recommended in scientific disciplines with widespread publication bias, and/or where novel and surprising findings from largely exploratory single studies are published. Using the same sample size as a previous study is only a valid approach if the sample size justification in the previous study also applies to the current study. Instead of stating that you intend to collect the same sample size as an earlier study, repeat the sample size justification, and update it in light of any new information (such as the effect size in the earlier study, see Table <a href="power.html#tab:table-es-just">8.6</a>).</p>
<p>Peer reviewers and editors should carefully scrutinize rules of thumb sample size justifications, because they can make it seem like a study has high informational value for an inferential goal even when the study will yield uninformative results. Whenever one encounters a sample size justification based on a heuristic, ask yourself: 'Why is this heuristic used?' It is important to know what the logic behind a heuristic is to determine whether the heuristic is valid for a specific situation. In most cases, heuristics are based on weak logic, and not widely applicable. It might be possible that fields develop valid heuristics for sample size justifications. For example, it is possible that a research area reaches widespread agreement that effects smaller than <em>d</em> = 0.3 are too small to be of interest, and all studies in a field use sequential designs (see below) that have 90% power to detect a <em>d</em> = 0.3. Alternatively, it is possible that a field agrees that data should be collected with a desired level of accuracy, irrespective of the true effect size. In these cases, valid heuristics would exist based on generally agreed goals of data collection. For example, <span class="citation">Simonsohn (<a href="references.html#ref-simonsohn_small_2015" role="doc-biblioref">2015</a>)</span> suggests to design replication studies that have 2.5 times as large sample sizes as the original study, as this provides 80% power for an equivalence test against an equivalence bound set to the effect the original study had 33% power to detect, assuming the true effect size is 0. As original authors typically do not specify which effect size would falsify their hypothesis, the heuristic underlying this 'small telescopes' approach is a good starting point for a replication study with the inferential goal to reject the presence of an effect as large as was described in an earlier publication. It is the responsibility of researchers to gain the knowledge to distinguish valid heuristics from mindless heuristics, and to be able to evaluate whether a heuristic will yield an informative result given the inferential goal of the researchers in a specific study, or not.</p>
</div>
<div id="no-justification" class="section level2" number="8.9">
<h2>
<span class="header-section-number">8.9</span> No Justification<a class="anchor" aria-label="anchor" href="#no-justification"><i class="fas fa-link"></i></a>
</h2>
<p>It might sound like a <em>contradictio in terminis</em>, but it is useful to distinguish a final category where researchers explicitly state they do not have a justification for their sample size. Perhaps the resources were available to collect more data, but they were not used. A researcher could have performed a power analysis, or planned for precision, but they did not. In those cases, instead of pretending there was a justification for the sample size, honesty requires you to state there is no sample size justification. This is not necessarily bad. It is still possible to discuss the smallest effect size of interest, the minimal statistically detectable effect, the width of the confidence interval around the effect size, and to plot a sensitivity power analysis, in relation to the sample size that was collected. If a researcher truly had no specific inferential goals when collecting the data, such an evaluation can perhaps be performed based on reasonable inferential goals peers would have when they learn about the existence of the collected data.</p>
<p>Do not try to spin a story where it looks like a study was highly informative when it was not. Instead, transparently evaluate how informative the study was given effect sizes that were of interest, and make sure that the conclusions follow from the data. The lack of a sample size justification might not be problematic, but it might mean that a study was not informative for most effect sizes of interest, which makes it especially difficult to interpret non-significant effects, or estimates with large uncertainty.</p>
</div>
<div id="what-is-your-inferential-goal" class="section level2" number="8.10">
<h2>
<span class="header-section-number">8.10</span> What is Your Inferential Goal?<a class="anchor" aria-label="anchor" href="#what-is-your-inferential-goal"><i class="fas fa-link"></i></a>
</h2>
<p>The inferential goal of data collection is often in some way related to the size of an effect. Therefore, to design an informative study, researchers will want to think about which effect sizes are interesting. First, it is useful to consider three effect sizes when determining the sample size. The first is the smallest effect size a researcher is interested in, the second is the smallest effect size that can be statistically significant (only in studies where a significance test will be performed), and the third is the effect size that is expected. Beyond considering these three effect sizes, it can be useful to evaluate ranges of effect sizes. This can be done by computing the width of the expected confidence interval around an effect size of interest (for example, an effect size of zero), and examine which effects could be rejected. Similarly, it can be useful to plot a sensitivity curve and evaluate the range of effect sizes the design has decent power to detect, as well as to consider the range of effects for which the design has low power. Finally, there are situations where it is useful to consider range of effects that are likely to be observed in a specific research area.</p>
</div>
<div id="what-is-the-smallest-effect-size-of-interest" class="section level2" number="8.11">
<h2>
<span class="header-section-number">8.11</span> What is the Smallest Effect Size of Interest?<a class="anchor" aria-label="anchor" href="#what-is-the-smallest-effect-size-of-interest"><i class="fas fa-link"></i></a>
</h2>
<p>The strongest possible sample size justification is based on an explicit statement of the smallest effect size that is considered interesting. A smallest effect size of interest can be based on theoretical predictions or practical considerations. For a review of approaches that can be used to determine a smallest effect size of interest in randomized controlled trials, see <span class="citation">Cook et al. (<a href="references.html#ref-cook_assessing_2014" role="doc-biblioref">2014</a>)</span> and <span class="citation">Keefe et al. (<a href="references.html#ref-keefe_defining_2013" role="doc-biblioref">2013</a>)</span>, for reviews of different methods to determine a smallest effect size of interest, see <span class="citation">King (<a href="references.html#ref-king_point_2011" role="doc-biblioref">2011</a>)</span> and <span class="citation">Copay et al. (<a href="references.html#ref-copay_understanding_2007" role="doc-biblioref">2007</a>)</span>, and for a discussion focused on psychological research, see <span class="citation">Lakens, Scheel, et al. (<a href="references.html#ref-lakens_equivalence_2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>It can be challenging to determine the smallest effect size of interest whenever theories are not very developed, or when the research question is far removed from practical applications, but it is still worth thinking about which effects would be too small to matter. A first step forward is to discuss which effect sizes are considered meaningful in a specific research line with your peers. Researchers will differ in the effect sizes they consider large enough to be worthwhile <span class="citation">(<a href="references.html#ref-murphy_statistical_2014" role="doc-biblioref">Murphy et al., 2014</a>)</span>. Just as not every scientist will find every research question interesting enough to study, not every scientist will consider the same effect sizes interesting enough to study, and different stakeholders will differ in which effect sizes are considered meaningful <span class="citation">(<a href="references.html#ref-kelley_effect_2012" role="doc-biblioref">Kelley &amp; Preacher, 2012</a>)</span>.</p>
<p>Even though it might be challenging, there are important benefits of being able to specify a smallest effect size of interest. The population effect size is always uncertain (indeed, estimating this is typically one of the goals of the study), and therefore whenever a study is powered for an expected effect size, there is considerable uncertainty about whether the statistical power is high enough to detect the true effect in the population. However, if the smallest effect size of interest can be specified and agreed upon after careful deliberation, it becomes possible to design a study that has sufficient power (given the inferential goal to detect or reject the smallest effect size of interest with a certain error rate). A smallest effect of interest may be subjective (one researcher might find effect sizes smaller than <em>d</em> = 0.3 meaningless, while another researcher might still be interested in effects larger than <em>d</em> = 0.1), and there might be uncertainty about the parameters required to specify the smallest effect size of interest (e.g., when performing a cost-benefit analysis), but after a smallest effect size of interest has been determined, a study can be designed with a known Type 2 error rate to detect or reject this value. For this reason an a-priori power based on a smallest effect size of interest is generally preferred, whenever researchers are able to specify one <span class="citation">(<a href="references.html#ref-aberson_applied_2019" role="doc-biblioref">Aberson, 2019</a>; <a href="references.html#ref-albers_when_2018" role="doc-biblioref">Albers &amp; Lakens, 2018</a>; <a href="references.html#ref-brown_errors_1983" role="doc-biblioref">Brown, 1983</a>; <a href="references.html#ref-cascio_open_1983" role="doc-biblioref">Cascio &amp; Zedeck, 1983</a>; <a href="references.html#ref-dienes_using_2014" role="doc-biblioref">Dienes, 2014</a>; <a href="references.html#ref-lenth_practical_2001" role="doc-biblioref">Lenth, 2001</a>)</span>.</p>
</div>
<div id="the-minimal-statistically-detectable-effect" class="section level2" number="8.12">
<h2>
<span class="header-section-number">8.12</span> The Minimal Statistically Detectable Effect<a class="anchor" aria-label="anchor" href="#the-minimal-statistically-detectable-effect"><i class="fas fa-link"></i></a>
</h2>
<p>The minimal statistically detectable effect, or the critical effect size, provides information about the smallest effect size that, if observed, would be statistically significant given a specified alpha level and sample size <span class="citation">(<a href="references.html#ref-cook_assessing_2014" role="doc-biblioref">Cook et al., 2014</a>)</span>. For any critical <em>t</em> value (e.g., <em>t</em> = 1.96 for <span class="math inline">\(\alpha\)</span> = 0.05, for large sample sizes) we can compute a critical mean difference <span class="citation">(<a href="references.html#ref-phillips_statistical_2001" role="doc-biblioref">Phillips et al., 2001</a>)</span>, or a critical standardized effect size. For a two-sided independent <em>t</em> test the critical mean difference is:</p>
<p><span class="math display">\[M_{crit} = t_{crit}{\sqrt{\frac{sd_1^2}{n_1} + \frac{sd_2^2}{n_2}}}\]</span></p>
<p>and the critical standardized mean difference is:</p>
<p><span class="math display">\[d_{crit} = t_{crit}{\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</span></p>
<p>In Figure <a href="power.html#fig:power-effect1">8.4</a> the distribution of Cohen‚Äôs <em>d</em> is plotted for 15 participants per group when the true effect size is either <em>d</em> = 0 or <em>d</em> = 0.5. This figure is similar to Figure <a href="power.html#fig:power-3">8.2</a>, with the addition that the critical <em>d</em> is indicated. We see that with such a small number of observations in each group only observed effects larger than <em>d</em> = 0.75 will be statistically significant. Whether such effect sizes are interesting, and can realistically be expected, should be carefully considered and justified.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:power-effect1"></span>
<img src="08-samplesizejustification_files/figure-html/power-effect1-1.png" alt="Critical effect size for an independent *t* test with n = 15 per group and $\alpha$ = 0.05." width="100%"><p class="caption">
Figure 8.4: Critical effect size for an independent <em>t</em> test with n = 15 per group and <span class="math inline">\(\alpha\)</span> = 0.05.
</p>
</div>
<p>G*Power provides the critical test statistic (such as the critical <em>t</em> value) when performing a power analysis. For example, Figure <a href="power.html#fig:gcrit2">8.5</a> shows that for a correlation based on a two-sided test, with <span class="math inline">\(\alpha\)</span> = 0.05, and <em>N</em> = 30, only effects larger than <em>r</em> = 0.361 or smaller than <em>r</em> = -0.361 can be statistically significant. This reveals that when the sample size is relatively small, the observed effect needs to be quite substantial to be statistically significant.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/gpowcrit2.png"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gcrit2"></span>
<img src="images/gpowcrit2.png" alt="The critical correlation of a test based on a total sample size of 30 and $\alpha$ = 0.05 calculated in G*Power." width="240"><p class="caption">
Figure 8.5: The critical correlation of a test based on a total sample size of 30 and <span class="math inline">\(\alpha\)</span> = 0.05 calculated in G*Power.
</p>
</div>
<p>It is important to realize that due to random variation each study has a probability to yield effects larger than the critical effect size, even if the true effect size is small (or even when the true effect size is 0, in which case each significant effect is a Type I error). Computing a minimal statistically detectable effect is useful for a study where no a-priori power analysis is performed, both for studies in the published literature that do not report a sample size justification <span class="citation">(<a href="references.html#ref-lakens_equivalence_2018" role="doc-biblioref">Lakens, Scheel, et al., 2018</a>)</span>, as for researchers who rely on heuristics for their sample size justification.</p>
<p>It can be informative to ask yourself whether the critical effect size for a study design is within the range of effect sizes that can realistically be expected. If not, then whenever a significant effect is observed in a published study, either the effect size is surprisingly larger than expected, or more likely, it is an upwardly biased effect size estimate. In the latter case, given publication bias, published studies will lead to biased effect size estimates. If it is still possible to increase the sample size, for example by ignoring rules of thumb and instead performing an a-priori power analysis, then do so. If it is not possible to increase the sample size, for example due to resource constraints, then reflecting on the minimal statistically detectable effect should make it clear that an analysis of the data should not focus on <em>p</em> values, but on the effect size and the confidence interval (see Table <a href="power.html#tab:table-pow-rec">8.3</a>).</p>
<p>It is also useful to compute the minimal statistically detectable effect if an 'optimistic' power analysis is performed. For example, if you believe a best case scenario for the true effect size is <em>d</em> = 0.57 and use this optimistic expectation in an a-priori power analysis, effects smaller than <em>d</em> = 0.4 will not be statistically significant when you collect 50 observations in a two independent group design. If your worst case scenario for the alternative hypothesis is a true effect size of <em>d</em> = 0.35 your design would not allow you to declare a significant effect if effect size estimates close to the worst case scenario are observed. Taking into account the minimal statistically detectable effect size should make you reflect on whether a hypothesis test will yield an informative answer, and whether your current approach to sample size justification (e.g., the use of rules of thumb, or letting resource constraints determine the sample size) leads to an informative study, or not.</p>
</div>
<div id="what-is-the-expected-effect-size" class="section level2" number="8.13">
<h2>
<span class="header-section-number">8.13</span> What is the Expected Effect Size?<a class="anchor" aria-label="anchor" href="#what-is-the-expected-effect-size"><i class="fas fa-link"></i></a>
</h2>
<p>Although the true population effect size is always unknown, there are situations where researchers have a reasonable expectation of the effect size in a study, and want to use this expected effect size in an a-priori power analysis. Even if expectations for the observed effect size are largely a guess, it is always useful to explicitly consider which effect sizes are expected. A researcher can justify a sample size based on the effect size they expect, even if such a study would not be very informative with respect to the smallest effect size of interest. In such cases a study is informative for one inferential goal (testing whether the expected effect size is present or absent), but not highly informative for the second goal (testing whether the smallest effect size of interest is present or absent).</p>
<p>There are typically three sources for expectations about the population effect size: a meta-analysis, a previous study, or a theoretical model. It is tempting for researchers to be overly optimistic about the expected effect size in an a-priori power analysis, as higher effect size estimates yield lower sample sizes, but being too optimistic increases the probability of observing a false negative result. When reviewing a sample size justification based on an a-priori power analysis, it is important to critically evaluate the justification for the expected effect size used in power analyses.</p>
</div>
<div id="using-an-estimate-from-a-meta-analysis" class="section level2" number="8.14">
<h2>
<span class="header-section-number">8.14</span> Using an Estimate from a Meta-Analysis<a class="anchor" aria-label="anchor" href="#using-an-estimate-from-a-meta-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>In a perfect world effect size estimates from a meta-analysis would provide researchers with the most accurate information about which effect size they could expect. Due to widespread publication bias in science, effect size estimates from meta-analyses are regrettably not always accurate. They can be biased, sometimes substantially so. Furthermore, meta-analyses typically have considerable heterogeneity, which means that the meta-analytic effect size estimate differs for subsets of studies that make up the meta-analysis. So, although it might seem useful to use a meta-analytic effect size estimate of the effect you are studying in your power analysis, you need to take great care before doing so.</p>
<p>If a researcher wants to enter a meta-analytic effect size estimate in an a-priori power analysis, they need to consider three things (see Table <a href="power.html#tab:tablemetajust">8.5</a>). First, the studies included in the meta-analysis should be similar enough to the study they are performing that it is reasonable to expect a similar effect size. In essence, this requires evaluating the generalizability of the effect size estimate to the new study. It is important to carefully consider differences between the meta-analyzed studies and the planned study, with respect to the manipulation, the measure, the population, and any other relevant variables.</p>
<p>Second, researchers should check whether the effect sizes reported in the meta-analysis are homogeneous. If not, and there is considerable heterogeneity in the meta-analysis, it means not all included studies can be expected to have the same true effect size estimate. A meta-analytic estimate should be used based on the subset of studies that most closely represent the planned study. Note that heterogeneity remains a possibility (even direct replication studies can show heterogeneity when unmeasured variables moderate the effect size in each sample <span class="citation">(<a href="references.html#ref-kenny_unappreciated_2019" role="doc-biblioref">Kenny &amp; Judd, 2019</a>; <a href="references.html#ref-olsson-collentine_heterogeneity_2020" role="doc-biblioref">Olsson-Collentine et al., 2020</a>)</span>), so the main goal of selecting similar studies is to use existing data to increase the probability that your expectation is accurate, without guaranteeing it will be.</p>
<p>Third, the meta-analytic effect size estimate should not be biased. Check if the bias detection tests that are reported in the meta-analysis are state-of-the-art, or perform multiple bias detection tests yourself <span class="citation">(<a href="references.html#ref-carter_correcting_2019" role="doc-biblioref">Carter et al., 2019</a>)</span>, and consider bias corrected effect size estimates (even though these estimates might still be biased, and do not necessarily reflect the true population effect size).</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:tablemetajust">Table 8.5: </span>Overview of recommendations when justifying the use of a meta-analytic effect size estimate for a power analysis.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="using-an-estimate-from-a-previous-study" class="section level2" number="8.15">
<h2>
<span class="header-section-number">8.15</span> Using an Estimate from a Previous Study<a class="anchor" aria-label="anchor" href="#using-an-estimate-from-a-previous-study"><i class="fas fa-link"></i></a>
</h2>
<p>If a meta-analysis is not available, researchers often rely on an effect size from a previous study in an a-priori power analysis. The first issue that requires careful attention is whether the two studies are sufficiently similar. Just as when using an effect size estimate from a meta-analysis, researchers should consider if there are differences between the studies in terms of the population, the design, the manipulations, the measures, or other factors that should lead one to expect a different effect size. For example, intra-individual reaction time variability increases with age, and therefore a study performed on older participants should expect a smaller standardized effect size than a study performed on younger participants. If an earlier study used a very strong manipulation, and you plan to use a more subtle manipulation, a smaller effect size should be expected. Finally, effect sizes do not generalize to studies with different designs. For example, the effect size for a comparison between two groups is most often not similar to the effect size for an interaction in a follow-up study where a second factor is added to the original design <span class="citation">(<a href="references.html#ref-lakens_simulation-based_2021" role="doc-biblioref">Lakens &amp; Caldwell, 2021</a>)</span>.</p>
<p>Even if a study is sufficiently similar, statisticians have warned against using effect size estimates from small pilot studies in power analyses. Leon, Davis, and Kraemer <span class="citation">(<a href="references.html#ref-leon_role_2011" role="doc-biblioref">2011</a>)</span> write:</p>
<blockquote>
<p>Contrary to tradition, a pilot study does not provide a meaningful effect size estimate for planning subsequent studies due to the imprecision inherent in data from small samples.</p>
</blockquote>
<p>The two main reasons researchers should be careful when using effect sizes from studies in the published literature in power analyses is that effect size estimates from studies can differ from the true population effect size due to random variation, and that publication bias inflates effect sizes. Figure <a href="power.html#fig:follow-up-bias">8.6</a> shows the distribution for <span class="math inline">\(\eta_p^2\)</span> for a study with three conditions with 25 participants in each condition when the null hypothesis is true and when there is a 'medium' true effect of <span class="math inline">\(\eta_p^2\)</span> = 0.0588 <span class="citation">(<a href="references.html#ref-richardson_eta_2011" role="doc-biblioref">Richardson, 2011</a>)</span>. As in Figure <a href="power.html#fig:power-effect1">8.4</a> the critical effect size is indicated, which shows observed effects smaller than <span class="math inline">\(\eta_p^2\)</span> = 0.08 will not be significant with the given sample size. If the null hypothesis is true effects larger than <span class="math inline">\(\eta_p^2\)</span> = 0.08 will be a Type I error (the dark grey area), and when the alternative hypothesis is true effects smaller than <span class="math inline">\(\eta_p^2\)</span> = 0.08 will be a Type II error (light grey area). It is clear all significant effects are larger than the true effect size (<span class="math inline">\(\eta_p^2\)</span> = 0.0588), so power analyses based on a significant finding (e.g., because only significant results are published in the literature) will be based on an overestimate of the true effect size, introducing bias.</p>
<p>But even if we had access to all effect sizes (e.g., from pilot studies you have performed yourself) due to random variation the observed effect size will sometimes be quite small. Figure <a href="power.html#fig:follow-up-bias">8.6</a> shows it is quite likely to observe an effect of <span class="math inline">\(\eta_p^2\)</span> = 0.01 in a small pilot study, even when the true effect size is 0.0588. Entering an effect size estimate of <span class="math inline">\(\eta_p^2\)</span> = 0.01 in an a-priori power analysis would suggest a total sample size of 957 observations to achieve 80% power in a follow-up study. If researchers only follow up on pilot studies when they observe an effect size in the pilot study that, when entered into a power analysis, yields a sample size that is feasible to collect for the follow-up study, these effect size estimates will be upwardly biased, and power in the follow-up study will be systematically lower than desired <span class="citation">(<a href="references.html#ref-albers_when_2018" role="doc-biblioref">Albers &amp; Lakens, 2018</a>)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:follow-up-bias"></span>
<img src="08-samplesizejustification_files/figure-html/follow-up-bias-1.png" alt="Distribution of partial eta squared under the null hypothesis (dotted grey curve) and a medium true effect of 0.0588 (solid black curve) for 3 groups with 25 observations." width="100%"><p class="caption">
Figure 8.6: Distribution of partial eta squared under the null hypothesis (dotted grey curve) and a medium true effect of 0.0588 (solid black curve) for 3 groups with 25 observations.
</p>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convert eta of 0.176 to f of 0.4621604</span>
<span class="va">pwr_res</span> <span class="op">&lt;-</span> <span class="fu">pwr.anova.test</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>,  
               f <span class="op">=</span> <span class="fl">0.4621604</span>, 
               sig.level <span class="op">=</span> <span class="fl">0.05</span>, 
               power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">$</span><span class="va">n</span>



<span class="va">BUCSS_res</span> <span class="op">&lt;-</span> <span class="fu">ss.power.ba</span><span class="op">(</span>
  F.observed <span class="op">=</span> <span class="fl">4.5</span>,
  N <span class="op">=</span> <span class="fl">45</span>,
  levels.A <span class="op">=</span> <span class="fl">3</span>,
  effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"factor.A"</span><span class="op">)</span>,
  alpha.prior <span class="op">=</span> <span class="fl">0.05</span>,
  alpha.planned <span class="op">=</span> <span class="fl">0.05</span>,
  assurance <span class="op">=</span> <span class="fl">0.5</span>,
  power <span class="op">=</span> <span class="fl">0.8</span>,
  step <span class="op">=</span> <span class="fl">0.001</span>
<span class="op">)</span></code></pre></div>
<p>In essence, the problem with using small studies to estimate the effect size that will be entered into an a-priori power analysis is that due to publication bias or follow-up bias the effect sizes researchers end up using for their power analysis do not come from a full <em>F</em> distribution, but from what is known as a <em>truncated</em> <em>F</em> distribution <span class="citation">(<a href="references.html#ref-taylor_bias_1996" role="doc-biblioref">Taylor &amp; Muller, 1996</a>)</span>. For example, imagine if there is extreme publication bias in the situation illustrated in Figure <a href="power.html#fig:follow-up-bias">8.6</a>. The only studies that would be accessible to researchers would come from the part of the distribution where <span class="math inline">\(\eta_p^2\)</span> &gt; 0.08, and the test result would be statistically significant. It is possible to compute an effect size estimate that, based on certain assumptions, corrects for bias. For example, imagine we observe a result in the literature for a One-Way ANOVA with 3 conditions, reported as <em>F</em>(2, 42) = 0.017, <span class="math inline">\(\eta_p^2\)</span> = 0.176. If we would take this effect size at face value and enter it as our effect size estimate in an a-priori power analysis, the suggested sample size to achieve would suggest we need to collect 17 observations in each condition.</p>
<p>However, if we assume bias is present, we can use the <code>BUCSS</code> R package <span class="citation">(<a href="references.html#ref-anderson_sample-size_2017" role="doc-biblioref">S. F. Anderson et al., 2017</a>)</span> to perform a power analysis that attempts to correct for bias. A power analysis that takes bias into account (under a specific model of publication bias, based on a truncated <em>F</em> distribution where only significant results are published) suggests collecting 73 participants in each condition. It is possible that the bias corrected estimate of the non-centrality parameter used to compute power is zero, in which case it is not possible to correct for bias using this method. As an alternative to formally modeling a correction for publication bias whenever researchers assume an effect size estimate is biased, researchers can simply use a more conservative effect size estimate, for example by computing power based on the lower limit of 60% two-sided confidence interval around the effect size estimate, which <span class="citation">Perugini et al. (<a href="references.html#ref-perugini_safeguard_2014" role="doc-biblioref">2014</a>)</span> refer to as <em>safeguard power</em>. Both these approaches lead to a more conservative power analysis, but not necessarily a more accurate power analysis. It is simply not possible to perform an accurate power analysis on the basis of an effect size estimate from a study that might be biased and/or had a small sample size <span class="citation">(<a href="references.html#ref-teare_sample_2014" role="doc-biblioref">Teare et al., 2014</a>)</span>. If it is not possible to specify a smallest effect size of interest, and there is great uncertainty about which effect size to expect, it might be more efficient to perform a study with a sequential design (discussed below).</p>
<p>To summarize, an effect size from a previous study in an a-priori power analysis can be used if three conditions are met (see Table <a href="power.html#tab:table-es-just">8.6</a>). First, the previous study is sufficiently similar to the planned study. Second, there was a low risk of bias (e.g., the effect size estimate comes from a Registered Report, or from an analysis for which results would not have impacted the likelihood of publication). Third, the sample size is large enough to yield relatively accurate effect size estimate, based on the width of a 95% CI around the observed effect size estimate. There is always uncertainty around the effect size estimate, and entering the upper and lower limit of the 95% CI around the effect size estimate might be informative about the consequences of the uncertainty in the effect size estimate for an a-priori power analysis.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table-es-just">Table 8.6: </span>Overview of recommendations when justifying the use of an effect size estimate from a single study.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="using-an-estimate-from-a-theoretical-model" class="section level2" number="8.16">
<h2>
<span class="header-section-number">8.16</span> Using an Estimate from a Theoretical Model<a class="anchor" aria-label="anchor" href="#using-an-estimate-from-a-theoretical-model"><i class="fas fa-link"></i></a>
</h2>
<p>When your theoretical model is sufficiently specific such that you can build a computational model, and you have knowledge about key parameters in your model that are relevant for the data you plan to collect, it is possible to estimate an effect size based on the effect size estimate derived from a computational model. For example, if one had strong ideas about the weights for each feature stimuli share and differ on, it could be possible to compute predicted similarity judgments for pairs of stimuli based on Tversky's contrast model <span class="citation">(<a href="references.html#ref-tversky_features_1977" role="doc-biblioref">Tversky, 1977</a>)</span>, and estimate the predicted effect size for differences between experimental conditions. Although computational models that make point predictions are relatively rare, whenever they are available, they provide a strong justification of the effect size a researcher expects.</p>
</div>
<div id="compute-the-width-of-the-confidence-interval-around-the-effect-size" class="section level2" number="8.17">
<h2>
<span class="header-section-number">8.17</span> Compute the Width of the Confidence Interval around the Effect Size<a class="anchor" aria-label="anchor" href="#compute-the-width-of-the-confidence-interval-around-the-effect-size"><i class="fas fa-link"></i></a>
</h2>
<p>If a researcher can estimate the standard deviation of the observations that will be collected, it is possible to compute an a-priori estimate of the width of the 95% confidence interval around an effect size <span class="citation">(<a href="references.html#ref-kelley_confidence_2007" role="doc-biblioref">Kelley, 2007</a>)</span>. Confidence intervals represent a range around an estimate that is wide enough so that in the long run the true population parameter will fall inside the confidence intervals 100 - <span class="math inline">\(\alpha\)</span> percent of the time. In any single study the true population effect either falls in the confidence interval, or it doesn't, but in the long run one can <em>act</em> as if the confidence interval includes the true population effect size (while keeping the error rate in mind). Cumming <span class="citation">(<a href="references.html#ref-cumming_understanding_2013" role="doc-biblioref">2013</a>)</span> calls the difference between the observed effect size and the upper 95% confidence interval (or the lower 95% confidence interval) the margin of error.</p>
<p>If we compute the 95% CI for an effect size of <em>d</em> = 0 based on the <em>t</em> statistic and sample size <span class="citation">(<a href="references.html#ref-smithson_confidence_2003" role="doc-biblioref">Smithson, 2003</a>)</span>, we see that with 15 observations in each condition of an independent <em>t</em> test the 95% CI ranges from <em>d</em> = -0.7156777 to <em>d</em> = 0.7156777<a href="references.html#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. The margin of error is half the width of the 95% CI, 0.7156777. A Bayesian estimator who uses an uninformative prior would compute a credible interval with the same (or a very similar) upper and lower bound <span class="citation">(<a href="references.html#ref-albers_credible_2018" role="doc-biblioref">Albers et al., 2018</a>; <a href="references.html#ref-kruschke_bayesian_2011" role="doc-biblioref">J. K. Kruschke, 2011</a>)</span>, and might conclude that after collecting the data they would be left with a range of plausible values for the population effect that is too large to be informative. Regardless of the statistical philosophy you plan to rely on when analyzing the data, the evaluation of what we can conclude based on the width of our interval tells us that with 15 observation per group we will not learn a lot.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">power_tost</span> <span class="op">&lt;-</span> <span class="fu">TOSTER</span><span class="fu">::</span><span class="fu"><a href="https://aaroncaldwell.us/TOSTERpkg/reference/powerTOSTtwo.html">powerTOSTtwo</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span>, N <span class="op">=</span> <span class="fl">50</span>, low_eqbound_d <span class="op">=</span> <span class="op">-</span><span class="fl">0.6</span>, high_eqbound_d <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></code></pre></div>
<p>One useful way of interpreting the width of the confidence interval is based on the effects you would be able to reject if the true effect size is 0. In other words, if there is no effect, which effects would you have been able to reject given the collected data, and which effect sizes would not be rejected, if there was no effect? Effect sizes in the range of <em>d</em> = 0.7 are findings such as "People become aggressive when they are provoked", "People prefer their own group to other groups", and "Romantic partners resemble one another in physical attractiveness" <span class="citation">(<a href="references.html#ref-richard_one_2003" role="doc-biblioref">Richard et al., 2003</a>)</span>. The width of the confidence interval tells you that you can only reject the presence of effects that are so large, if they existed, you would probably already have noticed them. If it is true that most effects that you study are realistically much smaller than <em>d</em> = 0.7, there is a good possibility that we do not learn anything we didn't already know by performing a study with n = 15. Even without data, in most research lines we would not consider certain large effects plausible (although the effect sizes that are plausible differ between fields, as discussed below). On the other hand, in large samples where researchers can for example reject the presence of effects larger than <em>d</em> = 0.2, if the null hypothesis was true, this analysis of the width of the confidence interval would suggest that peers in many research lines would likely consider the study to be informative.</p>
<p>We see that the margin of error is almost, but not exactly, the same as the minimal statistically detectable effect (<em>d</em> = 0.7479725). The small variation is due to the fact that the 95% confidence interval is calculated based on the <em>t</em> distribution. If the true effect size is not zero, the confidence interval is calculated based on the non-central <em>t</em> distribution, and the 95% CI is asymmetric. Figure <a href="power.html#fig:noncentralt">8.7</a> visualizes three <em>t</em> distributions, one symmetric at 0, and two asymmetric distributions with a noncentrality parameter (the normalized difference between the means) of 2 and 3. The asymmetry is most clearly visible in very small samples (the distributions in the plot have 5 degrees of freedom) but remains noticeable in larger samples when calculating confidence intervals and statistical power. For example, for a true effect size of <em>d</em> = 0.5 observed with 15 observations per group would yield <span class="math inline">\(d_s\)</span> = 0.50, 95% CI [-0.23, 1.22]. If we compute the 95% CI around the critical effect size, we would get <span class="math inline">\(d_s\)</span> = 0.75, 95% CI [0.00, 1.48]. We see the 95% CI ranges from exactly -2.9894746^{-8} to 1.4835407, in line with the relation between a confidence interval and a <em>p</em> value, where the 95% CI excludes zero if the test is statistically significant. As noted before, the different approaches recommended here to evaluate how informative a study is are often based on the same information.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:noncentralt"></span>
<img src="08-samplesizejustification_files/figure-html/noncentralt-1.png" alt="Central (black) and 2 non-central (darkgrey and lightgrey) *t* distributions." width="100%"><p class="caption">
Figure 8.7: Central (black) and 2 non-central (darkgrey and lightgrey) <em>t</em> distributions.
</p>
</div>
</div>
<div id="plot-a-sensitivity-power-analysis" class="section level2" number="8.18">
<h2>
<span class="header-section-number">8.18</span> Plot a Sensitivity Power Analysis<a class="anchor" aria-label="anchor" href="#plot-a-sensitivity-power-analysis"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pow_es</span> <span class="op">&lt;-</span> <span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span>
  sig.level <span class="op">=</span> <span class="fl">0.05</span>,
  n <span class="op">=</span> <span class="fl">15</span>,
  power <span class="op">=</span> <span class="fl">0.9</span>,
  type <span class="op">=</span> <span class="st">"two.sample"</span>,
  alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></code></pre></div>
<p>A sensitivity power analysis fixes the sample size, desired power, and alpha level, and answers the question which effect size a study could detect with a desired power. A sensitivity power analysis is therefore performed when the sample size is already known. Sometimes data has already been collected to answer a different research question, or the data is retrieved from an existing database, and you want to perform a sensitivity power analysis for a new statistical analysis. Other times, you might not have carefully considered the sample size when you initially collected the data, and want to reflect on the statistical power of the study for (ranges of) effect sizes of interest when analyzing the results. Finally, it is possible that the sample size will be collected in the future, but you know that due to resource constraints the maximum sample size you can collect is limited, and you want to reflect on whether the study has sufficient power for effects that you consider plausible and interesting (such as the smallest effect size of interest, or the effect size that is expected).</p>
<p>Assume a researcher plans to perform a study where 30 observations will be collected in total, 15 in each between participant condition. Figure <a href="power.html#fig:gsens0">8.8</a> shows how to perform a sensitivity power analysis in G*Power for a study where we have decided to use an alpha level of 5%, and desire 90% power. The sensitivity power analysis reveals the designed study has 90% power to detect effects of at least <em>d</em> = 1.23. Perhaps a researcher believes that a desired power of 90% is quite high, and is of the opinion that it would still be interesting to perform a study if the statistical power was lower. It can then be useful to plot a sensitivity curve across a range of smaller effect sizes.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/gpow_sensitivity_1.png"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gsens0"></span>
<img src="images/gpow_sensitivity_1.png" alt="Sensitivity power analysis in G*Power software." width="240"><p class="caption">
Figure 8.8: Sensitivity power analysis in G*Power software.
</p>
</div>
<p>The two dimensions of interest in a sensitivity power analysis are the effect sizes, and the power to observe a significant effect assuming a specific effect size. These two dimensions can be plotted against each other to create a sensitivity curve. For example, a sensitivity curve can be plotted in G*Power by clicking the 'X-Y plot for a range of values' button, as illustrated in Figure <a href="power.html#fig:gsens1">8.9</a>. Researchers can examine which power they would have for an a-priori plausible range of effect sizes, or they can examine which effect sizes would provide reasonable levels of power. In simulation-based approaches to power analysis, sensitivity curves can be created by performing the power analysis for a range of possible effect sizes. Even if 50% power is deemed acceptable (in which case deciding to act as if the null hypothesis is true after a non-significant result is a relatively noisy decision procedure), Figure <a href="power.html#fig:gsens1">8.9</a> shows a study design where power is extremely low for a large range of effect sizes that are reasonable to expect in most fields. Thus, a sensitivity power analysis provides an additional approach to evaluate how informative the planned study is, and can inform researchers that a specific design is unlikely to yield a significant effect for a range of effects that one might realistically expect.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gsens1"></span>
<img src="images/sensitivity1.png" alt="Plot of the effect size against the desired power when n = 15 per group and alpha = 0.05." width="100%"><p class="caption">
Figure 8.9: Plot of the effect size against the desired power when n = 15 per group and alpha = 0.05.
</p>
</div>
<p>If the number of observations per group had been larger, the evaluation might have been more positive. We might not have had any specific effect size in mind, but if we had collected 150 observations per group, a sensitivity analysis could have shown that power was sufficient for a range of effects we believe is most interesting to examine, and we would still have approximately 50% power for quite small effects. For a sensitivity analysis to be meaningful, the sensitivity curve should be compared against a smallest effect size of interest, or a range of effect sizes that are expected. A sensitivity power analysis has no clear cut-offs to examine <span class="citation">(<a href="references.html#ref-bacchetti_current_2010" role="doc-biblioref">Bacchetti, 2010</a>)</span>. Instead, the idea is to make a holistic trade-off between different effect sizes one might observe or care about, and their associated statistical power.</p>
<!-- If we look at the effect size that we would have 50% power for, we see it is *d* = 0.7411272. This is very close to our critical effect size of *d* = 0.7479725 (the smallest effect size that, if observed, would be significant). The difference is due to the non-central *t*-distribution (see Figure \@ref(fig:noncentralt). If the distribution was symmetric, observing an effect size exactly on the critical value would mean half of the distribution is smaller than the critical effect size, and half of the distribution is larger, and we would have exactly 50% power for the critical effect size. Because the distribution is not symmetrical, we need to find the critical effect size for which it *is* true that half the distribution falls below it, and half the distribution falls above it. This value can't be calculated directly, and requires an iterative procedure that optimizes the values of the non-centrality parameter such that power is exactly 50% [@smithson_confidence_2003]. The `pwr` package in R can calculate this effect size in a sensitivity analysis where we enter the sample size (per group), the alpha level, and the desired power for a two-sided independent *t* test, which will return *d* = 0.7411272. We can check this true effect size would indeed give with 50% power. -->
<!-- ```{r, echo = TRUE} -->
<!-- # Sensitivity power analysis -->
<!-- pwr::pwr.t.test( -->
<!--   n = 15,  -->
<!--   sig.level = 0.05,  -->
<!--   power = 0.5,  -->
<!--   type = "two.sample", -->
<!--   alternative = "two.sided") -->
<!-- ``` -->
</div>
<div id="the-distribution-of-effect-sizes-in-a-research-area" class="section level2" number="8.19">
<h2>
<span class="header-section-number">8.19</span> The Distribution of Effect Sizes in a Research Area<a class="anchor" aria-label="anchor" href="#the-distribution-of-effect-sizes-in-a-research-area"><i class="fas fa-link"></i></a>
</h2>
<p>In my personal experience the most commonly entered effect size estimate in an a-priori power analysis for an independent <em>t</em> test is Cohen's benchmark for a 'medium' effect size, because of what is known as the <em>default effect</em>. When you open G*Power, a 'medium' effect is the default option for an a-priori power analysis. Cohen's benchmarks for small, medium, and large effects should not be used in an a-priori power analysis <span class="citation">(<a href="references.html#ref-cook_assessing_2014" role="doc-biblioref">Cook et al., 2014</a>; <a href="references.html#ref-correll_avoid_2020" role="doc-biblioref">Correll et al., 2020</a>)</span>, and Cohen regretted having proposed these benchmarks <span class="citation">(<a href="references.html#ref-funder_evaluating_2019" role="doc-biblioref">Funder &amp; Ozer, 2019</a>)</span>. The large variety in research topics means that any 'default' or 'heuristic' that is used to compute statistical power is not just unlikely to correspond to your actual situation, but it is also likely to lead to a sample size that is more substantially misaligned with the question you are trying to answer with the collected data.</p>
<p>Some researchers have wondered what a better default would be, if researchers have no other basis to decide upon an effect size for an a-priori power analysis. Brysbaert <span class="citation">(<a href="references.html#ref-brysbaert_how_2019-1" role="doc-biblioref">2019</a>)</span> recommends <em>d</em> = 0.4 as a default in psychology, which is the average observed in replication projects and several meta-analyses. It is impossible to know if this average effect size is realistic, but it is clear there is huge heterogeneity across fields and research questions. Any average effect size will often deviate substantially from the effect size that should be expected in a planned study. Some researchers have suggested to change Cohen's benchmarks based on the distribution of effect sizes in a specific field <span class="citation">(<a href="references.html#ref-bosco_correlational_2015" role="doc-biblioref">Bosco et al., 2015</a>; <a href="references.html#ref-funder_evaluating_2019" role="doc-biblioref">Funder &amp; Ozer, 2019</a>; <a href="references.html#ref-hill_empirical_2008" role="doc-biblioref">Hill et al., 2008</a>; <a href="references.html#ref-kraft_interpreting_2020" role="doc-biblioref">Kraft, 2020</a>; <a href="references.html#ref-lovakov_empirically_2017" role="doc-biblioref">Lovakov &amp; Agadullina, 2017</a>)</span>. As always, when effect size estimates are based on the published literature, one needs to evaluate the possibility that the effect size estimates are inflated due to publication bias. Due to the large variation in effect sizes within a specific research area, there is little use in choosing a large, medium, or small effect size benchmark based on the empirical distribution of effect sizes in a field to perform a power analysis.</p>
<p>Having some knowledge about the distribution of effect sizes in the literature can be useful when interpreting the confidence interval around an effect size. If in a specific research area almost no effects are larger than the value you could reject in an equivalence test (e.g., if the observed effect size is 0, the design would only reject effects larger than for example <em>d</em> = 0.7), then it is a-priori unlikely that collecting the data would tell you something you didn't already know.</p>
<p>It is more difficult to defend the use of a specific effect size derived from an empirical distribution of effect sizes as a justification for the effect size used in an a-priori power analysis. One might argue that the use of an effect size benchmark based on the distribution of effects in the literature will outperform a wild guess, but this is not a strong enough argument to form the basis of a sample size justification. There is a point where researchers need to admit they are not ready to perform an a-priori power analysis due to a lack of clear expectations <span class="citation">(<a href="references.html#ref-scheel_why_2020" role="doc-biblioref">Scheel et al., 2020</a>)</span>. Alternative sample size justifications, such as a justification of the sample size based on resource constraints, perhaps in combination with a sequential study design, might be more in line with the actual inferential goals of a study.</p>
</div>
<div id="additional-considerations-when-designing-an-informative-study" class="section level2" number="8.20">
<h2>
<span class="header-section-number">8.20</span> Additional Considerations When Designing an Informative Study<a class="anchor" aria-label="anchor" href="#additional-considerations-when-designing-an-informative-study"><i class="fas fa-link"></i></a>
</h2>
<p>So far, the focus has been on justifying the sample size for quantitative studies. There are a number of related topics that can be useful to design an informative study. First, in addition to a-priori or prospective power analysis and sensitivity power analysis, it is important to discuss compromise power analysis (which is useful) and post-hoc or retrospective power analysis (which is not useful, e.g., <span class="citation">Zumbo &amp; Hubley (<a href="references.html#ref-zumbo_note_1998" role="doc-biblioref">1998</a>)</span>, <span class="citation">Lenth (<a href="references.html#ref-lenth_post_2007" role="doc-biblioref">2007</a>)</span>). When sample sizes are justified based on an a-priori power analysis it can be very efficient to collect data in sequential designs where data collection is continued or terminated based on interim analyses of the data. Furthermore, it is worthwhile to consider ways to increase the power of a test without increasing the sample size. An additional point of attention is to have a good understanding of your dependent variable, especially it's standard deviation. Finally, sample size justification is just as important in qualitative studies, and although there has been much less work on sample size justification in this domain, some proposals exist that researchers can use to design an informative study. Each of these topics is discussed in turn.</p>
</div>
<div id="compromise-power-analysis" class="section level2" number="8.21">
<h2>
<span class="header-section-number">8.21</span> Compromise Power Analysis<a class="anchor" aria-label="anchor" href="#compromise-power-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>In a compromise power analysis the sample size and the effect are fixed, and the error rates of the test are calculated, based on a desired ratio between the Type I and Type II error rate. A compromise power analysis is useful both when a very large number of observations will be collected, as when only a small number of observations can be collected.</p>
<p>In the first situation a researcher might be fortunate enough to be able to collect so many observations that the statistical power for a test is very high for all effect sizes that are deemed interesting. For example, imagine a researcher has access to 2000 employees who are all required to answer questions during a yearly evaluation in a company where they are testing an intervention that should reduce subjectively reported stress levels. You are quite confident that an effect smaller than <em>d</em> = 0.2 is not large enough to be subjectively noticeable for individuals <span class="citation">(<a href="references.html#ref-jaeschke_measurement_1989" role="doc-biblioref">Jaeschke et al., 1989</a>)</span>. With an alpha level of 0.05 the researcher would have a statistical power of 0.994, or a Type II error rate of 0.006. This means that for a smallest effect size of interest of <em>d</em> = 0.2 the researcher is 8.3 times more likely to make a Type I error than a Type II error.</p>
<p>Although the original idea of designing studies that control Type I and Type II error error rates was that researchers would need to justify their error rates <span class="citation">(<a href="references.html#ref-neyman_problem_1933" role="doc-biblioref">Neyman &amp; Pearson, 1933</a>)</span>, a common heuristic is to set the Type I error rate to 0.05 and the Type II error rate to 0.20, meaning that a Type I error is 4 times as unlikely as a Type II error. The default use of 80% power (or a 20% Type II or <span class="math inline">\(\beta\)</span> error) is based on a personal preference of <span class="citation">Cohen (<a href="references.html#ref-cohen_statistical_1988" role="doc-biblioref">1988</a>)</span>, who writes:</p>
<blockquote>
<p>It is proposed here as a convention that, when the investigator has no other basis for setting the desired power value, the value .80 be used. This means that <span class="math inline">\(\beta\)</span> is set at .20. This arbitrary but reasonable value is offered for several reasons (Cohen, 1965, pp. 98-99). The chief among them takes into consideration the implicit convention for <span class="math inline">\(\alpha\)</span> of .05. The <span class="math inline">\(\beta\)</span> of .20 is chosen with the idea that the general relative seriousness of these two kinds of errors is of the order of .20/.05, i.e., that Type I errors are of the order of four times as serious as Type II errors. This .80 desired power convention is offered with the hope that it will be ignored whenever an investigator can find a basis in his substantive concerns in his specific research investigation to choose a value ad hoc.</p>
</blockquote>
<p>We see that conventions are built on conventions: the norm to aim for 80% power is built on the norm to set the alpha level at 5%. What we should take away from Cohen is not that we should aim for 80% power, but that we should justify our error rates based on the relative seriousness of each error. This is where compromise power analysis comes in. If you share Cohen's belief that a Type I error is 4 times as serious as a Type II error, and building on our earlier study on 2000 employees, it makes sense to adjust the Type I error rate when the Type II error rate is low for all effect sizes of interest <span class="citation">(<a href="references.html#ref-cascio_open_1983" role="doc-biblioref">Cascio &amp; Zedeck, 1983</a>)</span>. Indeed, <span class="citation">Erdfelder et al. (<a href="references.html#ref-erdfelder_gpower_1996" role="doc-biblioref">1996</a>)</span> created the G*Power software in part to give researchers a tool to perform compromise power analysis.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gpowcompromise"></span>
<img src="images/compromise1.png" alt="Compromise power analysis in G*Power." width="240"><p class="caption">
Figure 8.10: Compromise power analysis in G*Power.
</p>
</div>
<p>Figure <a href="power.html#fig:gpowcompromise">8.10</a> illustrates how a compromise power analysis is performed in G*Power when a Type I error is deemed to be equally costly as a Type II error, which for for a study with 1000 observations per condition would lead to a Type I error and a Type II error of 0.0179. As Faul, Erdfelder, Lang, and Buchner <span class="citation">(<a href="references.html#ref-faul_gpower_2007" role="doc-biblioref">2007</a>)</span> write:</p>
<blockquote>
<p>Of course, compromise power analyses can easily result in unconventional significance levels greater than <span class="math inline">\(\alpha\)</span> = .05 (in the case of small samples or effect sizes) or less than <span class="math inline">\(\alpha\)</span> = .001 (in the case of large samples or effect sizes). However, we believe that the benefit of balanced Type I and Type II error risks often offsets the costs of violating significance level conventions.</p>
</blockquote>
<p>This brings us to the second situation where a compromise power analysis can be useful, which is when we know the statistical power in our study is low. Although it is highly undesirable to make decisions when error rates are high, if one finds oneself in a situation where a decision must be made based on little information, <span class="citation">Winer (<a href="references.html#ref-winer_statistical_1962" role="doc-biblioref">1962</a>)</span> writes:</p>
<blockquote>
<p>The frequent use of the .05 and .01 levels of significance is a matter of convention having little scientific or logical basis. When the power of tests is likely to be low under these levels of significance, and when Type I and Type II errors are of approximately equal importance, the .30 and .20 levels of significance may be more appropriate than the .05 and .01 levels.</p>
</blockquote>
<p>For example, if we plan to perform a two-sided <em>t</em> test, can feasibly collect at most 50 observations in each independent group, and expect a population effect size of 0.5, we would have 70% power if we set our alpha level to 0.05. We can choose to weigh both types of error equally, and set the alpha level to 0.149, to end up with a statistical power for an effect of <em>d</em> = 0.5 of 0.851 (given a 0.149 Type II error rate). The choice of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in a compromise power analysis can be extended to take prior probabilities of the null and alternative hypothesis into account <span class="citation">(<a href="references.html#ref-maier_justify_2022" role="doc-biblioref">Maier &amp; Lakens, 2022</a>; <a href="references.html#ref-miller_quest_2019" role="doc-biblioref">Miller &amp; Ulrich, 2019</a>; <a href="references.html#ref-murphy_statistical_2014" role="doc-biblioref">Murphy et al., 2014</a>)</span>.</p>
<p>A compromise power analysis requires a researcher to specify the sample size. This sample size itself requires a justification, so a compromise power analysis will typically be performed together with a resource constraint justification for a sample size. It is especially important to perform a compromise power analysis if your resource constraint justification is strongly based on the need to make a decision, in which case a researcher should think carefully about the Type I and Type II error rates stakeholders are willing to accept. However, a compromise power analysis also makes sense if the sample size is very large, but a researcher did not have the freedom to set the sample size. This might happen if, for example, data collection is part of a larger international study and the sample size is based on other research questions. In designs where the Type II error rates is very small (and power is very high) some statisticians have also recommended to lower the alpha level to prevent Lindley's paradox, a situation where a significant effect (<em>p</em> &lt; <span class="math inline">\(\alpha\)</span>) is evidence for the null hypothesis <span class="citation">(<a href="references.html#ref-good_bayesnon-bayes_1992" role="doc-biblioref">Good, 1992</a>; <a href="references.html#ref-jeffreys_theory_1939" role="doc-biblioref">Jeffreys, 1939</a>)</span>. Lowering the alpha level as a function of the statistical power of the test can prevent this paradox, providing another argument for a compromise power analysis when sample sizes are large <span class="citation">(<a href="references.html#ref-maier_justify_2022" role="doc-biblioref">Maier &amp; Lakens, 2022</a>)</span>. Finally, a compromise power analysis needs a justification for the effect size, either based on a smallest effect size of interest or an effect size that is expected. Table <a href="power.html#tab:table-compromise-just">8.7</a> lists three aspects that should be discussed alongside a reported compromise power analysis.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table-compromise-just">Table 8.7: </span>Overview of recommendations when justifying error rates based on a compromise power analysis.
</caption>
<thead><tr>
<th style="text-align:left;">
Type of justification
</th>
<th style="text-align:left;">
When is this justification applicable?
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Measure entire population
</td>
<td style="text-align:left;">
A researcher can specify the entire population, it is finite, and it is possible to measure (almost) every entity in the population.
</td>
</tr>
<tr>
<td style="text-align:left;">
Resource constraints
</td>
<td style="text-align:left;">
Limited resources are the primary reason for the choice of the sample size a researcher can collect.
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
The research question focusses on the size of a parameter, and a researcher collects sufficient data to have an estimate with a desired level of accuracy.
</td>
</tr>
<tr>
<td style="text-align:left;">
A-priori power analysis
</td>
<td style="text-align:left;">
The research question has the aim to test whether certain effect sizes can be statistically rejected with a desired statistical power.
</td>
</tr>
<tr>
<td style="text-align:left;">
Heuristics
</td>
<td style="text-align:left;">
A researcher decides upon the sample size based on a heuristic, general rule or norm that is described in the literature, or communicated orally.
</td>
</tr>
<tr>
<td style="text-align:left;">
No justification
</td>
<td style="text-align:left;">
A researcher has no reason to choose a specific sample size, or does not have a clearly specified inferential goal and wants to communicate this honestly.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="what-to-do-if-your-editor-asks-for-post-hoc-power" class="section level2" number="8.22">
<h2>
<span class="header-section-number">8.22</span> What to do if Your Editor Asks for Post-hoc Power?<a class="anchor" aria-label="anchor" href="#what-to-do-if-your-editor-asks-for-post-hoc-power"><i class="fas fa-link"></i></a>
</h2>
<p>Post-hoc, retrospective, or observed power is used to describe the statistical power of the test that is computed assuming the effect size that has been estimated from the collected data is the true effect size <span class="citation">(<a href="references.html#ref-lenth_post_2007" role="doc-biblioref">Lenth, 2007</a>; <a href="references.html#ref-zumbo_note_1998" role="doc-biblioref">Zumbo &amp; Hubley, 1998</a>)</span>. Post-hoc power is therefore not performed before looking at the data, based on effect sizes that are deemed interesting, as in an a-priori power analysis, and it is unlike a sensitivity power analysis where a range of interesting effect sizes is evaluated. Because a post-hoc or retrospective power analysis is based on the effect size observed in the data that has been collected, it does not add any information beyond the reported <em>p</em> value, but it presents the same information in a different way. Despite this fact, editors and reviewers often ask authors to perform post-hoc power analysis to interpret non-significant results. This is not a sensible request, and whenever it is made, you should not comply with it. Instead, you should perform a sensitivity power analysis, and discuss the power for the smallest effect size of interest and a realistic range of expected effect sizes.</p>
<p>Post-hoc power is directly related to the <em>p</em> value of the statistical test <span class="citation">(<a href="references.html#ref-hoenig_abuse_2001" role="doc-biblioref">Hoenig &amp; Heisey, 2001</a>)</span>. For a <em>z</em> test where the <em>p</em> value is exactly 0.05, post-hoc power is always 50%. The reason for this relationship is that when a <em>p</em> value is observed that equals the alpha level of the test (e.g., 0.05), the observed <em>z</em> score of the test is exactly equal to the critical value of the test (e.g., <em>z</em> = 1.96 in a two-sided test with a 5% alpha level). Whenever the alternative hypothesis is centered on the critical value half the values we expect to observe if this alternative hypothesis is true fall below the critical value, and half fall above the critical value. Therefore, a test where we observed a <em>p</em> value identical to the alpha level will have exactly 50% power in a post-hoc power analysis, as the analysis assumes the observed effect size is true.</p>
<!-- ```{r obs-power-plot-1, echo = FALSE, fig.width = 8, fig.height = 8, fig.cap="Relationship between p-values and power for a Z-test."} -->
<!-- # For simplicity, take a one-sided test -->
<!-- # compute z value from p: -->
<!-- # p_val = 0.05 -->
<!-- # z <- qnorm(1-p_val) -->
<!-- # z -->
<!-- #  -->
<!-- # # compute p-value from z -->
<!-- # 1-pnorm(z) -->
<!-- # computing the Type I error rate: -->
<!-- # old, two-sided: 1-pnorm(q = 1.959964) + pnorm(q = -1.959964) -->
<!-- # Moving the mean from 0.  -->
<!-- # Because the normal distribution is symmetric, if we observe a p-value on top of the critical value (p = 0.05) we have 50% power. -->
<!-- # pnorm(q = 1.644854, mean = 1.644854) -->
<!-- # We can plot this across a range of observe p-values -->
<!-- plot_obs_pow <- (function(alpha_level, p_val) { -->
<!--   1 - pnorm(q = qnorm(1-alpha_level), mean = qnorm(1-p_val)) -->
<!-- }) -->
<!-- par(bg = "aliceblue", pty = "s") -->
<!-- plot(-10, -->
<!--   xlab = "p-value", ylab = "Observed power", axes = FALSE, -->
<!--   main = substitute(paste("Relationship between p-value and observed power")), xlim = c(0, 1), ylim = c(0, 1) -->
<!-- ) -->
<!-- abline(v = seq(0, 1, 0.1), h = seq(0, 1, 0.1), col = "lightgrey", lty = 1) -->
<!-- axis(side = 1, at = seq(0, 1, 0.1), labels = seq(0, 1, 0.1)) -->
<!-- axis(side = 2, at = seq(0, 1, 0.1), labels = seq(0, 1, 0.1)) -->
<!-- curve(plot_obs_pow(alpha_level = 0.05, p_val = x), 0, 1, add = TRUE, lwd = 3) -->
<!-- points(x = 0.05, y = 0.5, cex = 2, pch = 19, col = rgb(1, 0, 0, 0.5)) -->
<!-- abline(v = 0.05, h = 0.5, col = rgb(1, 0, 0, 0.5), lty = 1) -->
<!-- ``` -->
<p>For other statistical tests, where the alternative distribution is not symmetric (such as for the <em>t</em> test, where the alternative hypothesis follows a non-central <em>t</em> distribution, see Figure <a href="power.html#fig:noncentralt">8.7</a>), a <em>p</em> = 0.05 does not directly translate to an observed power of 50%, but by plotting post-hoc power against the observed <em>p</em> value we see that the two statistics are always directly related. As Figure <a href="power.html#fig:obs-power-plot-2">8.11</a> shows, if the <em>p</em> value is non-significant (i.e., larger than 0.05) the observed power will be less than approximately 50% in a <em>t</em> test. Lenth <span class="citation">(<a href="references.html#ref-lenth_post_2007" role="doc-biblioref">2007</a>)</span> explains how observed power is also completely determined by the observed <em>p</em> value for <em>F</em> tests, although the statement that a non-significant <em>p</em> value implies a power less than 50% no longer holds.</p>
<!-- We can compute observe power in R based on the formula below, where `alpha_level` is the alpha level, `n`is the sample size in each group, and `p_val` is the observed *p* value. In Figure \@ref(fig:obs-power-plot-2) we see that for a *p* = 0.05 observed power is ever so slightly larger than 50%, but the observed power value is very close.  -->
<!-- ```{r obs_power-plot-2, echo = TRUE, eval = FALSE} -->
<!-- 1 - pt(q = qt(1 - alpha_level/2, 2 * n - 2),  -->
<!--        df = 2 * n - 2,  -->
<!--        ncp = qt(1 - p_val/2, 2 * n - 2)) -->
<!-- ``` -->
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:obs-power-plot-2"></span>
<img src="08-samplesizejustification_files/figure-html/obs-power-plot-2-1.png" alt="Relationship between *p* values and power for an independent *t* test with $\alpha$ = 0.05 and n = 10." width="100%"><p class="caption">
Figure 8.11: Relationship between <em>p</em> values and power for an independent <em>t</em> test with <span class="math inline">\(\alpha\)</span> = 0.05 and n = 10.
</p>
</div>
<p>When editors or reviewers ask researchers to report post-hoc power analyses they would like to be able to distinguish between true negatives (concluding there is no effect, when there is no effect) and false negatives (a Type II error, concluding there is no effect, when there actually is an effect). Since reporting post-hoc power is just a different way of reporting the <em>p</em> value, reporting the post-hoc power will not provide an answer to the question editors are asking <span class="citation">(<a href="references.html#ref-hoenig_abuse_2001" role="doc-biblioref">Hoenig &amp; Heisey, 2001</a>; <a href="references.html#ref-lenth_post_2007" role="doc-biblioref">Lenth, 2007</a>; <a href="references.html#ref-schulz_sample_2005" role="doc-biblioref">Schulz &amp; Grimes, 2005</a>; <a href="references.html#ref-yuan_post_2005" role="doc-biblioref">Yuan &amp; Maxwell, 2005</a>)</span>. To be able to draw conclusions about the absence of a meaningful effect, one should perform an equivalence test, and design a study with high power to reject the smallest effect size of interest <span class="citation">(<a href="references.html#ref-lakens_equivalence_2018" role="doc-biblioref">Lakens, Scheel, et al., 2018</a>)</span>. Alternatively, if no smallest effect size of interest was specified when designing the study, researchers can report a sensitivity power analysis.</p>
</div>
<div id="sequential-analyses" class="section level2" number="8.23">
<h2>
<span class="header-section-number">8.23</span> Sequential Analyses<a class="anchor" aria-label="anchor" href="#sequential-analyses"><i class="fas fa-link"></i></a>
</h2>
<p>Whenever the sample size is justified based on an a-priori power analysis it can be very efficient to collect data in a sequential design. Sequential designs control error rates across multiple looks at the data (e.g., after 50, 100, and 150 observations have been collected) and can reduce the average expected sample size that is collected compared to a fixed design where data is only analyzed after the maximum sample size is collected <span class="citation">(<a href="references.html#ref-proschan_statistical_2006" role="doc-biblioref">Proschan et al., 2006</a>; <a href="references.html#ref-wassmer_group_2016" role="doc-biblioref">Wassmer &amp; Brannath, 2016</a>)</span>. Sequential designs have a long history <span class="citation">(<a href="references.html#ref-dodge_method_1929" role="doc-biblioref">Dodge &amp; Romig, 1929</a>)</span>, and exist in many variations, such as the Sequential Probability Ratio Test <span class="citation">(<a href="references.html#ref-wald_sequential_1945" role="doc-biblioref">Wald, 1945</a>)</span>, combining independent statistical tests <span class="citation">(<a href="references.html#ref-westberg_combining_1985" role="doc-biblioref">Westberg, 1985</a>)</span>, group sequential designs <span class="citation">(<a href="references.html#ref-jennison_group_2000" role="doc-biblioref">Jennison &amp; Turnbull, 2000</a>)</span>, sequential Bayes factors <span class="citation">(<a href="references.html#ref-schonbrodt_sequential_2017" role="doc-biblioref">Sch√∂nbrodt et al., 2017</a>)</span>, and safe testing <span class="citation">(<a href="references.html#ref-grunwald_safe_2019" role="doc-biblioref">Gr√ºnwald et al., 2019</a>)</span>. Of these approaches, the Sequential Probability Ratio Test is most efficient if data can be analyzed after every observation <span class="citation">(<a href="references.html#ref-schnuerch_controlling_2020" role="doc-biblioref">Schnuerch &amp; Erdfelder, 2020</a>)</span>. Group sequential designs, where data is collected in batches, provide more flexibility in data collection, error control, and corrections for effect size estimates <span class="citation">(<a href="references.html#ref-wassmer_group_2016" role="doc-biblioref">Wassmer &amp; Brannath, 2016</a>)</span>. Safe tests provide optimal flexibility if there are dependencies between observations <span class="citation">(<a href="references.html#ref-ter_schure_accumulation_2019" role="doc-biblioref">ter Schure &amp; Gr√ºnwald, 2019</a>)</span>.</p>
<p>Sequential designs are especially useful when there is considerable uncertainty about the effect size, or when it is plausible that the true effect size is larger than the smallest effect size of interest the study is designed to detect <span class="citation">(<a href="references.html#ref-lakens_performing_2014" role="doc-biblioref">Lakens, 2014</a>)</span>. In such situations data collection has the possibility to terminate early if the effect size is larger than the smallest effect size of interest, but data collection can continue to the maximum sample size if needed. Sequential designs can prevent waste when testing hypotheses, both by stopping early when the null hypothesis can be rejected, as by stopping early if the presence of a smallest effect size of interest can be rejected (i.e., stopping for futility). Group sequential designs are currently the most widely used approach to sequential analyses, and can be planned and analyzed using rpact <span class="citation">(<a href="references.html#ref-wassmer_rpact_2019" role="doc-biblioref">Wassmer &amp; Pahlke, 2019</a>)</span> or gsDesign <span class="citation">(<a href="references.html#ref-anderson_group_2014" role="doc-biblioref">K. M. Anderson, 2014</a>)</span>.<a href="references.html#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
</div>
<div id="increasing-power-without-increasing-the-sample-size" class="section level2" number="8.24">
<h2>
<span class="header-section-number">8.24</span> Increasing Power Without Increasing the Sample Size<a class="anchor" aria-label="anchor" href="#increasing-power-without-increasing-the-sample-size"><i class="fas fa-link"></i></a>
</h2>
<p>The most straightforward approach to increase the informational value of studies is to increase the sample size. Because resources are often limited, it is also worthwhile to explore different approaches to increasing the power of a test without increasing the sample size. The first option is to use directional tests where relevant. Researchers often make directional predictions, such as ‚Äòwe predict X is larger than Y‚Äô. The statistical test that logically follows from this prediction is a directional (or one-sided) <em>t</em> test. A directional test moves the Type I error rate to one side of the tail of the distribution, which lowers the critical value, and therefore requires less observations to achieve the same statistical power.</p>
<p>Although there is some discussion about when directional tests are appropriate, they are perfectly defensible from a Neyman-Pearson perspective on hypothesis testing <span class="citation">(<a href="references.html#ref-cho_is_2013" role="doc-biblioref">Cho &amp; Abe, 2013</a>)</span>, which makes a (preregistered) directional test a straightforward approach to both increase the power of a test, as the riskiness of the prediction. However, there might be situations where you do not want to ask a directional question. Sometimes, especially in research with applied consequences, it might be important to examine if a null effect can be rejected, even if the effect is in the opposite direction as predicted. For example, when you are evaluating a recently introduced educational intervention, and you predict the intervention will increase the performance of students, you might want to explore the possibility that students perform worse, to be able to recommend abandoning the new intervention. In such cases it is also possible to distribute the error rate in a 'lop-sided' manner, for example assigning a stricter error rate to effects in the negative than in the positive direction <span class="citation">(<a href="references.html#ref-rice_heads_1994" role="doc-biblioref">Rice &amp; Gaines, 1994</a>)</span>.</p>
<p>Another approach to increase the power without increasing the sample size, is to increase the alpha level of the test, as explained in the section on compromise power analysis. Obviously, this comes at an increased probability of making a Type I error. The risk of making either type of error should be carefully weighed, which typically requires taking into account the prior probability that the null-hypothesis is true <span class="citation">(<a href="references.html#ref-cascio_open_1983" role="doc-biblioref">Cascio &amp; Zedeck, 1983</a>; <a href="references.html#ref-miller_quest_2019" role="doc-biblioref">Miller &amp; Ulrich, 2019</a>; <a href="references.html#ref-mudge_setting_2012" role="doc-biblioref">Mudge et al., 2012</a>; <a href="references.html#ref-murphy_statistical_2014" role="doc-biblioref">Murphy et al., 2014</a>)</span>. If you <em>have</em> to make a decision, or want to make a claim, and the data you can feasibly collect is limited, increasing the alpha level is justified, either based on a compromise power analysis, or based on a cost-benefit analysis <span class="citation">(<a href="references.html#ref-baguley_understanding_2004" role="doc-biblioref">Baguley, 2004</a>; <a href="references.html#ref-field_minimizing_2004" role="doc-biblioref">Field et al., 2004</a>)</span>.</p>
<p>Another widely recommended approach to increase the power of a study is use a within participant design where possible. In almost all cases where a researcher is interested in detecting a difference between groups, a within participant design will require collecting less participants than a between participant design. The reason for the decrease in the sample size is explained by the equation below from <span class="citation">Maxwell et al. (<a href="references.html#ref-maxwell_designing_2017" role="doc-biblioref">2017</a>)</span>. The number of participants needed in a two group within-participants design (NW) relative to the number of participants needed in a two group between-participants design (NB), assuming normal distributions, is:</p>
<p><span class="math display">\[NW = \frac{NB (1-\rho)}{2}\]</span></p>
<p>The required number of participants is divided by two because in a within-participants design with two conditions every participant provides two data points. The extent to which this reduces the sample size compared to a between-participants design also depends on the correlation between the dependent variables (e.g., the correlation between the measure collected in a control task and an experimental task), as indicated by the (1-<span class="math inline">\(\rho\)</span>) part of the equation. If the correlation is 0, a within-participants design simply needs half as many participants as a between participant design (e.g., 64 instead 128 participants). The higher the correlation, the larger the relative benefit of within-participants designs, and whenever the correlation is negative (up to -1) the relative benefit disappears. Especially when dependent variables in within-participants designs are positively correlated, within-participants designs will greatly increase the power you can achieve given the sample size you have available. Use within-participants designs when possible, but weigh the benefits of higher power against the downsides of order effects or carryover effects that might be problematic in a within-participants design <span class="citation">(<a href="references.html#ref-maxwell_designing_2017" role="doc-biblioref">Maxwell et al., 2017</a>)</span>.<a href="references.html#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> For designs with multiple factors with multiple levels it can be difficult to specify the full correlation matrix that specifies the expected population correlation for each pair of measurements <span class="citation">(<a href="references.html#ref-lakens_simulation-based_2021" role="doc-biblioref">Lakens &amp; Caldwell, 2021</a>)</span>. In these cases sequential analyses might provide a solution.</p>
<!-- So what does the correlation do so that it increases the power of within designs, or reduces the number of observations you need? Let‚Äôs see what effect the correlation has on power by simulating and plotting correlated data. In the R script below, I‚Äôm simulating two measurements of IQ scores with a specific sample size (i.e., 10000), mean (i.e., 100 vs 106), standard deviation (i.e., 15), and correlation between the two measurements. The script generates three plots. -->
<!-- We will start with a simulation where the correlation between measurements is 0. First, we see the two normally distributed IQ measurements on the left, with means of 100 and 106, and standard deviations of 15 (due to the large sample size, the numbers equal the input in the simulation, although small variation might still occur). In the scatter plot on the right, we can see that the correlation between the measurements is indeed 0. Let's look at the distribution of the mean differences. The mean difference is -6 (in line with the simulation settings), and the standard deviation is 21. This is also as expected. The standard deviation of the difference scores is $\sqrt{2}$ times as large as the standard deviation in each measurement, and indeed, 15√ó$\sqrt{2}$ = 21.21, which is rounded to 21. This situation where the correlation between measurements is zero equals the situation in an independent *t* test, where the correlation between measurements is not taken into account.  -->
<!-- ```{r, plot-1, fig.height = 16, fig.fullwidth = TRUE, fig.cap="Distributions of two dependent groups with means 100 and 106 and a standard deviation of 15, distribution of the differences, and correlation of 0."} -->
<!-- set.seed(419) -->
<!-- #Set color palette -->
<!-- cbbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7") -->
<!-- n <- 10000 # set the sample size for each group -->
<!-- mx <- 100 # set the mean in group 1 -->
<!-- sdx <- 15 # set the standard deviation in group 1 -->
<!-- my <- 106 # set the mean in group 2 -->
<!-- sdy <- 15 # set the standard deviation in group 2 -->
<!-- cor.true <- 0.0 # set true correlation -->
<!-- # randomly draw data -->
<!-- cov.mat <- matrix(c(1.0, cor.true, cor.true, 1.0), nrow = 2, byrow = T) -->
<!-- mu <- c(0, 0) -->
<!-- mat <- mvrnorm(n, Sigma = cov.mat, mu = mu, empirical = FALSE) -->
<!-- x <- mat[, 1] * sdx + mx -->
<!-- y <- mat[, 2] * sdy + my -->
<!-- dif <- x - y -->
<!-- dataset <- data.frame(x, y) -->
<!-- DV <- c(x, y) # combine the two samples into a single variable -->
<!-- IV <- as.factor(c(rep("1", n), rep("2", n))) # create the independent variable (1 and 2) -->
<!-- datasetplot <- data.frame(IV, DV) # create a dataframe (to make the plot) -->
<!-- #plot graph two groups -->
<!-- p1 <- ggplot(datasetplot, aes(DV, fill = as.factor(IV))) + -->
<!--   geom_histogram(alpha = 0.4, binwidth = 2, position = "identity", colour = "black", aes(y = ..density..)) + -->
<!--   scale_fill_manual(values = cbbPalette, name = "Condition") + -->
<!--   stat_function(fun = dnorm, args = c(mean = mx, sd = sdx), size = 1, color = "#E69F00", lty = 2) + -->
<!--   stat_function(fun = dnorm, args = c(mean = my, sd = sdy), size = 1, color = "#56B4E9", lty = 2) + -->
<!--   xlab("IQ") + -->
<!--   ylab("number of people") + -->
<!--   ggtitle("Data") + -->
<!--   theme_bw(base_size = 20) + -->
<!--   theme(panel.grid.major.x = element_blank(), axis.text.y = element_blank(), panel.grid.minor.x = element_blank()) + -->
<!--   geom_vline(xintercept = mean(x), colour = "black", linetype = "dashed", size = 1) + -->
<!--   geom_vline(xintercept = mean(y), colour = "black", linetype = "dashed", size = 1) + -->
<!--   coord_cartesian(xlim = c(50, 150)) + -->
<!--   scale_x_continuous(breaks = c(60, 80, 100, 120, 140)) + -->
<!--   annotate("text", size = 6, x = 70, y = 0.02, label = paste("Mean X = ", round(mean(x)), "\n", "SD = ", round(sd(x)), sep = "")) + -->
<!--   annotate("text", size = 6, x = 130, y = 0.02, label = paste("Mean Y = ", round(mean(y)), "\n", "SD = ", round(sd(y)), sep = "")) + -->
<!--   theme(plot.title = element_text(hjust = 0.5), legend.position = "none") -->
<!-- #plot data differences -->
<!-- p2 <- ggplot(as.data.frame(dif), aes(dif)) + -->
<!--   geom_histogram(colour = "black", fill = "grey", aes(y = ..density..), binwidth = 2) + -->
<!--   #  geom_density(fill=NA, colour="black", size = 1) + -->
<!--   xlab("IQ dif") + -->
<!--   ylab("number of people") + -->
<!--   ggtitle("Data") + -->
<!--   theme_bw(base_size = 20) + -->
<!--   theme(panel.grid.major.x = element_blank(), axis.text.y = element_blank(), panel.grid.minor.x = element_blank()) + -->
<!--   geom_vline(xintercept = mean(dif), colour = "grey20", linetype = "dashed") + -->
<!--   coord_cartesian(xlim = c(-80, 80)) + -->
<!--   scale_x_continuous(breaks = c(seq(-80, 80, 20))) + -->
<!--   annotate("text", size = 6, x = mean(dif), y = 0.01, label = paste("Mean = ", round(mean(dif)), "\n", "SD = ", round(sd(dif)), sep = "")) + -->
<!--   theme(plot.title = element_text(hjust = 0.5)) -->
<!-- # Plot correlation -->
<!-- p3 <- ggplot(dataset, aes(x = x, y = y)) + -->
<!--   geom_point(size = 2) + # Use hollow circles -->
<!--   geom_smooth(method = lm, colour = "#E69F00", size = 1, fill = "#56B4E9") + # Add linear regression line -->
<!--   coord_cartesian(xlim = c(40, 160), ylim = c(40, 160)) + -->
<!--   scale_x_continuous(breaks = c(seq(40, 160, 20))) + -->
<!--   scale_y_continuous(breaks = c(seq(40, 160, 20))) + -->
<!--   xlab("IQ twin 1") + -->
<!--   ylab("IQ twin 2") + -->
<!--   ggtitle(paste("Correlation = ", round(cor(x, y), digits = 2), sep = "")) + -->
<!--   theme_bw(base_size = 20) + -->
<!--   theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) + -->
<!--   coord_fixed(ratio = 1) + -->
<!--   theme(plot.title = element_text(hjust = 0.5)) -->
<!-- # Use patchwork to combine and plot only 1 legend without title. -->
<!-- combined <- p1 / p2 / p3 + -->
<!--   theme(legend.position = "none", legend.title = element_blank()) -->
<!-- combined -->
<!-- ``` -->
<!-- ```{r, plot-4, fig.height = 16, fig.fullwidth = TRUE, fig.cap="Distributions of two independent groups with means 100 and 106 and a standard deviation of 15, distribution of the differences, and correlation of 0.7."} -->
<!-- set.seed(419) -->
<!-- #Set color palette -->
<!-- cbbPalette<-c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7") -->
<!-- n<-10000  #set the sample size for each group -->
<!-- mx<-100  #set the mean in group 1 -->
<!-- sdx<-15  #set the standard deviation in group 1 -->
<!-- my<-106  #set the mean in group 2 -->
<!-- sdy<-15  #set the standard deviation in group 2 -->
<!-- cor.true <- 0.7 #set true correlation -->
<!-- #randomly draw data -->
<!-- cov.mat <- matrix(c(1.0, cor.true, cor.true, 1.0), nrow = 2, byrow = T) -->
<!-- mu <- c(0,0) -->
<!-- mat <- mvrnorm(n, Sigma = cov.mat, mu = mu, empirical = FALSE) -->
<!-- x<-mat[,1]*sdx+mx -->
<!-- y<-mat[,2]*sdy+my -->
<!-- dif<-x-y -->
<!-- dataset<-data.frame(x,y) -->
<!-- DV<-c(x,y) #combine the two samples into a single variable -->
<!-- IV<-as.factor(c(rep("1", n), rep("2", n))) #create the independent variable (1 and 2)  -->
<!-- datasetplot<-data.frame(IV,DV) #create a dataframe (to make the plot) -->
<!-- #plot graph two groups -->
<!-- p1 <- ggplot(datasetplot, aes(DV, fill = as.factor(IV))) + -->
<!--   geom_histogram(alpha = 0.4, binwidth = 2, position = "identity", colour = "black", aes(y = ..density..)) + -->
<!--   scale_fill_manual(values = cbbPalette, name = "Condition") + -->
<!--   stat_function(fun = dnorm, args = c(mean = mx, sd = sdx), size = 1, color = "#E69F00", lty = 2) + -->
<!--   stat_function(fun = dnorm, args = c(mean = my, sd = sdy), size = 1, color = "#56B4E9", lty = 2) + -->
<!--   xlab("IQ") + -->
<!--   ylab("number of people") + -->
<!--   ggtitle("Data") + -->
<!--   theme_bw(base_size = 20) + -->
<!--   theme(panel.grid.major.x = element_blank(), axis.text.y = element_blank(), panel.grid.minor.x = element_blank()) + -->
<!--   geom_vline(xintercept = mean(x), colour = "black", linetype = "dashed", size = 1) + -->
<!--   geom_vline(xintercept = mean(y), colour = "black", linetype = "dashed", size = 1) + -->
<!--   coord_cartesian(xlim = c(50, 150)) + -->
<!--   scale_x_continuous(breaks = c(60, 80, 100, 120, 140)) + -->
<!--   annotate("text", size = 6, x = 70, y = 0.02, label = paste("Mean X = ", round(mean(x)), "\n", "SD = ", round(sd(x)), sep = "")) + -->
<!--   annotate("text", size = 6, x = 130, y = 0.02, label = paste("Mean Y = ", round(mean(y)), "\n", "SD = ", round(sd(y)), sep = "")) + -->
<!--   theme(plot.title = element_text(hjust = 0.5), legend.position = "none") -->
<!-- #plot data differences -->
<!-- p2 <- ggplot(as.data.frame(dif), aes(dif)) + -->
<!--   geom_histogram(colour = "black", fill = "grey", aes(y = ..density..), binwidth = 2) + -->
<!--   #  geom_density(fill=NA, colour="black", size = 1) + -->
<!--   xlab("IQ dif") + -->
<!--   ylab("number of people") + -->
<!--   ggtitle("Data") + -->
<!--   theme_bw(base_size = 20) + -->
<!--   theme(panel.grid.major.x = element_blank(), axis.text.y = element_blank(), panel.grid.minor.x = element_blank()) + -->
<!--   geom_vline(xintercept = mean(dif), colour = "grey20", linetype = "dashed") + -->
<!--   coord_cartesian(xlim = c(-80, 80)) + -->
<!--   scale_x_continuous(breaks = c(seq(-80, 80, 20))) + -->
<!--   annotate("text", size = 6, x = mean(dif), y = 0.01, label = paste("Mean = ", round(mean(dif)), "\n", "SD = ", round(sd(dif)), sep = "")) + -->
<!--   theme(plot.title = element_text(hjust = 0.5)) -->
<!-- # Plot correlation -->
<!-- p3 <- ggplot(dataset, aes(x = x, y = y)) + -->
<!--   geom_point(size = 2) + # Use hollow circles -->
<!--   geom_smooth(method = lm, colour = "#E69F00", size = 1, fill = "#56B4E9") + # Add linear regression line -->
<!--   coord_cartesian(xlim = c(40, 160), ylim = c(40, 160)) + -->
<!--   scale_x_continuous(breaks = c(seq(40, 160, 20))) + -->
<!--   scale_y_continuous(breaks = c(seq(40, 160, 20))) + -->
<!--   xlab("IQ twin 1") + -->
<!--   ylab("IQ twin 2") + -->
<!--   ggtitle(paste("Correlation = ", round(cor(x, y), digits = 2), sep = "")) + -->
<!--   theme_bw(base_size = 20) + -->
<!--   theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) + -->
<!--   coord_fixed(ratio = 1) + -->
<!--   theme(plot.title = element_text(hjust = 0.5)) -->
<!-- # Use patchwork to combine and plot only 1 legend without title. -->
<!-- combined <- p1 / p2 / p3 + -->
<!--   theme(legend.position = "none", legend.title = element_blank()) -->
<!-- combined -->
<!-- ``` -->
<!-- Now let‚Äôs increase the correlation between dependent variables to 0.7. Nothing has changed when we plot the means. The correlation between measurements is now strongly positive, as we see in the plot on the right. The important difference lies in the standard deviation of the difference scores. The SD of the difference scores is 11 instead of 21 in the uncorrelated example. Because the standardized effect size is the difference divided by the standard deviation, the effect size (Cohen‚Äôs dz in within designs) is larger in this test than in the test above. -->
<!-- If you set the correlation to a negative value, the standard deviation of the difference scores would increase. I like to think of dependent variables in within-designs as dance partners. If they are well-coordinated (or highly correlated), one person steps to the left, and the other person steps to the left the same distance. If there is no coordination (or no correlation), when one dance partner steps to the left, the other dance partner is just as likely to move to the wrong direction as to the right direction. Such a dance couple will take up a lot more space on the dance floor. -->
<!-- You see that the correlation between dependent variables is an important aspect of within designs. I recommend explicitly reporting the correlation between dependent variables in within designs (e.g., participants responded significantly slower (*M* = 390, *SD* = 44) when they used their feet than when they used their hands (*M* = 371, *SD* = 44, *r* = .953), *t*(17) = 5.98, *p* < 0.001, Hedges' g = 0.43, M_diff = 19, 95% CI [12; 26]).  -->
<p>In general, the smaller the variation, the larger the standardized effect size (because we are dividing the raw effect by a smaller standard deviation) and thus the higher the power given the same number of observations. Some additional recommendations are provided in the literature <span class="citation">(<a href="references.html#ref-allison_power_1997" role="doc-biblioref">Allison et al., 1997</a>; <a href="references.html#ref-bausell_power_2002" role="doc-biblioref">Bausell &amp; Li, 2002</a>; <a href="references.html#ref-hallahan_statistical_1996" role="doc-biblioref">Hallahan &amp; Rosenthal, 1996</a>)</span>, such as:</p>
<ol style="list-style-type: decimal">
<li>Use better ways to screen participants for studies where participants need to be screened before participation.</li>
<li>Assign participants unequally to conditions (if data in the control condition is much cheaper to collect than data in the experimental condition, for example).</li>
<li>Use reliable measures that have low error variance <span class="citation">(<a href="references.html#ref-williams_impact_1995" role="doc-biblioref">Williams et al., 1995</a>)</span>.</li>
<li>Smart use of preregistered covariates <span class="citation">(<a href="references.html#ref-meyvis_increasing_2018" role="doc-biblioref">Meyvis &amp; Van Osselaer, 2018</a>)</span>.</li>
</ol>
<p>It is important to consider if these ways to reduce the variation in the data do not come at too large a cost for external validity. For example, in an <em>intention-to-treat</em> analysis in randomized controlled trials participants who do not comply with the protocol are maintained in the analysis such that the effect size from the study accurately represents the effect of implementing the intervention in the population, and not the effect of the intervention only on those people who perfectly follow the protocol <span class="citation">(<a href="references.html#ref-gupta_intention_2011" role="doc-biblioref">Gupta, 2011</a>)</span>. Similar trade-offs between reducing the variance and external validity exist in other research areas.</p>
</div>
<div id="know-your-measure" class="section level2" number="8.25">
<h2>
<span class="header-section-number">8.25</span> Know Your Measure<a class="anchor" aria-label="anchor" href="#know-your-measure"><i class="fas fa-link"></i></a>
</h2>
<p>Although it is convenient to talk about standardized effect sizes, it is generally preferable if researchers can interpret effects in the raw (unstandardized) scores, and have knowledge about the standard deviation of their measures <span class="citation">(<a href="references.html#ref-baguley_standardized_2009" role="doc-biblioref">Baguley, 2009</a>; <a href="references.html#ref-lenth_practical_2001" role="doc-biblioref">Lenth, 2001</a>)</span>. To make it possible for a research community to have realistic expectations about the standard deviation of measures they collect, it is beneficial if researchers within a research area use the same validated measures. This provides a reliable knowledge base that makes it easier to plan for a desired accuracy, and to use a smallest effect size of interest on the unstandardized scale in an a-priori power analysis.</p>
<p>In addition to knowledge about the standard deviation it is important to have knowledge about the correlations between dependent variables (for example because Cohen's d<sub>z</sub> for a dependent <em>t</em> test relies on the correlation between means). The more complex the model, the more aspects of the data-generating process need to be known to make predictions. For example, in hierarchical models researchers need knowledge about variance components to be able to perform a power analysis <span class="citation">(<a href="references.html#ref-debruine_understanding_2021" role="doc-biblioref">DeBruine &amp; Barr, 2021</a>; <a href="references.html#ref-westfall_statistical_2014" role="doc-biblioref">Westfall et al., 2014</a>)</span>. Finally, it is important to know the reliability of your measure <span class="citation">(<a href="references.html#ref-parsons_psychological_2019" role="doc-biblioref">Parsons et al., 2019</a>)</span>, especially when relying on an effect size from a published study that used a measure with different reliability, or when the same measure is used in different populations, in which case it is possible that measurement reliability differs between populations. With the increasing availability of open data, it will hopefully become easier to estimate these parameters using data from earlier studies.</p>
<p>If we calculate a standard deviation from a sample, this value is an estimate of the true value in the population. In small samples, our estimate can be quite far off, while due to the law of large numbers, as our sample size increases, we will be measuring the standard deviation more accurately. Since the sample standard deviation is an estimate with uncertainty, we can calculate a confidence interval around the estimate <span class="citation">(<a href="references.html#ref-smithson_confidence_2003" role="doc-biblioref">Smithson, 2003</a>)</span>, and design pilot studies that will yield a sufficiently reliable estimate of the standard deviation. The confidence interval for the variance <span class="math inline">\(\sigma^2\)</span> is provided in the following formula, and the confidence for the standard deviation is the square root of these limits:</p>
<p><span class="math display">\[(N - 1)s^2/\chi^2_{N-1:\alpha/2},(N - 1)s^2/\chi^2_{N-1:1-\alpha/2}\]</span></p>
<p>Whenever there is uncertainty about parameters, researchers can use sequential designs to perform an <em>internal pilot study</em> <span class="citation">(<a href="references.html#ref-wittes_role_1990" role="doc-biblioref">Wittes &amp; Brittain, 1990</a>)</span>. The idea behind an internal pilot study is that researchers specify a tentative sample size for the study, perform an interim analysis, use the data from the internal pilot study to update parameters such as the variance of the measure, and finally update the final sample size that will be collected. As long as interim looks at the data are blinded (e.g., information about the conditions is not taken into account) the sample size can be adjusted based on an updated estimate of the variance without any practical consequences for the Type I error rate <span class="citation">(<a href="references.html#ref-friede_sample_2006" role="doc-biblioref">Friede &amp; Kieser, 2006</a>; <a href="references.html#ref-proschan_two-stage_2005" role="doc-biblioref">Proschan, 2005</a>)</span>. Therefore, if researchers are interested in designing an informative study where the Type I and Type II error rates are controlled, but they lack information about the standard deviation, an internal pilot study might be an attractive approach to consider <span class="citation">(<a href="references.html#ref-chang_adaptive_2016" role="doc-biblioref">Chang, 2016</a>)</span>.</p>
</div>
<div id="conventions-as-meta-heuristics" class="section level2" number="8.26">
<h2>
<span class="header-section-number">8.26</span> Conventions as meta-heuristics<a class="anchor" aria-label="anchor" href="#conventions-as-meta-heuristics"><i class="fas fa-link"></i></a>
</h2>
<p>Even when a researcher might not use a heuristic to directly determine the sample size in a study, there is an indirect way in which heuristics play a role in sample size justifications. Sample size justifications based on inferential goals such as a power analysis, accuracy, or a decision all require researchers to choose values for a desired Type I and Type II error rate, a desired accuracy, or a smallest effect size of interest. Although it is sometimes possible to justify these values as described above (e.g., based on a cost-benefit analysis), a solid justification of these values might require dedicated research lines. Performing such research lines will not always be possible, and these studies might themselves not be worth the costs (e.g., it might require less resources to perform a study with an alpha level that most peers would consider conservatively low, than to collect all the data that would be required to determine the alpha level based on a cost-benefit analysis). In these situations, researchers might use values based on a convention.</p>
<p>When it comes to a desired width of a confidence interval, a desired power, or any other input values required to perform a sample size computation, it is important to transparently report the use of a heuristic or convention (for example by using the accompanying online Shiny app). A convention such as the use of a 5% Type 1 error rate and 80% power practically functions as a lower threshold of the minimum informational value peers are expected to accept <em>without</em> any justification (whereas <em>with</em> a justification, higher error rates can also be deemed acceptable by peers). It is important to realize that none of these values are set in stone. Journals are free to specify that they desire a higher informational value in their author guidelines (e.g., Nature Human Behavior requires registered reports to be designed to achieve 95% statistical power, and my own department has required staff to submit ERB proposals where, whenever possible, the study was designed to achieve 90% power). Researchers who choose to design studies with a higher informational value than a conventional minimum should receive credit for doing so.</p>
<p>In the past some fields have changed conventions, such as the 5 sigma threshold now used in physics to declare a discovery instead of a 5% Type I error rate. In other fields such attempts have been unsuccessful (e.g., <span class="citation">Johnson (<a href="references.html#ref-johnson_revised_2013" role="doc-biblioref">2013</a>)</span>). Improved conventions should be context dependent, and it seems sensible to establish them through consensus meetings <span class="citation">(<a href="references.html#ref-mullan_town_1985" role="doc-biblioref">Mullan &amp; Jacoby, 1985</a>)</span>. Consensus meetings are common in medical research, and have been used to decide upon a smallest effect size of interest (for an example, see <span class="citation">Fried et al. (<a href="references.html#ref-fried_method_1993" role="doc-biblioref">1993</a>)</span>). In many research areas current conventions can be improved. For example, it seems peculiar to have a default alpha level of 5% both for single studies and for meta-analyses, and one could imagine a future where the default alpha level in meta-analyses is much lower than 5%. Hopefully, making the lack of an adequate justification for certain input values in specific situations more transparent will motivate fields to start a discussion about how to improve current conventions. The online Shiny app links to good examples of justifications where possible, and will continue to be updated as better justifications are developed in the future.</p>
</div>
<div id="sample-size-justification-in-qualitative-research" class="section level2" number="8.27">
<h2>
<span class="header-section-number">8.27</span> Sample Size Justification in Qualitative Research<a class="anchor" aria-label="anchor" href="#sample-size-justification-in-qualitative-research"><i class="fas fa-link"></i></a>
</h2>
<p>A value of information perspective to sample size justification also applies to qualitative research. A sample size justification in qualitative research should be based on the consideration that the cost of collecting data from additional participants does not yield new information that is valuable enough given the inferential goals. One widely used application of this idea is known as <em>saturation</em> and is indicated by the observation that new data replicates earlier observations, without adding new information <span class="citation">(<a href="references.html#ref-morse_significance_1995" role="doc-biblioref">Morse, 1995</a>)</span>. For example, let's imagine we ask people why they have a pet. Interviews might reveal reasons that are grouped into categories, but after interviewing 20 people, no new categories emerge, at which point saturation has been reached. Alternative philosophies to qualitative research exist, and not all value planning for saturation. Regrettably, principled approaches to justify sample sizes have not been developed for these alternative philosophies <span class="citation">(<a href="references.html#ref-marshall_does_2013" role="doc-biblioref">Marshall et al., 2013</a>)</span>.</p>
<p>When sampling, the goal is often not to pick a representative sample, but a sample that contains a sufficiently diverse number of subjects such that saturation is reached efficiently. Fugard and Potts <span class="citation">(<a href="references.html#ref-fugard_supporting_2015" role="doc-biblioref">2015</a>)</span> show how to move towards a more informed justification for the sample size in qualitative research based on 1) the number of codes that exist in the population (e.g., the number of reasons people have pets), 2) the probability a code can be observed in a single information source (e.g., the probability that someone you interview will mention each possible reason for having a pet), and 3) the number of times you want to observe each code. They provide an R formula based on binomial probabilities to compute a required sample size to reach a desired probability of observing codes.</p>
<p>A more advanced approach is used in Rijnsoever <span class="citation">(<a href="references.html#ref-rijnsoever_i_2017" role="doc-biblioref">2017</a>)</span>, which also explores the importance of different sampling strategies. In general, purposefully sampling information from sources you expect will yield novel information is much more efficient than random sampling, but this also requires a good overview of the expected codes, and the sub-populations in which each code can be observed. Sometimes, it is possible to identify information sources that, when interviewed, would at least yield one new code (e.g., based on informal communication before an interview). A good sample size justification in qualitative research is based on 1) an identification of the populations, including any sub-populations, 2) an estimate of the number of codes in the (sub-)population, 3) the probability a code is encountered in an information source, and 4) the sampling strategy that is used.</p>
</div>
<div id="discussion" class="section level2" number="8.28">
<h2>
<span class="header-section-number">8.28</span> Discussion<a class="anchor" aria-label="anchor" href="#discussion"><i class="fas fa-link"></i></a>
</h2>
<p>Providing a coherent sample size justification is an essential step in designing an informative study. There are multiple approaches to justifying the sample size in a study, depending on the goal of the data collection, the resources that are available, and the statistical approach that is used to analyze the data. An overarching principle in all these approaches is that researchers consider the value of the information they collect in relation to their inferential goals.</p>
<p>The process of justifying a sample size when designing a study should sometimes lead to the conclusion that it is not worthwhile to collect the data, because the study does not have sufficient informational value to justify the costs. There will be cases where it is unlikely there will ever be enough data to perform a meta-analysis (for example because of a lack of general interest in the topic), the information will not be used to make a decision or claim, and the statistical tests do not allow you to test a hypothesis with reasonable error rates or to estimate an effect size with sufficient accuracy. If there is no good justification to collect the maximum number of observations that one can feasibly collect, performing the study anyway is a waste of time and/or money <span class="citation">(<a href="references.html#ref-brown_errors_1983" role="doc-biblioref">Brown, 1983</a>; <a href="references.html#ref-button_power_2013" role="doc-biblioref">Button et al., 2013</a>; <a href="references.html#ref-halpern_continuing_2002" role="doc-biblioref">S. D. Halpern et al., 2002</a>)</span>.</p>
<p>The awareness that sample sizes in past studies were often too small to meet any realistic inferential goals is growing among psychologists <span class="citation">(<a href="references.html#ref-button_power_2013" role="doc-biblioref">Button et al., 2013</a>; <a href="references.html#ref-fraley_n-pact_2014" role="doc-biblioref">Fraley &amp; Vazire, 2014</a>; <a href="references.html#ref-lindsay_replication_2015" role="doc-biblioref">Lindsay, 2015</a>; <a href="references.html#ref-sedlmeier_studies_1989" role="doc-biblioref">Sedlmeier &amp; Gigerenzer, 1989</a>)</span>. As an increasing number of journals start to require sample size justifications, some researchers will realize they need to collect larger samples than they were used to. This means researchers will need to request more money for participant payment in grant proposals, or that researchers will need to increasingly collaborate <span class="citation">(<a href="references.html#ref-moshontz_psychological_2018" role="doc-biblioref">Moshontz et al., 2018</a>)</span>. If you believe your research question is important enough to be answered, but you are not able to answer the question with your current resources, one approach to consider is to organize a research collaboration with peers, and pursue an answer to this question collectively.</p>
<p>A sample size justification should not be seen as a hurdle that researchers need to pass before they can submit a grant, ethical review board proposal, or manuscript for publication. When a sample size is simply stated, instead of carefully justified, it can be difficult to evaluate whether the value of the information a researcher aims to collect outweighs the costs of data collection. Being able to report a solid sample size justification means a researchers knows what they want to learn from a study, and makes it possible to design a study that can provide an informative answer to a scientific question.</p>
</div>
<div id="designing-efficient-studies" class="section level2" number="8.29">
<h2>
<span class="header-section-number">8.29</span> Designing efficient studies<a class="anchor" aria-label="anchor" href="#designing-efficient-studies"><i class="fas fa-link"></i></a>
</h2>
<p>So far, we have mainly focused on how to perform a power analysis based on assumptions about what the true effect size is. Although the true effect size is unknown, there is a true effect size in the population, and it has an impact on our statistical power. It is therefore useful to consider how we can design studies that will be optimally efficient to answer our research question. There are some ways in which we can increase the power of our test that are worth exploring.</p>
<div id="use-directional-tests-where-relevant." class="section level3" number="8.29.1">
<h3>
<span class="header-section-number">8.29.1</span> Use directional tests where relevant.<a class="anchor" aria-label="anchor" href="#use-directional-tests-where-relevant."><i class="fas fa-link"></i></a>
</h3>
<p>Researchers often make directional predictions, such as ‚Äòwe predict X is larger than Y‚Äô. The statistical test that logically follows from this prediction is a directional (or one-sided) <em>t</em>-test. A directional test moves the Type 1 error rate to one side of the tail, which lowers the critical value, and requires less observations to achieve the same statistical power. Although there is some discussion about when directional tests are appropriate, they are perfectly defensible from a Neyman-Pearson perspective on hypothesis testing. However, there might be situations where you do not want to ask a directional test. Sometimes it might be important for an effect opposite to your prediction to also reach statistical significance. For example, when you are evaluating a recently introduced educational intervention, and you predict the intervention will increase the performence of students, you might want to remain open to the possibility that students perform worse, to be able to recommend abandoning the new intervention. It is also possible to distribute the error rate in a 'lop-sided' manner, for example assigning a stricter error rate to effects in the negative than in the positive direction <span class="citation">(<a href="references.html#ref-rice_heads_1994" role="doc-biblioref">Rice &amp; Gaines, 1994</a>)</span>.</p>
</div>
<div id="use-sequential-analysis-whenever-possible" class="section level3" number="8.29.2">
<h3>
<span class="header-section-number">8.29.2</span> Use sequential analysis whenever possible<a class="anchor" aria-label="anchor" href="#use-sequential-analysis-whenever-possible"><i class="fas fa-link"></i></a>
</h3>
<p><a href="##sequential">Sequential analyses</a> greatly increase the efficiency of tests <span class="citation">(<a href="references.html#ref-lakens_performing_2014" role="doc-biblioref">Lakens, 2014</a>)</span>. For any of the ways in which you determined the sample size of your study that have been discussed here, a sequential design, where error rates are controlled as you repeatedly analyze the data that comes in, will on average decrease the sample size you will collect.</p>
</div>
<div id="increase-your-alpha-level" class="section level3" number="8.29.3">
<h3>
<span class="header-section-number">8.29.3</span> Increase your alpha level<a class="anchor" aria-label="anchor" href="#increase-your-alpha-level"><i class="fas fa-link"></i></a>
</h3>
<p>As explained in the section on <a href="#compromisepower">compromise power analysis</a> balancing error rates by increasing your alpha level also increases the statistical power (or reduces the Type 2 error rate). Obviously this comes at an increased probability of fooling yourself. The risk of doing so should be carefully weighed, which typically requires taking into account the prior probability that the null-hypothesis is true <span class="citation">(<a href="references.html#ref-miller_quest_2019" role="doc-biblioref">Miller &amp; Ulrich, 2019</a>)</span>. If you <em>have</em> to make a decision, and the data you can feasibly collect is limited, a compromise power analysis is justified, and so is increasing the alpha level.</p>
</div>
<div id="use-within-designs-where-possible" class="section level3" number="8.29.4">
<h3>
<span class="header-section-number">8.29.4</span> Use within designs where possible<a class="anchor" aria-label="anchor" href="#use-within-designs-where-possible"><i class="fas fa-link"></i></a>
</h3>
<p>One widely recommended approach to increase power is using a within subject design. Indeed, you need fewer observations to detect a mean difference between two conditions in a within-subjects design (in a dependent <em>t</em>-test) than in a between-subjects design (in an independent t-test). The reason is straightforward, but not always explained, and even less often expressed in the easy equation below. The sample size needed in within-designs (NW) relative to the sample needed in between-designs (NB), assuming normal distributions, is (from Maxwell &amp; Delaney, 2004, p. 561, formula 45):</p>
<p><span class="math display">\[NW = \frac{NB (1-\rho)}{2}\]</span></p>
<p>We divide by two due to the fact that in a two-condition within design every participant provides two data-points. The extent to which this reduces the sample size compared to a between-subject design depends on the correlation between the two dependent variables, as indicated by the (1-<span class="math inline">\(\rho\)</span>) part of the equation. If the correlation is 0, a within-subject design simply needs half as many observations as a between-subject design (e.g., 64 instead 128 observations). The higher the correlation, the larger the relative benefit of within designs, and whenever the correlation is negative (up to -1) the relative benefit disappears. Note than when the correlation is -1, you need 128 observations in a within-design and 128 observations in a between-design, but in a within-design you will need to collect two measurements from each participant, making a within design more work than a between-design. However, negative correlations between dependent variables in psychology are rare, and perfectly negative correlations will probably never occur.</p>
<p>So what does the correlation do so that it increases the power of within designs, or reduces the number of observations you need? Let‚Äôs see what effect the correlation has on power by simulating and plotting correlated data. In the R script below, I‚Äôm simulating two measurements of IQ scores with a specific sample size (i.e., 10000), mean (i.e., 100 vs 106), standard deviation (i.e., 15), and correlation between the two measurements. The script generates three plots.</p>
<p>We will start with a simulation where the correlation between measurements is 0. First, we see the two normally distributed IQ measurements on the left, with means of 100 and 106, and standard deviations of 15 (due to the large sample size, the numbers equal the input in the simulation, although small variation might still occur). In the scatter plot on the right, we can see that the correlation between the measurements is indeed 0. Let's look at the distribution of the mean differences. The mean difference is -6 (in line with the simulation settings), and the standard deviation is 21. This is also as expected. The standard deviation of the difference scores is <span class="math inline">\(\sqrt{2}\)</span> times as large as the standard deviation in each measurement, and indeed, 15√ó<span class="math inline">\(\sqrt{2}\)</span> = 21.21, which is rounded to 21. This situation where the correlation between measurements is zero equals the situation in an independent <em>t</em>-test, where the correlation between measurements is not taken into account.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-1"></span>
<img src="08-samplesizejustification_files/figure-html/plot-1-1.png" alt="Distributions of two dependent groups with means 100 and 106 and a standard deviation of 15, distribution of the differences, and correlation of 0." width="100%"><p class="caption">
Figure 8.12: Distributions of two dependent groups with means 100 and 106 and a standard deviation of 15, distribution of the differences, and correlation of 0.
</p>
</div>
<p>Now let‚Äôs increase the correlation between dependent variables to 0.7. Nothing has changed when we plot the means. The correlation between measurements is now strongly positive, as we see in the plot on the right. The important difference lies in the standard deviation of the difference scores. The SD of the difference scores is 11 instead of 21 in the uncorrelated example. Because the standardized effect size is the difference divided by the standard deviation, the effect size (Cohen‚Äôs dz in within designs) is larger in this test than in the test above.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-4"></span>
<img src="08-samplesizejustification_files/figure-html/plot-4-1.png" alt="Distributions of two independent groups with means 100 and 106 and a standard deviation of 15, distribution of the differences, and correlation of 0.7." width="100%"><p class="caption">
Figure 8.13: Distributions of two independent groups with means 100 and 106 and a standard deviation of 15, distribution of the differences, and correlation of 0.7.
</p>
</div>
<p>If you set the correlation to a negative value, the standard deviation of the difference scores would increase. I like to think of dependent variables in within-designs as dance partners. If they are well-coordinated (or highly correlated), one person steps to the left, and the other person steps to the left the same distance. If there is no coordination (or no correlation), when one dance partner steps to the left, the other dance partner is just as likely to move to the wrong direction as to the right direction. Such a dance couple will take up a lot more space on the dance floor.</p>
<p>You see that the correlation between dependent variables is an important aspect of within designs. I recommend explicitly reporting the correlation between dependent variables in within designs (e.g., participants responded significantly slower (<em>M</em> = 390, <em>SD</em> = 44) when they used their feet than when they used their hands (<em>M</em> = 371, <em>SD</em> = 44, <em>r</em> = .953), <em>t</em>(17) = 5.98, <em>p</em> &lt; 0.001, Hedges' g = 0.43, M_diff = 19, 95% CI [12; 26]).</p>
<p>Since most dependent variables in within designs in psychology are positively correlated, within designs will greatly increase the power you can achieve given the sample size you have available. Use within-designs when possible, but weigh the benefits of higher power against the downsides of order effects or carryover effects that might be problematic in a within-subject design <span class="citation">(<a href="references.html#ref-maxwell_designing_2017" role="doc-biblioref">Maxwell et al., 2017</a>)</span>.</p>
<p>You can use this <a href="http://shiny.ieis.tue.nl/within_between/">Shiny app</a> to play around with different means, sd's, and correlations, and see the effect of the distribution of the difference scores.</p>
<!-- ```{r shiny2, echo=F} -->
<!-- knitr::include_app('http://shiny.ieis.tue.nl/within_between/', height = '4000px') -->
<!-- ``` -->
</div>
<div id="remove-statistical-variation-where-possible" class="section level3" number="8.29.5">
<h3>
<span class="header-section-number">8.29.5</span> Remove statistical variation where possible<a class="anchor" aria-label="anchor" href="#remove-statistical-variation-where-possible"><i class="fas fa-link"></i></a>
</h3>
<p>The smaller the variation, the larger the standardized effect size (because we are dividing the raw effect by a smaller denominator) and thus the higher the power given the same number of observations. For an overview of different approaches to reduce the variance, see <span class="citation">Allison et al. (<a href="references.html#ref-allison_power_1997" role="doc-biblioref">1997</a>)</span>. They discuss:</p>
<ol style="list-style-type: decimal">
<li>Better ways to screen participants for studies where participants need to be screened before participation.</li>
<li>Assigning participants unequally to conditions (if the control condition is much cheaper than the experimental condition, for example).</li>
<li>Using multiple measurements to increase measurement reliability (or use well-validated measures, if I may add).</li>
<li>Smart use of (preregistered, I‚Äôd recommend) covariates.</li>
</ol>
<p>Another approach they do not mention is to, where possible, collect multiple observations from the same participant. This can also increase power, especially if there is variation at the individual level, and you analyze data with hierarchical models.</p>
</div>
<div id="use-bayesian-statistics-with-informed-priors" class="section level3" number="8.29.6">
<h3>
<span class="header-section-number">8.29.6</span> Use Bayesian statistics with informed priors<a class="anchor" aria-label="anchor" href="#use-bayesian-statistics-with-informed-priors"><i class="fas fa-link"></i></a>
</h3>
<p>Regrettably, almost all approaches to statistical inferences become very limited when the number of observations is small. If you are very confident in your predictions (and your peers agree), incorporating prior information will give you a benefit. For a discussion of the benefits and risks of such an approach, see <span class="citation">van de Schoot et al. (<a href="references.html#ref-van_de_schoot_analyzing_2015" role="doc-biblioref">2015</a>)</span>.</p>
</div>
</div>
<div id="what-if-best-practices-are-not-enough" class="section level2" number="8.30">
<h2>
<span class="header-section-number">8.30</span> What if best practices are not enough?<a class="anchor" aria-label="anchor" href="#what-if-best-practices-are-not-enough"><i class="fas fa-link"></i></a>
</h2>
<p>In the end, getting an informative answer requires designing an informative experiment, and sometimes no matter how efficient you design your experiment, you will need to collect more data. Sometimes. there are no secret tricks or magical solutions. So what should we do then? The solutions below are, regrettably, a lot more work than making a small change to the design of your study. But it is about time we start to take them seriously.</p>
<div id="ask-for-more-money-in-your-grant-proposals" class="section level3" number="8.30.1">
<h3>
<span class="header-section-number">8.30.1</span> Ask for more money in your grant proposals<a class="anchor" aria-label="anchor" href="#ask-for-more-money-in-your-grant-proposals"><i class="fas fa-link"></i></a>
</h3>
<p>Some grant organizations distribute funds to be awarded as a function of how much money is requested. If you need more money to collect informative data, ask for it. Obviously grants are incredibly difficult to get, but if you ask for money, include a budget that acknowledges that data collection is not as cheap as you hoped some years ago. In my experience, psychologists are often asking for much less money to collect data than other scientists. Increasing the requested funds for participant payment by a factor of 10 is often reasonable, given the requirements of journals to provide a solid sample size justification, and the more realistic effect size estimates that are emerging from preregistered studies.</p>
</div>
<div id="improve-management" class="section level3" number="8.30.2">
<h3>
<span class="header-section-number">8.30.2</span> Improve management<a class="anchor" aria-label="anchor" href="#improve-management"><i class="fas fa-link"></i></a>
</h3>
<p>If the implicit or explicit goals that you should meet are still the same now as they were 10 years ago, and you did not receive a miraculous increase in money and time to do research, then an update of the evaluation criteria is long overdue. I sincerely hope your manager is capable of this, but some ‚Äòupward management‚Äô might be needed. In the coda of Lakens &amp; Evers (2014) we wrote:</p>
<blockquote>
<p>All else being equal, a researcher running properly powered studies will clearly contribute more to cumulative science than a researcher running underpowered studies, and if researchers take their science seriously, it should be the former who is rewarded in tenure systems and reward procedures, not the latter.</p>
</blockquote>
</div>
<div id="change-what-is-expected-from-phd-students" class="section level3" number="8.30.3">
<h3>
<span class="header-section-number">8.30.3</span> Change what is expected from PhD students<a class="anchor" aria-label="anchor" href="#change-what-is-expected-from-phd-students"><i class="fas fa-link"></i></a>
</h3>
<p>When I did my PhD, there was the assumption that you performed enough research in the 4 years you are employed as a full-time researcher to write a thesis with 3 to 5 empirical chapters (with some chapters having multiple studies). These studies were ideally published, but at least publishable. If we consider it important for PhD students to produce multiple publishable scientific articles during their PhD‚Äôs, this will greatly limit the types of research they can do. Instead of evaluating PhD students based on their publications, we can see the PhD as a time where researchers learn skills to become an independent researcher, and evaluate them not based on publishable units, but in terms of clearly identifiable skills. I personally doubt data collection is particularly educational after the 20th participant, and I would probably prefer to hire a post-doc who had well-developed skills in programming, statistics, and who broadly read the literature, then someone who used that time to collect participant 21 to 200. If we make it easier for PhD students to demonstrate their skills level we can evaluate what they have learned in a more sensible manner than by counting the number of publications they wrote. Currently, difference in the resources PhD students have at their disposal are a huge confound as we try to judge their skill based on their resume. Researchers at rich universities obviously have more resources ‚Äì it should not be difficult to develop tools that allow us to judge the skills of people where resources are much less of a confound.</p>
</div>
<div id="get-answers-collectively" class="section level3" number="8.30.4">
<h3>
<span class="header-section-number">8.30.4</span> Get answers collectively<a class="anchor" aria-label="anchor" href="#get-answers-collectively"><i class="fas fa-link"></i></a>
</h3>
<p>Our society has some serious issues that psychologists can help address. These questions are incredibly complex. I have long lost faith in the idea that a bottom-up organized scientific discipline that rewards individual scientists will manage to generate reliable and useful knowledge that can help to solve these societal issues. For some of these questions we need well-coordinated research lines where hundreds of scholars work together, pool their resources and skills, and collectively pursuit answers to these important questions. And if we are going to limit ourselves in our research to the questions we can answer in our own small labs, these big societal challenges are not going to be solved. Call me a pessimist.</p>
<p>There is a reason we resort to forming unions and organizations that have to goal to collectively coordinate what we do. If you greatly dislike team science, don‚Äôt worry ‚Äì there will always be options to make scientific contributions by yourself. But now, there are almost no ways for scientists who want to pursue huge challenges in large well-organized collectives of hundreds or thousands of scholars (for a recent exception that proves my rule by remaining unfunded: see the <a href="https://psysciacc.org/">Psychological Science Accelerator</a>). If you honestly believe your research question is important enough to be answered, then get together with everyone who also thinks so, and pursue answers collectively.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="confint.html"><span class="header-section-number">7</span> Confidence Intervals</a></div>
<div class="next"><a href="references.html"><span class="header-section-number">9</span> References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#power"><span class="header-section-number">8</span> Sample size justification</a></li>
<li><a class="nav-link" href="#six-approaches-to-justify-sample-sizes"><span class="header-section-number">8.1</span> Six Approaches to Justify Sample Sizes</a></li>
<li><a class="nav-link" href="#six-ways-to-evaluate-which-effect-sizes-are-interesting"><span class="header-section-number">8.2</span> Six Ways to Evaluate Which Effect Sizes are Interesting</a></li>
<li><a class="nav-link" href="#the-value-of-information"><span class="header-section-number">8.3</span> The Value of Information</a></li>
<li><a class="nav-link" href="#measuring-almost-the-entire-population"><span class="header-section-number">8.4</span> Measuring (Almost) the Entire Population</a></li>
<li><a class="nav-link" href="#resource-constraints"><span class="header-section-number">8.5</span> Resource Constraints</a></li>
<li><a class="nav-link" href="#a-priori-power-analysis"><span class="header-section-number">8.6</span> A-priori Power Analysis</a></li>
<li><a class="nav-link" href="#planning-for-precision"><span class="header-section-number">8.7</span> Planning for Precision</a></li>
<li><a class="nav-link" href="#heuristics"><span class="header-section-number">8.8</span> Heuristics</a></li>
<li><a class="nav-link" href="#no-justification"><span class="header-section-number">8.9</span> No Justification</a></li>
<li><a class="nav-link" href="#what-is-your-inferential-goal"><span class="header-section-number">8.10</span> What is Your Inferential Goal?</a></li>
<li><a class="nav-link" href="#what-is-the-smallest-effect-size-of-interest"><span class="header-section-number">8.11</span> What is the Smallest Effect Size of Interest?</a></li>
<li><a class="nav-link" href="#the-minimal-statistically-detectable-effect"><span class="header-section-number">8.12</span> The Minimal Statistically Detectable Effect</a></li>
<li><a class="nav-link" href="#what-is-the-expected-effect-size"><span class="header-section-number">8.13</span> What is the Expected Effect Size?</a></li>
<li><a class="nav-link" href="#using-an-estimate-from-a-meta-analysis"><span class="header-section-number">8.14</span> Using an Estimate from a Meta-Analysis</a></li>
<li><a class="nav-link" href="#using-an-estimate-from-a-previous-study"><span class="header-section-number">8.15</span> Using an Estimate from a Previous Study</a></li>
<li><a class="nav-link" href="#using-an-estimate-from-a-theoretical-model"><span class="header-section-number">8.16</span> Using an Estimate from a Theoretical Model</a></li>
<li><a class="nav-link" href="#compute-the-width-of-the-confidence-interval-around-the-effect-size"><span class="header-section-number">8.17</span> Compute the Width of the Confidence Interval around the Effect Size</a></li>
<li><a class="nav-link" href="#plot-a-sensitivity-power-analysis"><span class="header-section-number">8.18</span> Plot a Sensitivity Power Analysis</a></li>
<li><a class="nav-link" href="#the-distribution-of-effect-sizes-in-a-research-area"><span class="header-section-number">8.19</span> The Distribution of Effect Sizes in a Research Area</a></li>
<li><a class="nav-link" href="#additional-considerations-when-designing-an-informative-study"><span class="header-section-number">8.20</span> Additional Considerations When Designing an Informative Study</a></li>
<li><a class="nav-link" href="#compromise-power-analysis"><span class="header-section-number">8.21</span> Compromise Power Analysis</a></li>
<li><a class="nav-link" href="#what-to-do-if-your-editor-asks-for-post-hoc-power"><span class="header-section-number">8.22</span> What to do if Your Editor Asks for Post-hoc Power?</a></li>
<li><a class="nav-link" href="#sequential-analyses"><span class="header-section-number">8.23</span> Sequential Analyses</a></li>
<li><a class="nav-link" href="#increasing-power-without-increasing-the-sample-size"><span class="header-section-number">8.24</span> Increasing Power Without Increasing the Sample Size</a></li>
<li><a class="nav-link" href="#know-your-measure"><span class="header-section-number">8.25</span> Know Your Measure</a></li>
<li><a class="nav-link" href="#conventions-as-meta-heuristics"><span class="header-section-number">8.26</span> Conventions as meta-heuristics</a></li>
<li><a class="nav-link" href="#sample-size-justification-in-qualitative-research"><span class="header-section-number">8.27</span> Sample Size Justification in Qualitative Research</a></li>
<li><a class="nav-link" href="#discussion"><span class="header-section-number">8.28</span> Discussion</a></li>
<li>
<a class="nav-link" href="#designing-efficient-studies"><span class="header-section-number">8.29</span> Designing efficient studies</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#use-directional-tests-where-relevant."><span class="header-section-number">8.29.1</span> Use directional tests where relevant.</a></li>
<li><a class="nav-link" href="#use-sequential-analysis-whenever-possible"><span class="header-section-number">8.29.2</span> Use sequential analysis whenever possible</a></li>
<li><a class="nav-link" href="#increase-your-alpha-level"><span class="header-section-number">8.29.3</span> Increase your alpha level</a></li>
<li><a class="nav-link" href="#use-within-designs-where-possible"><span class="header-section-number">8.29.4</span> Use within designs where possible</a></li>
<li><a class="nav-link" href="#remove-statistical-variation-where-possible"><span class="header-section-number">8.29.5</span> Remove statistical variation where possible</a></li>
<li><a class="nav-link" href="#use-bayesian-statistics-with-informed-priors"><span class="header-section-number">8.29.6</span> Use Bayesian statistics with informed priors</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#what-if-best-practices-are-not-enough"><span class="header-section-number">8.30</span> What if best practices are not enough?</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ask-for-more-money-in-your-grant-proposals"><span class="header-section-number">8.30.1</span> Ask for more money in your grant proposals</a></li>
<li><a class="nav-link" href="#improve-management"><span class="header-section-number">8.30.2</span> Improve management</a></li>
<li><a class="nav-link" href="#change-what-is-expected-from-phd-students"><span class="header-section-number">8.30.3</span> Change what is expected from PhD students</a></li>
<li><a class="nav-link" href="#get-answers-collectively"><span class="header-section-number">8.30.4</span> Get answers collectively</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/Lakens/statistical_inferences/blob/master/08-samplesizejustification.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/Lakens/statistical_inferences/edit/master/08-samplesizejustification.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Improving Your Statistical Inferences</strong>" was written by Daniel Lakens. It was last built on 2022-02-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
