<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.310">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="This open educational resource contains information to improve statistical inferences, design better experiments, and report scientific research more transparently.">
<title>Improving Your Statistical Inferences - 3&nbsp; Likelihoods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-bayes.html" rel="next">
<link href="./02-errorcontrol.html" rel="prev">
<link href="./images/logos/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-0MK2WTGRM3"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0MK2WTGRM3', { 'anonymize_ip': true});
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="include/webex.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-likelihoods.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Likelihoods</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Improving Your Statistical Inferences</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Lakens/statistical_inferences" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Improving-Your-Statistical-Inferences.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Improving-Your-Statistical-Inferences.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
    <a href="https://twitter.com/intent/tweet?url=%7Curl%7C" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-pvalue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Using <em>p</em>-values to test a hypothesis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-errorcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Error control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-likelihoods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Likelihoods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Asking Statistical Questions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-effectsize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Effect Sizes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-CI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-samplesizejustification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sample Size Justification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-equivalencetest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Equivalence Testing and Interval Hypotheses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-sequential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sequential Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Meta-analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bias detection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-prereg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Preregistration and Transparency</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-computationalreproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Computational Reproducibility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-researchintegrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Research Integrity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#likelihood-ratios" id="toc-likelihood-ratios" class="nav-link active" data-scroll-target="#likelihood-ratios"><span class="header-section-number">3.1</span> Likelihood ratios</a></li>
  <li><a href="#sec-mixedresults" id="toc-sec-mixedresults" class="nav-link" data-scroll-target="#sec-mixedresults"><span class="header-section-number">3.2</span> Likelihood of mixed results in sets of studies</a></li>
  <li><a href="#sec-likettest" id="toc-sec-likettest" class="nav-link" data-scroll-target="#sec-likettest"><span class="header-section-number">3.3</span> Likelihoods for <em>t</em>-tests</a></li>
  <li>
<a href="#test-yourself" id="toc-test-yourself" class="nav-link" data-scroll-target="#test-yourself"><span class="header-section-number">3.4</span> Test Yourself</a>
  <ul class="collapse">
<li><a href="#questions-about-likelihoods" id="toc-questions-about-likelihoods" class="nav-link" data-scroll-target="#questions-about-likelihoods"><span class="header-section-number">3.4.1</span> Questions about likelihoods</a></li>
  <li><a href="#questions-about-mixed-results" id="toc-questions-about-mixed-results" class="nav-link" data-scroll-target="#questions-about-mixed-results"><span class="header-section-number">3.4.2</span> Questions about mixed results</a></li>
  <li><a href="#open-questions" id="toc-open-questions" class="nav-link" data-scroll-target="#open-questions"><span class="header-section-number">3.4.3</span> Open Questions</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Lakens/statistical_inferences/edit/master/03-likelihoods.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/Lakens/statistical_inferences/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/Lakens/statistical_inferences/blob/master/03-likelihoods.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-likelihoods" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Likelihoods</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In addition to frequentist and Bayesian approaches to statistical inferences, likelihoods provide a third approach to statistical inferences <span class="citation" data-cites="pawitan_all_2001 dienes_understanding_2008">(<a href="references.html#ref-dienes_understanding_2008" role="doc-biblioref">Dienes, 2008</a>; <a href="references.html#ref-pawitan_all_2001" role="doc-biblioref">Pawitan, 2001</a>)</span>. Like <a href="04-bayes.html">Bayesian approaches</a>, which will be discussed in the next chapter, likelihoodists are interested in quantifying a measure of relative evidence when comparing two models or hypotheses. Unlike Bayesians, likelihoodists are not too enthusiastic about the idea of incorporating prior information into their statistical inferences. As the likelihoodists Taper and Lele <span class="citation" data-cites="taper_philosophy_2011">(<a href="references.html#ref-taper_philosophy_2011" role="doc-biblioref">2011</a>)</span> write:</p>
<blockquote class="blockquote">
<p>It is not that we believe that Bayes’ rule or Bayesian mathematics is flawed, but that from the axiomatic foundational definition of probability Bayesianism is doomed to answer questions irrelevant to science. We do not care what you believe, we barely care what we believe, what we are interested in is what you can show.</p>
</blockquote>
<p>Likelihoodists are interested in a measure of relative evidence,. Unlike the Fisherian frequentist approach, where only <span class="math inline">\(H_0\)</span> is specified, and lower <em>p</em>-values that are less compatible with the null model are interpreted as evidence against the null, likelihoodists specify a null and an alternative model, and quantify the relative likelihood of the data under both models. The Neyman-Pearson approach, in which <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> are specified, aims at decisions about how to act, and does not aim to quantify evidence. At the same time, likelihood functions are an important part of both frequentist and Bayesian approaches. In the Neyman-Pearson approach, likelihoods play an important role through the Neyman-Pearson lemma, which shows that the likelihood ratio test is the most powerful test of <span class="math inline">\(H_0\)</span> against <span class="math inline">\(H_1\)</span>, and is useful in determining the critical value that is used to reject a hypothesis. In Bayesian approaches, the likelihood is combined with a prior to compute a posterior probability distribution.</p>
<p>We can use likelihood functions to make inferences about unknown quantities. Let’s imagine you flip a coin 10 times, and it turns up heads 8 times. What is the true probability (which is sometimes indicated by the Greek letter <span class="math inline">\(\theta\)</span> (theta), but we will use <em>p</em> in this chapter) of this coin landing on heads?</p>
<p>The <strong>binomial probability</strong> of observing <em>k</em> successes in <em>n</em> studies is:</p>
<p><span class="math display">\[
Pr\left( k;n, p \right) = \frac{n!}{k!\left( n - k \right)!}p^{k}{(1 - p)}^{n - k}
\]</span></p>
<p>where <em>p</em> is the probability of a success, <em>k</em> is the observed number of successes, and <em>n</em> is the number of trials. The first term indicates the number of possible combinations of results (e.g., you could start out with eight successes, end with eight successes, or any of the other possible combinations), which is multiplied by the probability of observing one success in each of the trials, which is then multiplied by the probability of observing no success in the remaining trials.</p>
<p>Let’s assume you expect this is a fair coin. What is the binomial probability of observing 8 heads out of 10 coin flips, when <em>p</em> = 0.5? The answer is:</p>
<p><span class="math display">\[
Pr\left(8;10, 0.5 \right) = \frac{10!}{8!\left( 10 - 8 \right)!}*0.5^{8}*{(1 - 0.5)}^{10 - 8}
\]</span> In R this probability is computed as as:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">factorial</span>(<span class="dv">10</span>)<span class="sc">/</span>(<span class="fu">factorial</span>(<span class="dv">8</span>)<span class="sc">*</span>(<span class="fu">factorial</span>(<span class="dv">10-8</span>))) <span class="sc">*</span> <span class="fl">0.5</span><span class="sc">^</span><span class="dv">8</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">^</span>(<span class="dv">10-8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or by using the function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s assume we don’t have any other information about this coin. (You might believe most coins are fair; such priors will be discussed when we talk about <a href="04-bayes.html">Bayesian statistics</a> in the next chapter). The equation <em>Pr(k;n,p)</em> gives the probability of observing <em>k</em> successes from <em>n</em> trials when a coin’s probability of success is <em>p</em>.</p>
<p>When computing a probability, we assume the model to be known, and compute the probability of observing a specific outcome. But based on the data we have observed, we can ask the reversed question: which value of <em>p</em> will make the observed data <strong>most likely</strong>? When computing a likelihood, we assume the data to be known, and make an inference about the most likely parameter for the model. To answer this question, we can plug in the values for <em>k</em> and <em>n</em> and find which value of <em>p</em> maximizes this function. <a href="https://en.wikipedia.org/wiki/Ronald_Fisher">Ronald Fisher</a> called this maximum likelihood estimation (this is considered one of the most important developments in 20th century statistics, and Fisher published his first paper on this in 1912 as a third year undergraduate when he was 22 <span class="citation" data-cites="aldrich_r_1997">(<a href="references.html#ref-aldrich_r_1997" role="doc-biblioref">Aldrich, 1997</a>)</span>). Since <em>p</em> can be any value between 0 and 1, we can plot all values in what is known as the <em>likelihood function</em>, so we can see the maximum more easily.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like1-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: Binomial likelihood function for 8 successes in 10 trials.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The likelihood is plotted for all possible values of <em>p</em> (from 0 to 1). It should not be surprising that given the data we have observed, the most likely value for the true parameter is 8 out of 10, or <em>p</em> = 0.8, with a likelihood of 0.30 (the highest point on the y-axis). In this example, <em>p</em> = 0.8 is called the <strong>maximum likelihood estimator</strong>. It is important to know that the likelihood itself has no meaning in isolation. In this sense, it differs from a probability. But we can compare likelihoods of the same function across different values of <em>p</em>. You can read off any other value for any other p, and see that given the observed data, low values of <em>p</em> (e.g., 0.2) are not very likely.</p>
<p>There is a subtle difference between a probability and a likelihood. In colloquial language, you can use both terms to mean the same thing, but in statistics both terms used for different sides of the same coin. Note how the equation for Pr involves both information about the data (<em>k</em>, <em>n</em>) and information about the parameter (<em>p</em>). To compute a <strong>probability</strong>, we view <em>p</em> as fixed (for instance, for a fair coin, we plug in <em>p</em> = 0.5) and then estimate the probability of different outcomes (<em>k</em>, <em>n</em>). The resulting function is the probability mass function. To compute the <strong>likelihood</strong>, we instead view the observed data as fixed (e.g., observing 5 heads out of 10 coin tosses), and we view Pr as a function of <em>p</em>, estimating the value that maximizes the likelihood of a particular sample.</p>
<p>Likelihoods are an example of statistical inference: We have observed some data, and we use this data to draw an inference about different population parameters. More formally, the likelihood function is the (joint) density function evaluated at the observed data. Likelihood functions can be calculated for many different models (binomial distributions, normal distributions, see <span class="citation" data-cites="millar_maximum_2011">Millar (<a href="references.html#ref-millar_maximum_2011" role="doc-biblioref">2011</a>)</span>). This approach is called <strong>likelihoodist statistics</strong>, or <strong>likelihoodism</strong>, and it is distinct from frequentist and Bayesian approaches to statistics, as it directly uses the likelihood function to make inferences.</p>
<p>When a mix of heads and tails has been observed, the likelihood curve rises and falls, as it is not possible that the coin can only come up heads or tails (after all, both have already been observed). If only heads or 0 heads are observed, the likelihood curve peaks at the far left or right of the x-axis. When we plot the likelihood curves for 0 heads in 10 coin flips, the likelihood curve looks like <a href="#fig-like2">Figure&nbsp;<span>3.2</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.2: Binomial likelihood function for 0 successes in 10 trials.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Likelihoods can easily be combined. Imagine we have two people flipping the same coin independently. One person observes 8 heads out of 10 flips, and the other observes 4 heads out of 10 flips. You might believe that this should give the same likelihood curve as one person flipping a coin 20 times, and observing 12 heads, and indeed, it does. In the plot below, all likelihood curves are standardized by dividing the curve by the maximum of each likelihood curve. This is why all curves now have a maximum of 1, and we can more easily compare different likelihood curves.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: Combining likelihoods.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The curve on left is for 4 out of 10 heads, the one on the right is for 8 out of 10 heads. The black dotted curve in the middle is for 12 out of 20 heads. The grey curve, directly beneath the 12 out of 20 heads curve, is calculated by multiplying the likelihood curves: <span class="math inline">\(L(p_{combined}) = L(p = 0.8) / L(p = 0.4)\)</span>.</p>
<p>In <a href="#fig-like4">Figure&nbsp;<span>3.4</span></a> we see likelihood curves for 10, 100, and 1000 coin flips, which yield 5, 50, and 500 heads, respectively. The likelihood curves are again standardized to make them more easily comparable. As the sample size increases, the curves become more narrow (the dashed line is for <em>n</em> = 10, the dotted line is for <em>n</em> = 100, and the solid line is for <em>n</em> = 1000). This means that as the sample size increases, our data become increasingly less likely under population parameters further removed from the observed number of heads. In other words, we have collected increasingly strong evidence for <em>p</em> = 0.5, compared to most other possible population parameters.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.4: Likelihood function for 5/10, 50/100 and 500/1000 heads in coin flips.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="likelihood-ratios" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="likelihood-ratios">
<span class="header-section-number">3.1</span> Likelihood ratios</h2>
<p>We can use the likelihood function to compare possible values of p.&nbsp;For example, we might believe the coin we flipped was fair, even though we flipped eight out of ten heads. A fair coin will have <em>p</em> = 0.5, while we observed <em>p</em> = 0.8. The likelihood function allows us to compute the relative likelihood for different possible parameters. How much more likely is our observed data under the hypothesis that this is an unfair coin that will on average turn up heads 80% of the time, compared to the alternative theory that this is a fair coin which should turn up heads 50% of the time?</p>
<p>We can calculate the likelihood ratio:</p>
<p><span class="math display">\[
\frac{L(p = 0.8)}{L(p = 0.5)}
\]</span></p>
<p>Which is 0.302/0.044 = 6.87. In the plot, both circles show the points on the likelihood curve for L(<em>p</em> = 0.5) and L(<em>p</em> = 0.8).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.5: Computing a likelihood ratio for <em>p</em> = 0.5 relative to <em>p</em> = 0.8 when observing <em>p</em> = 0.8.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can subjectively interpret this likelihood ratio, which tells us that our observed data is 6.87 times more likely under the hypothesis that this coin is unfair and will turn up heads 80% of the time, than under the hypothesis that this is a fair coin. How convincing is this? Let’s round the likelihood ratio to 7, and imagine two bags of marbles. One bag contains 7 blue marbles. The second contains 7 marbles, each one a different color of the rainbow, so violet, indigo, blue, green, yellow, orange, and red. Someone randomly picks one of the two bags, draws a marble, and shows it to you. The marble is blue: How certain are you this marble came from the bag with all blue marbles, compared to the bag with rainbow coloured marbles? This is how strongly the likelihood ratio tells us to believe our data were generated by an unfair coin that turns up heads 80% of the time, relative to a fair coin, given that we have observed 8 heads in 10 tosses. After this explanation, intended to not make you rely too much on benchmarks, it might still be useful to know that <span class="citation" data-cites="royall_statistical_1997">Royall (<a href="references.html#ref-royall_statistical_1997" role="doc-biblioref">1997</a>)</span> considered likelihood ratios of 8 as moderately strong evidence, and likelihood ratios of 32 as strong evidence.</p>
<p>Note that likelihood ratios give us the relative evidence for one specified hypothesis, over another specified hypothesis. The likelihood ratio can be calculated for any two hypothesized values. For example, in <a href="#fig-like6">Figure&nbsp;<span>3.6</span></a> below, the likelihood ratio is calculated that compares the hypothesis for a fair coin (<em>p</em> = 0.5) with the alternative hypothesis that the coin comes up heads 80% of the time (<em>p</em> = 0.8), when we have observed 4 heads out of 10 coin flips. We see that the observed data are 0.2050/0.0055=37.25 times more likely (ignoring rounding differences – and try to calculate these numbers by hand using the formula provided earlier) under the hypothesis that this is a fair coin than under the hypothesis that this is a coin that turns up heads 80% of the time.</p>
<p>(ref:like6lab) Computing a likelihood ratio for <em>p</em> = 0.5 relative to <em>p</em> = 0.8 when observing <em>p</em> = 0.4.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.6: Computing a likelihood ratio for <em>p</em> = 0.5 relative to <em>p</em> = 0.8 when observing <em>p</em> = 0.8.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>A likelihood ratio of 1 means the data are equally likely under both hypotheses. Values further away from 1 indicate that the data are more likely under one hypothesis than the other. The ratio can be expressed in favor of one hypothesis over the other (for example L(<em>p</em> = 0.5)/L(<em>p</em> = 0.8) or vice versa (L(<em>p</em> = 0.8)/L(<em>p</em> = 0.5). This means the likelihood ratio of 37.25 for <span class="math inline">\(H_0\)</span> relative to <span class="math inline">\(H_1\)</span> is equivalent to a likelihood ratio of 1/37.25 = 0.02685 for <span class="math inline">\(H_1\)</span> relative to <span class="math inline">\(H_0\)</span>. Likelihood ratios range from 0 to infinity, and the closer to zero or infinity, the stronger the relative evidence for one hypothesis over the other. We will see in the chapter on <a href="04-bayes.html">Bayesian statistics</a> that likelihood ratios are in this sense very similar (and a special case of) a Bayes Factor.</p>
<p>Likelihoods are relative evidence. Just because the data are more likely under one possible value of <em>p</em> than another value of <em>p</em> doesn’t mean that the data have come from either of these two distributions. Other values might generate even higher likelihood values. For example, consider the situation where we flip a coin 100 times, and observe 50 heads. We compare <em>p</em> = 0.3 versus <em>p</em> = 0.8, and find that the likelihood ratio is 803462, implying that there is 803461 times more evidence in the data for <em>p</em> = 0.3 than for <em>p</em> = 0.8. That might sound pretty conclusive evidence for <em>p</em> = 0.3. But it is only relative evidence for <em>p</em> = 0.3 compared to <em>p</em> = 0.8. If we look at the likelihood function, we clearly see that, not surprisingly, <em>p</em> = 0.5 is the value that maximizes the likelihood function. Just because one hypothesis is more likely than another hypothesis, does not mean that there isn’t a third hypothesis that is even more likely.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.7: Computing a likelihood ratio for <em>p</em> = 0.3 relative to <em>p</em> = 0.8 when observing <em>p</em> = 0.5 in 100 coin flips.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-mixedresults" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="sec-mixedresults">
<span class="header-section-number">3.2</span> Likelihood of mixed results in sets of studies</h2>
<p>Science is a cumulative process, and we should evaluate lines of research, not single studies. One big problem in the scientific literature is that nonsignificant results are often never published <span class="citation" data-cites="franco_publication_2014 fanelli_positive_2010">(<a href="references.html#ref-fanelli_positive_2010" role="doc-biblioref">Fanelli, 2010</a>; <a href="references.html#ref-franco_publication_2014" role="doc-biblioref">Franco et al., 2014</a>)</span>. At the same time, because the statistical power of hypothesis tests are never 100% (and often much lower), it is a mathematical reality that it is unlikely (or “too good to be true”) that a set of multiple studies yields exclusively significant results. <span class="citation" data-cites="schimmack_ironic_2012 francis_frequency_2014">(<a href="references.html#ref-francis_frequency_2014" role="doc-biblioref">Francis, 2014</a>; <a href="references.html#ref-schimmack_ironic_2012" role="doc-biblioref">Schimmack, 2012</a>)</span>. We can use binomial likelihoods to examine how likely it is to observe mixed results, and understand when mixed results are nevertheless strong evidence for the presence of an effect. The following is largely based on <span class="citation" data-cites="lakens_too_2017">Lakens &amp; Etz (<a href="references.html#ref-lakens_too_2017" role="doc-biblioref">2017</a>)</span>.</p>
<p>The probability of observing a significant or nonsignificant result in a study depends on the Type 1 error rate (<span class="math inline">\(\alpha\)</span>), the statistical power of the test (1-<span class="math inline">\(\beta\)</span>), and the probability that the null hypothesis is true <span class="citation" data-cites="wacholder_assessing_2004">(<a href="references.html#ref-wacholder_assessing_2004" role="doc-biblioref">Wacholder et al., 2004</a>)</span>. There are four possible outcomes of a study: a true positive, a false positive, a true negative, and a false negative. When <span class="math inline">\(H_0\)</span> is true, the probability of observing a false positive depends on the <span class="math inline">\(\alpha\)</span> level or the Type 1 error rate (e.g., 5%). When <span class="math inline">\(H_1\)</span> is true, the probability of observing a true positive depends on the statistical power of the performed test (where an often recommended minimum is 80%), which in turn depends on the <span class="math inline">\(\alpha\)</span> level, the true effect size, and the sample size. With an <span class="math inline">\(\alpha\)</span> level of 5%, and when <span class="math inline">\(H_0\)</span> is true, a false positive will occur with a 5% probability (as long as error rates are controlled, e.g., in preregistered studies) and true negative will occur with a 95% probability. When a test has 80% power, and <span class="math inline">\(H_1\)</span> is true, a true positive has a probability of 80%, and a false negative has a probability of 20%.</p>
<p>If we perform multiple studies, we can calculate the binomial probability that we will observe a specific number of significant and non-significant findings <span class="citation" data-cites="ioannidis_exploratory_2007">(<a href="references.html#ref-ioannidis_exploratory_2007" role="doc-biblioref">Ioannidis &amp; Trikalinos, 2007</a>)</span>. We can calculate the probability of finding exactly two significant results out of three studies assuming the null hypothesis is true. When <span class="math inline">\(H_0\)</span> is true, the probability of significant results equals the <span class="math inline">\(\alpha\)</span> level, and thus when the <span class="math inline">\(\alpha\)</span> level is carefully controlled (e.g., in preregistered studies) the probability of observing a significant result (p) = 0.05. That is, when k = 2, n = 3, and p = .05, the binomial probability function tells us that the probability of finding exactly two significant results in three studies is 0.007 (0.05 × 0.05 × 0.95 = 0.002375, and there are three orders in which two of the three results can be observed, so 0.002375 × 3 = 0.007).</p>
<p>To calculate the likelihood assuming <span class="math inline">\(H_1\)</span> is true, we need to make an assumption about the power in each study. Let’s provisionally assume all studies were powered at 80% and thus <em>p</em> = .80. The probability of observing exactly two significant results in three studies, assuming a power of 0.8, is 0.384 (0.8 × 0.8 × 0.2 = 0.128, and with three orders in which two of the three results can be significant, 0.128 × 3 = 0.384). In other words, if you set out to perform 3 studies, your hypothesis is correct, and you test your hypothesis with 80% power, there is a 38.4% probability of observing 2 out of 3 significant results, and a 9.6% probability to observe 1 out of 3 significant results (and for an extremely unlucky individual, a 0.8% probability of not finding any significant results in three studies, even though there is a true effect). Unless power is extremely high, mixed results should be expected in sets of studies.</p>
<p>Both likelihoods at <em>p</em> = .05 and <em>p</em> = .80 are highlighted in <a href="#fig-like8">Figure&nbsp;<span>3.8</span></a> by the circles on the dotted vertical lines.We can use the likelihood of the data assuming <span class="math inline">\(H_0\)</span> or <span class="math inline">\(H_1\)</span> is true to calculate the likelihood ratio, 0.384/0.007 = 53.89, which tells us the observed outcome of exactly two significant results out of three studies is 53.89 times more likely when <span class="math inline">\(H_1\)</span> is true and studies had 80% power, than when <span class="math inline">\(H_0\)</span> is true and studies have a carefully controlled 5% Type 1 error rate. Likelihood ratios of 8 and 32 have been proposed as benchmarks of moderately strong and strong evidence, respectively <span class="citation" data-cites="royall_statistical_1997">(<a href="references.html#ref-royall_statistical_1997" role="doc-biblioref">Royall, 1997</a>)</span>, which implies that finding two significant results out of the three studies could be considered strong evidence for <span class="math inline">\(H_1\)</span>, assuming 80% power. A Shiny app to perform these calculations is available <a href="https://shiny.ieis.tue.nl/mixed_results_likelihood/">here</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.8: Computing a likelihood ratio for two out of three significant results, assuming an alpha of 5% and 80% power.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In sets of studies, the likelihood ratio in favor of <span class="math inline">\(H_1\)</span> versus <span class="math inline">\(H_0\)</span> after observing a mix of significant and nonsignificant findings can become surprisingly large. Even though the evidence appears to be mixed, there is actually strong evidence in favor of a true effect. For example, when a researcher performs six studies with 80% power and a 5% alpha level and finds three significant outcomes and three nonsignificant outcomes, the cumulative likelihood ratio is convincingly large at 38-to-1 in favor of <span class="math inline">\(H_1\)</span> to consider the set of studies strong evidence for a true effect. Intuitively, researchers might not feel convinced by a set of studies where three out of six results were statistically significant. But if we do the math, we see that such a set of studies can be very strong evidence in favor of a true effect. A better understanding of these probabilities might be an important step in mitigating the negative effects of publication bias.</p>
<p>Hopefully, researchers become more inclined to submit nonsignificant findings for publication when they have a better understanding of the evidential value in lines of research with mixed results. Publishing all performed studies in lines of research will reduce publication bias, and increase the informational value of the data in the scientific literature. Expecting all studies in lines of research to be statistically significant is not reasonable, and it is important that researchers develop more realistic expectations if they are to draw meaningful inferences from lines of research. We don’t have a very good feeling for what real patterns of studies look like, because we are continuously exposed to a scientific literature that does not reflect reality. Almost all multiple study papers in the scientific literature present only statistically significant results, even though this is unlikely given the power of these studies, and the probability that we would only study correct predictions <span class="citation" data-cites="scheel_excess_2021">(<a href="references.html#ref-scheel_excess_2021" role="doc-biblioref">Scheel et al., 2021</a>)</span>. Educating researchers about binomial probabilities and likelihood ratios is a straightforward way to develop more realistic expectations about what research lines that contain evidential value in favor of <span class="math inline">\(H_1\)</span> actually look like.</p>
</section><section id="sec-likettest" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-likettest">
<span class="header-section-number">3.3</span> Likelihoods for <em>t</em>-tests</h2>
<p>So far we have computed likelihoods for binomial probabilities, but likelihoods can be computed for any statistical model <span class="citation" data-cites="glover_likelihood_2004 pawitan_all_2001">(<a href="references.html#ref-glover_likelihood_2004" role="doc-biblioref">Glover &amp; Dixon, 2004</a>; <a href="references.html#ref-pawitan_all_2001" role="doc-biblioref">Pawitan, 2001</a>)</span>. For example, we can compute the relative likelihood of observing a <em>t</em>-value under the null and an alternative hypothesis as illustrated in <a href="#fig-like9">Figure&nbsp;<span>3.9</span></a>. Of course, the observed data is most likely if we assume the observed effect equals the true effect, but examining the likelihood reveals that there are many alternative hypotheses that are relatively more likely than the null hypothesis. This also holds when observing non-significant results, which can be more likely under an alternative hypothesis of interest, than under the null hypothesis. This is a reason why it is incorrect to say that there is no effect when <em>p</em> &gt; <span class="math inline">\(\alpha\)</span> (see <a href="01-pvalue.html#sec-misconception1"><em>p</em>-value misconception 1</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-like9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-likelihoods_files/figure-html/fig-like9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.9: Likelihood ratio for observed <em>t</em>-value under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="test-yourself" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="test-yourself">
<span class="header-section-number">3.4</span> Test Yourself</h2>
<section id="questions-about-likelihoods" class="level3 webex-check webex-box" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="questions-about-likelihoods">
<span class="header-section-number">3.4.1</span> Questions about likelihoods</h3>
<p><strong>Q1</strong>: Let’s assume you expect this is a fair coin. What is the binomial probability of observing 8 heads out of 10 coin flips, when p = 0.5? (You can use the functions in the chapter, or compute it by hand).</p>
<div class="cell" data-layout-align="center">
<div id="radio_YFMXDRXNJK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YFMXDRXNJK" value="answer"><span>0.044</span></label><label><input type="radio" autocomplete="off" name="radio_YFMXDRXNJK" value=""><span>0.05</span></label><label><input type="radio" autocomplete="off" name="radio_YFMXDRXNJK" value=""><span>0.5</span></label><label><input type="radio" autocomplete="off" name="radio_YFMXDRXNJK" value=""><span>0.8</span></label>
</div>
</div>
<p><strong>Q2</strong>: The likelihood curve rises up and falls down, except at the extremes, when 0 heads or only heads are observed. Copy the code below (remember that you can click the ‘clipboard’ icon on the top right of the code section to copy all the code to your clipboard), and plot the likelihood curves for 0 heads (x &lt;- 0) out of 10 flips (n &lt;- 10) by running the script. What does the likelihood curve look like?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># set total trials</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># set successes</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>H0 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># specify one hypothesis you want to compare</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>H1 <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="co"># specify another hypothesis you want to compare</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">dbinom</span>(x, n, H0) <span class="sc">/</span> <span class="fu">dbinom</span>(x, n, H1) <span class="co"># Returns the H0/H1 likelihood ratio</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">dbinom</span>(x, n, H1) <span class="sc">/</span> <span class="fu">dbinom</span>(x, n, H0) <span class="co"># Returns the H1/H0 likelihood ratio</span></span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">len =</span> <span class="dv">100</span>) <span class="co"># create probability variable from 0 to 1</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>like <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, n, theta)</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="fu">plot</span>(theta, like, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"Likelihood"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="fu">points</span>(H0, <span class="fu">dbinom</span>(x, n, H0))</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="fu">points</span>(H1, <span class="fu">dbinom</span>(x, n, H1))</span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="fu">segments</span>(H0, <span class="fu">dbinom</span>(x, n, H0), x <span class="sc">/</span> n, <span class="fu">dbinom</span>(x, n, H0), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="fu">segments</span>(H1, <span class="fu">dbinom</span>(x, n, H1), x <span class="sc">/</span> n, <span class="fu">dbinom</span>(x, n, H1), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="fu">segments</span>(x <span class="sc">/</span> n, <span class="fu">dbinom</span>(x, n, H0), x <span class="sc">/</span> n, <span class="fu">dbinom</span>(x, n, H1), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="fu">title</span>(<span class="fu">paste</span>(<span class="st">"Likelihood Ratio H0/H1:"</span>, <span class="fu">round</span>(<span class="fu">dbinom</span>(x, n, H0) <span class="sc">/</span> <span class="fu">dbinom</span>(x, n, H1), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">" Likelihood Ratio H1/H0:"</span>, <span class="fu">round</span>(<span class="fu">dbinom</span>(x, n, H1) <span class="sc">/</span> <span class="fu">dbinom</span>(x, n, H0), <span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div id="radio_RZFOEMRUOB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RZFOEMRUOB" value=""><span>The likelihood curve is a horizontal line.</span></label><label><input type="radio" autocomplete="off" name="radio_RZFOEMRUOB" value=""><span>The script returns an error message: it is not possible to plot the likelihood curve for 0 heads.</span></label><label><input type="radio" autocomplete="off" name="radio_RZFOEMRUOB" value="answer"><span>The curve starts at its highest point at p = 0, and then the likelihood decreases as p increases.</span></label><label><input type="radio" autocomplete="off" name="radio_RZFOEMRUOB" value=""><span>The curve starts at its lowest point at p = 0, and then the likelihood increases as p increases.</span></label>
</div>
</div>
<p><strong>Q3</strong>: Get a coin out of your wallet. Flip it 13 times, and count the number of heads. Using the code above, calculate the likelihood of your observed results under the hypothesis that your coin is fair, compared to the hypothesis that the coin is not fair. Set the number of successes (x) to the number of heads you observed. Change <span class="math inline">\(H_1\)</span> to the number of heads you have observed (or leave it to 0 if you didn’t observe any heads at all!). You can just use 4/13, or enter 0.3038. Leave <span class="math inline">\(H_0\)</span> at 0.5. Run the script to calculate the likelihood ratio. What is the likelihood ratio of a fair compared to a non-fair coin (or <span class="math inline">\(H_0\)</span>/<span class="math inline">\(H_1\)</span>) that flips heads as often as you have observed, based on the observed data? Round your answer to 2 digits after the decimal.</p>
<p><input class="webex-solveme nospaces" data-tol="0.011" size="4" data-answer="[&quot;0&quot;,&quot;0.03&quot;,&quot;0.14&quot;,&quot;0.37&quot;,&quot;0.71&quot;,&quot;0.96&quot;,&quot;.03&quot;,&quot;.14&quot;,&quot;.37&quot;,&quot;.71&quot;,&quot;.96&quot;]"></p>
<p><strong>Q4</strong>: Earlier we mentioned that with increasing sample sizes, we had collected stronger relative evidence. Let’s say we would want to compare L(p = 0.4) with L(p = 0.5). What is the likelihood ratio if <span class="math inline">\(H_1\)</span> is 0.4, <span class="math inline">\(H_0\)</span> is 0.5, and you flip 5 heads in 10 trials? From the two possible ways to calculate the likelihood ratio (<span class="math inline">\(H_1\)</span>/<span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_0\)</span>/<span class="math inline">\(H_1\)</span>), report the likelihood that is ≥ 1, and round to 2 digits after the decimal point.</p>
<p><input class="webex-solveme nospaces" data-tol="0.011" size="4" data-answer="[&quot;1.23&quot;]"></p>
<p><strong>Q5</strong>: What is the likelihood ratio if <span class="math inline">\(H_1\)</span> is 0.4, <span class="math inline">\(H_0\)</span> is 0.5, and you flip 50 heads in 100 trials? From the two possible ways to calculate the likelihood ratio (<span class="math inline">\(H_1\)</span>/<span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_0\)</span>/<span class="math inline">\(H_1\)</span>), report the likelihood that is ≥ 1, and round to 2 digits after the decimal point.</p>
<p><input class="webex-solveme nospaces" data-tol="0.011" size="3" data-answer="[&quot;7.7&quot;]"></p>
<p><strong>Q6</strong>: What is the likelihood ratio if <span class="math inline">\(H_1\)</span> is 0.4, <span class="math inline">\(H_0\)</span> is 0.5, and you flip 500 heads in 1000 trials? From the two possible ways to calculate the likelihood ratio (<span class="math inline">\(H_1\)</span>/<span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_0\)</span>/<span class="math inline">\(H_1\)</span>), report the likelihood that is ≥ 1, and round to 2 digits after the decimal point.</p>
<p><input class="webex-solveme nospaces" data-tol="2" size="9" data-answer="[&quot;731784961&quot;]"></p>
<p><strong>Q7</strong>: When comparing two hypotheses (p = X vs p = Y), a likelihood ratio of:</p>
<div class="cell" data-layout-align="center">
<div id="radio_ZTUYOWIJXB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZTUYOWIJXB" value=""><span>0.02 means that there is not enough evidence in the data for either of the two hypotheses.</span></label><label><input type="radio" autocomplete="off" name="radio_ZTUYOWIJXB" value=""><span>5493 means that hypothesis p = X is most supported by the data.</span></label><label><input type="radio" autocomplete="off" name="radio_ZTUYOWIJXB" value="answer"><span>5493 means that hypothesis p = X is much more supported by the data than p = Y.</span></label><label><input type="radio" autocomplete="off" name="radio_ZTUYOWIJXB" value=""><span>0.02 means that the hypothesis that the data are 2% more likely under the hypothesis that p = X than under the hypothesis that p = Y.</span></label>
</div>
</div>
</section><section id="questions-about-mixed-results" class="level3 webex-check webex-box" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="questions-about-mixed-results">
<span class="header-section-number">3.4.2</span> Questions about mixed results</h3>
<p>A Shiny app to perform the calculations is available <a href="https://shiny.ieis.tue.nl/mixed_results_likelihood/">here</a>.</p>
<p><strong>Q8:</strong> Which statement is correct when you perform 3 studies?</p>
<div class="cell" data-layout-align="center">
<div id="radio_RECYGKBDGS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RECYGKBDGS" value="answer"><span>When <span class="math inline">\(H_1\)</span> is true, alpha = 0.05, and power = 0.80, it is almost as likely to observe one or more non-significant results (48.8%) as it is to observe only significant result (51.2%).</span></label><label><input type="radio" autocomplete="off" name="radio_RECYGKBDGS" value=""><span>When alpha = 0.05 and power = 0.80, it is extremely rare that you will find 3 significant results (0.0125%), regardless of whether <span class="math inline">\(H_0\)</span> is true or <span class="math inline">\(H_1\)</span> is true.</span></label><label><input type="radio" autocomplete="off" name="radio_RECYGKBDGS" value=""><span>When alpha = 0.05 and power = 0.80, 2 out of 3 statistically significant results is the most likely outcome of all possible outcomes (0 out of 3, 1 out of 3, 2 out of 3, or 3 out of 3), and occurs 38.4% of the time when <span class="math inline">\(H_1\)</span> is true.</span></label><label><input type="radio" autocomplete="off" name="radio_RECYGKBDGS" value=""><span>When alpha = 0.05 and power = 0.80, the probability of finding at least one false positive (a significant result when <span class="math inline">\(H_0\)</span> is true) in three studies is 5%.</span></label>
</div>
</div>
<p><strong>Q9:</strong> Sometimes in lines of three studies, you’ll find a significant effect in one study, but there is no effect in the other two related studies. Assume the two related studies were not exactly the same in every way (e.g., you have changed the manipulation, or the procedure, or some of the questions). It could be that the two other studies did not work because of minor differences that had some effect you do not fully understand yet. Or it could be that the single significant result was a Type 1 error, and <span class="math inline">\(H_0\)</span> was true in all three studies. Which statement below is correct, assuming a 5% Type 1 error rate and 80% power?</p>
<div class="cell" data-layout-align="center">
<div id="radio_VNIUBZMISC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VNIUBZMISC" value=""><span>All else being equal, the probability of a Type 1 error in one of three studies is 5% when there is no true effect in all three studies, and the probability of finding exactly 1 in three significant effects, assuming 80% power in all three studies, is 80%, which is substantially more likely.</span></label><label><input type="radio" autocomplete="off" name="radio_VNIUBZMISC" value="answer"><span>All else being equal, the probability of a Type 1 error in one of three studies is 13.5% when there is no true effect in all three studies, and the probability of finding exactly 1 in three significant effects, assuming 80% power in all three studies (and thus a true effect), is 9.6%, which is slightly, but not substantially less likely.</span></label><label><input type="radio" autocomplete="off" name="radio_VNIUBZMISC" value=""><span>All else being equal, the probability of a Type 1 error in one of three studies is 85.7% when there is no true effect in all three studies, and the probability of finding exactly 1 in three significant effects, assuming 80% power in all three studies (and thus a true effect) (and thus a true effect), is 0.8%, which is substantially less likely.</span></label><label><input type="radio" autocomplete="off" name="radio_VNIUBZMISC" value=""><span>It is not possible to know the probability you will observe a Type 1 error if you perform 3 studies.</span></label>
</div>
</div>
<p>The idea that most studies have 80% power is slightly optimistic. <strong>Examine the correct answer to the previous question across a range of power values</strong> (e.g., 50% power, and 30% power).</p>
<p><strong>Q10:</strong> Several papers suggest it is a reasonable assumption that the power in the psychological literature might be around 50%. Set the number of studies to 4, the number of successes also to 4, and the assumed power slider to 50%, and look at the table at the bottom of the app. How likely is it to observe 4 significant results in 4 studies, assuming there is a true effect?</p>
<div class="cell" data-layout-align="center">
<div id="radio_KVRIADPZPD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KVRIADPZPD" value="answer"><span>6.25%</span></label><label><input type="radio" autocomplete="off" name="radio_KVRIADPZPD" value=""><span>12.5%</span></label><label><input type="radio" autocomplete="off" name="radio_KVRIADPZPD" value=""><span>25%</span></label><label><input type="radio" autocomplete="off" name="radio_KVRIADPZPD" value=""><span>37.5%</span></label>
</div>
</div>
<p>Imagine you perform 4 studies, and 3 show a significant result. <strong>Change these numbers in the online app. Leave the power at 50%</strong>. The output in the text tells you:</p>
<p><em>When the observed results are equally likely under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>, the likelihood ratio is 1. Benchmarks to interpret Likelihood Ratios suggest that when 1&lt;LR&lt;8 there is weak evidence, when 8&lt;LR&lt;32 there is moderate evidence, and when LR&gt;32, there is strong evidence.</em></p>
<p><em>The data are more likely under the alternative hypothesis than the null hypothesis with a likelihood ratio of 526.32</em></p>
<p>These calculations show that, assuming you have observed three significant results out of four studies, and assuming each study had 50% power, it is 526 times more likely to have observed these data when the alternative hypothesis is true, than when the null hypothesis is true. In other words, it is 526 times more likely to find a significant effect in three studies when you have 50% power, than to find three Type 1 errors in a set of four studies.</p>
<p><strong>Q11</strong>: Maybe you don’t think 50% power is a reasonable assumption. How low can the power be (rounded to 2 digits), for the likelihood to remain higher than 32 in favor of <span class="math inline">\(H_1\)</span> when observing 3 out of 4 significant results?</p>
<div class="cell" data-layout-align="center">
<div id="radio_EGNATUPXPY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_EGNATUPXPY" value=""><span>5% power</span></label><label><input type="radio" autocomplete="off" name="radio_EGNATUPXPY" value="answer"><span>17% power</span></label><label><input type="radio" autocomplete="off" name="radio_EGNATUPXPY" value=""><span>34% power</span></label><label><input type="radio" autocomplete="off" name="radio_EGNATUPXPY" value=""><span>44% power</span></label>
</div>
</div>
<p>The main take home message of these calculations is to understand that 1) mixed results are supposed to happen, and 2) mixed results can contain strong evidence for a true effect, across a wide range of plausible power values. The app also tells you how much evidence, in a rough dichotomous way, you can expect. This is useful for our educational goal. But when you want to evaluate results from multiple studies, the formal way to do so is by performing a meta-analysis.</p>
<p>The above calculations make a very important assumption: The Type 1 error rate is controlled at 5%. If you try out many different tests in each study, and only report the result that yielded a p &lt; 0.05, these calculations no longer hold.</p>
<p><strong>Q12</strong>: Go back to the default settings of 2 out of 3 significant results, but now set the Type 1 error rate to 20%, to reflect a modest amount of p-hacking. Under these circumstances, what is the <strong>highest</strong> likelihood in favor of <span class="math inline">\(H_1\)</span> you can get if you explore all possible values for the true power?</p>
<div class="cell" data-layout-align="center">
<div id="radio_MODXPOWZAX" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MODXPOWZAX" value=""><span>Approximately 1</span></label><label><input type="radio" autocomplete="off" name="radio_MODXPOWZAX" value="answer"><span>Approximately 4.63</span></label><label><input type="radio" autocomplete="off" name="radio_MODXPOWZAX" value=""><span>Approximately 6.70</span></label><label><input type="radio" autocomplete="off" name="radio_MODXPOWZAX" value=""><span>Approximately 62.37</span></label>
</div>
</div>
<p>As the scenario above shows, <em>p</em>-hacking makes studies extremely uninformative. <strong>If you inflate the error rate, you quickly destroy the evidence in the data.</strong> You can no longer determine whether the data is more likely when there is no effect, than when there is an effect. Sometimes researchers complain that people who worry about <em>p</em>-hacking and try to promote better Type 1 error control are missing the point, and that other things (better measurement, better theory, etc.) are more important. I fully agree that these aspects of scientific research are at least as important as better error control. But better measures and theories will require decades of work. Better error control can be accomplished today, if researchers would stop inflating their error rates by flexibly analyzing their data. And as this assignment shows, inflated rates of false positives very quickly make it difficult to learn what is true from the data we collect. Because of the relative ease with which this part of scientific research can be improved, and because we can achieve this today (and not in a decade) I think it is worth stressing the importance of error control, and publish more realistic looking sets of studies.</p>
<p><strong>Q13</strong>: Some ‘prestigious’ journals (which, when examined in terms of scientific quality such as reproducibility, reporting standards, and policies concerning data and material sharing, are quite low quality despite their prestige) only publish manuscripts with a large number of studies, which should all be statistically significant. If we assume an average power in psychology of 50%, only 3.125% of 5 study articles should contain exclusively significant results. If you pick up a random issue from such a prestigious journal, and see 10 articles, each reporting 5 studies, and all manuscripts have exclusively significant results, would you trust the reported findings more, or less, than when all these articles had reported mixed results? Why?</p>
<p><strong>Q14</strong>: Unless you will power all your studies at 99.99% for the rest of your career (which would be slightly inefficient, but great if you don’t like insecurity), you will observe mixed results in lines of research. How do you plan to deal with mixed results in lines of research?</p>
</section><section id="open-questions" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="open-questions">
<span class="header-section-number">3.4.3</span> Open Questions</h3>
<ol type="1">
<li><p>What is the difference between a probability and a likelihood?</p></li>
<li><p>Why is it important to remember that a likelihood ratio is relative evidence?</p></li>
<li><p>If we compare 2 hypotheses, H0 and H1, and the likelihood ratio of H1 compared to H0 is 77, what does this mean?</p></li>
<li><p>What are benchmarks for medium and strong evidence according to Royall?</p></li>
<li><p>How can it be that a likelihood ratio is 200, but both hypotheses are incorrect?</p></li>
<li><p>If we perform multiple studies and find 2 out of 3 studies show a significant results, how can this actually be strong evidence for H1?</p></li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-aldrich_r_1997" class="csl-entry" role="listitem">
Aldrich, J. (1997). R.<span>A</span>. <span>Fisher</span> and the making of maximum likelihood 1912-1922. <em>Statistical Science</em>, <em>12</em>(3), 162–176. <a href="https://doi.org/10.1214/ss/1030037906">https://doi.org/10.1214/ss/1030037906</a>
</div>
<div id="ref-dienes_understanding_2008" class="csl-entry" role="listitem">
Dienes, Z. (2008). <em>Understanding psychology as a science: <span>An</span> introduction to scientific and statistical inference</em>. <span>Palgrave Macmillan</span>.
</div>
<div id="ref-fanelli_positive_2010" class="csl-entry" role="listitem">
Fanelli, D. (2010). <span>“<span>Positive</span>”</span> <span>Results Increase Down</span> the <span>Hierarchy</span> of the <span>Sciences</span>. <em>PLoS ONE</em>, <em>5</em>(4). <a href="https://doi.org/10.1371/journal.pone.0010068">https://doi.org/10.1371/journal.pone.0010068</a>
</div>
<div id="ref-francis_frequency_2014" class="csl-entry" role="listitem">
Francis, G. (2014). The frequency of excess success for articles in <span>Psychological Science</span>. <em>Psychonomic Bulletin &amp; Review</em>, <em>21</em>(5), 1180–1187. <a href="https://doi.org/10.3758/s13423-014-0601-x">https://doi.org/10.3758/s13423-014-0601-x</a>
</div>
<div id="ref-franco_publication_2014" class="csl-entry" role="listitem">
Franco, A., Malhotra, N., &amp; Simonovits, G. (2014). Publication bias in the social sciences: <span>Unlocking</span> the file drawer. <em>Science</em>, <em>345</em>(6203), 1502–1505. <a href="https://doi.org/10.1126/SCIENCE.1255484">https://doi.org/10.1126/SCIENCE.1255484</a>
</div>
<div id="ref-glover_likelihood_2004" class="csl-entry" role="listitem">
Glover, S., &amp; Dixon, P. (2004). Likelihood ratios: <span>A</span> simple and flexible statistic for empirical psychologists. <em>Psychonomic Bulletin &amp; Review</em>, <em>11</em>(5), 791–806.
</div>
<div id="ref-ioannidis_exploratory_2007" class="csl-entry" role="listitem">
Ioannidis, J. P. A., &amp; Trikalinos, T. A. (2007). An exploratory test for an excess of significant findings. <em>Clinical Trials</em>, <em>4</em>(3), 245–253. <a href="https://doi.org/10.1177/1740774507079441">https://doi.org/10.1177/1740774507079441</a>
</div>
<div id="ref-lakens_too_2017" class="csl-entry" role="listitem">
Lakens, D., &amp; Etz, A. J. (2017). Too <span>True</span> to be <span>Bad</span>: <span>When Sets</span> of <span>Studies With Significant</span> and <span>Nonsignificant Findings Are Probably True</span>. <em>Social Psychological and Personality Science</em>, <em>8</em>(8), 875–881. <a href="https://doi.org/10.1177/1948550617693058">https://doi.org/10.1177/1948550617693058</a>
</div>
<div id="ref-millar_maximum_2011" class="csl-entry" role="listitem">
Millar, R. B. (2011). <em>Maximum likelihood estimation and inference: With examples in <span>R</span>, <span>SAS</span>, and <span>ADMB</span></em>. <span>Wiley</span>.
</div>
<div id="ref-pawitan_all_2001" class="csl-entry" role="listitem">
Pawitan, Y. (2001). <em>In all likelihood: Statistical modelling and inference using likelihood</em>. <span>Clarendon Press ; Oxford University Press</span>.
</div>
<div id="ref-royall_statistical_1997" class="csl-entry" role="listitem">
Royall, R. (1997). <em>Statistical <span>Evidence</span>: <span>A Likelihood Paradigm</span></em>. <span>Chapman and Hall/CRC</span>.
</div>
<div id="ref-scheel_excess_2021" class="csl-entry" role="listitem">
Scheel, A. M., Schijen, M. R. M. J., &amp; Lakens, D. (2021). An <span>Excess</span> of <span>Positive Results</span>: <span>Comparing</span> the <span>Standard Psychology Literature With Registered Reports</span>. <em>Advances in Methods and Practices in Psychological Science</em>, <em>4</em>(2), 25152459211007467. <a href="https://doi.org/10.1177/25152459211007467">https://doi.org/10.1177/25152459211007467</a>
</div>
<div id="ref-schimmack_ironic_2012" class="csl-entry" role="listitem">
Schimmack, U. (2012). The ironic effect of significant results on the credibility of multiple-study articles. <em>Psychological Methods</em>, <em>17</em>(4), 551–566. <a href="https://doi.org/10.1037/a0029487">https://doi.org/10.1037/a0029487</a>
</div>
<div id="ref-taper_philosophy_2011" class="csl-entry" role="listitem">
Taper, M. L., &amp; Lele, S. R. (2011). Philosophy of <span>Statistics</span>. In P. S. Bandyophadhyay &amp; M. R. Forster (Eds.), <em>Evidence, evidence functions, and error probabilities</em> (pp. 513–531). <span>Elsevier, USA</span>.
</div>
<div id="ref-wacholder_assessing_2004" class="csl-entry" role="listitem">
Wacholder, S., Chanock, S., Garcia-Closas, M., El ghormli, L., &amp; Rothman, N. (2004). Assessing the <span>Probability That</span> a <span>Positive Report</span> is <span>False</span>: <span>An Approach</span> for <span>Molecular Epidemiology Studies</span>. <em>JNCI Journal of the National Cancer Institute</em>, <em>96</em>(6), 434–442. <a href="https://doi.org/10.1093/jnci/djh075">https://doi.org/10.1093/jnci/djh075</a>
</div>
</div>
</section></section></main><!-- /main --><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-errorcontrol.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Error control</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-bayes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Lakens, D. (2022). Improving Your Statistical Inferences. Retrieved from https://lakens.github.io/statistical_inferences/. https://doi.org/10.5281/zenodo.6409077</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>