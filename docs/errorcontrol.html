<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Error control | Improving Your Statistical Inferences</title>
<meta name="author" content="Daniel Lakens">
<meta name="description" content="In the previous chapter on p-values we have learned that in the Neyman-Pearson approach to hypothesis testing the goal is to make scientific claims while controlling how often you will make a fool...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 2 Error control | Improving Your Statistical Inferences">
<meta property="og:type" content="book">
<meta property="og:description" content="In the previous chapter on p-values we have learned that in the Neyman-Pearson approach to hypothesis testing the goal is to make scientific claims while controlling how often you will make a fool...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Error control | Improving Your Statistical Inferences">
<meta name="twitter:description" content="In the previous chapter on p-values we have learned that in the Neyman-Pearson approach to hypothesis testing the goal is to make scientific claims while controlling how often you will make a fool...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Improving Your Statistical Inferences</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="pvalue.html"><span class="header-section-number">1</span> Using p-values to test a hypothesis</a></li>
<li><a class="active" href="errorcontrol.html"><span class="header-section-number">2</span> Error control</a></li>
<li><a class="" href="likelihoods.html"><span class="header-section-number">3</span> Likelihoods</a></li>
<li><a class="" href="bayes.html"><span class="header-section-number">4</span> Bayesian statistics</a></li>
<li><a class="" href="questions.html"><span class="header-section-number">5</span> Asking Statistical Questions</a></li>
<li><a class="" href="effectsize.html"><span class="header-section-number">6</span> Effect Sizes</a></li>
<li><a class="" href="confint.html"><span class="header-section-number">7</span> Confidence Intervals</a></li>
<li><a class="" href="power.html"><span class="header-section-number">8</span> Sample size justification</a></li>
<li><a class="" href="equivalencetest.html"><span class="header-section-number">9</span> Equivalence Testing and Interval Hypotheses</a></li>
<li><a class="" href="prereg.html"><span class="header-section-number">10</span> Preregistration and Transparency</a></li>
<li><a class="" href="meta.html"><span class="header-section-number">11</span> Meta-analysis</a></li>
<li><a class="" href="bias.html"><span class="header-section-number">12</span> Bias detection</a></li>
<li><a class="" href="computationalreproducibility.html"><span class="header-section-number">13</span> Computational Reproducibility</a></li>
<li><a class="" href="references.html"><span class="header-section-number">14</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/Lakens/statistical_inferences">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="errorcontrol" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Error control<a class="anchor" aria-label="anchor" href="#errorcontrol"><i class="fas fa-link"></i></a>
</h1>
<p>In the previous chapter on <a href="pvalue.html#pvalue"><em>p</em>-values</a> we have learned that in the Neyman-Pearson approach to hypothesis testing the goal is to make scientific claims while controlling how often you will make a fool of yourself in the long run. As Benjamini <span class="citation">(<a href="references.html#ref-benjamini_its_2016" role="doc-biblioref">2016</a>)</span> notes, a <em>p</em>-value "offers a first line of defense against being fooled by randomness, separating signal from noise". There are indications that banning the use of <em>p</em>-values increases the ability of researchers to present erroneous claims. Based on qualitative analyses of scientific articles published after the null-hypothesis significance ban in the journal Basic and Applied Social Psychology <span class="citation">Fricker et al. (<a href="references.html#ref-fricker_assessing_2019" role="doc-biblioref">2019</a>)</span> conclude: “When researchers only employ descriptive statistics we found that they are likely to overinterpret and/or overstate their results compared to a researcher who uses hypothesis testing with the p &lt; 0.05 threshold”. Researchers often do not control error rates when they make claims, and sometimes intentionally use flexibility in the data analysis to 'p-hack' or cherry-pick one out of many performed analyses that shows the results they wanted to see. From an error-statistical approach to statistical inferences, this is problematic behavior, as Mayo <span class="citation">(<a href="references.html#ref-mayo_statistical_2018" role="doc-biblioref">2018</a>)</span> writes:</p>
<blockquote>
<p>The problem with cherry picking, hunting for significance, and a host of biasing selection effects – the main source of handwringing behind the statistics crisis in science – is they wreak havoc with a method’s error probabilities. It becomes easy to arrive at findings that have not been severely tested.</p>
</blockquote>
<p>## Which outcome can you expect if you perform a study?</p>
<p>If you perform a study and plan to make a claim based on the statistical test you plan to perform, the the long run probability of making a correct claim or an erroneous claim is determined by three factors, namely the Type 1 error rate, the Type 2 error rate, and the probability that the null-hypothesis is true. There are four possible outcomes of a statistical test, depending on whether the result is statistically significant or not, and whether the null hypothesis is true, or not.</p>
<p><strong>False Positive (FP)</strong>: Concluding there is a true effect, when there is a no true effect (H0 is true). This is also referred to as a <strong>Type 1 error</strong>, and indicated by <strong>α</strong>.</p>
<p><strong>False Negative (FN)</strong>: Concluding there is a no true effect, when there is a true effect (H1 is true). This is also referred to as a <strong>Type 2 error</strong>, and indicated by <strong>β</strong>.</p>
<p><strong>True Negative (TN)</strong>: Concluding there is no true effect, when there is a no true effect (H0 is true). This is the complement of False Positives, and is thus indicated by<strong>1-α</strong>.</p>
<p><strong>True Positive (TP)</strong>: Concluding there is a true effect, when there is a true effect (H1 is true). This is the complement of False Negatives, and is thus indicated by <strong>1-β</strong>.</p>
<p>The probability of observing a true positive when there is a true effect is, in the long run, equal to the <strong>statistical power</strong> of your study. The probability of observing a false positive when the null hypothesis is true is, in the long run, equal to the <strong>alpha level</strong> you have set, or the <strong>Type 1 error rate</strong>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:errortypes"></span>
<img src="images/type1type2error.jpg" alt='Difference between Type 1 and Type 2 errors. Figure made by &lt;a href="https://effectsizefaq.com/2010/05/31/i-always-get-confused-about-type-i-and-ii-errors-can-you-show-me-something-to-help-me-remember-the-difference/"&gt;Paul Ellis&lt;/a&gt;' width="100%"><p class="caption">
Figure 2.1: Difference between Type 1 and Type 2 errors. Figure made by <a href="https://effectsizefaq.com/2010/05/31/i-always-get-confused-about-type-i-and-ii-errors-can-you-show-me-something-to-help-me-remember-the-difference/">Paul Ellis</a>
</p>
</div>
<p>So, for the next study you will perform, which of the four possible outcomes is most likely? First, let's assume you have set the alpha level to 5%. Furthermore, let's assume you have designed a study so that it will have 80% power (and for this example, let's assume Omniscient Jones knows you indeed have exactly 80% power). The last thing to specify is the probability that the null hypothesis is true. Let’s assume for this next study you have no idea if the null hypothesis is true or not, and that it is equally likely that the null hypothesis is true, or the alternative hypothesis is true (both have a probability of 50%). We can now calculate what the most likely outcome of such a study is.</p>
<p>Before we perform this calculation, take a moment to think if you know the answer. You might have designed studies with a 5% alpha level and 80% power, where you believed it was equally likely that H0 or H1 was true. Surely, it is useful to have reasonable expectations about which result to expect, when we perform such a study? Yet in my experience, many researchers perform without thinking about these probabilities at all. They often hope to observe a true positive, even when in the situation described above, the most likely outcome is a true negative. Let's now calculate these probabilities.</p>
<p>Let's assume we perform 200 studies with a 5% alpha level, 80% power, and a 50% probability that H0 is true. How many false positives, true positives, false negatives, and true negatives should we expect in the long run?</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="39%">
<col width="30%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>H0 True (50%)</th>
<th>H1 True (50%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Significant Finding (Positive result) α = 5%, 1-β=80%</td>
<td><strong>False Positive 5%*50%=2.5% (5 studies)</strong></td>
<td><strong>True Positive 80%*50%=40% (80 studies)</strong></td>
</tr>
<tr class="even">
<td>Non-Significant Finding (Negative result) 1-α = 95%, β=20%</td>
<td><strong>True Negative 95%*50%=47.5% (95 studies)</strong></td>
<td><strong>False Negative 20%*50%=10% (20 studies)</strong></td>
</tr>
</tbody>
</table></div>
<p>In the table above we see that 2.5% of all studies will be a false positive (a 5% Type 1 error rate,
multiplied by a 50% probability that H0 is true). 40% of all studies will be a true positive (80% power multiplied by a 50% probability that H1 is true). The probability of a false negative is 10% (a 20% Type 2 error rate multiplied by a 50% probability that H1 is true). The most likely outcome is a true negative, with 47.5% (a 95% probability observing a non-significant result, multiplied by a 50% probability that H0 is true).</p>
<p>It might be that you are not too enthusiastic about this outlook, and you would like to perform studies that have a higher probability of observing a true positive. What should we do? We can reduce the alpha level, increase the power, or increase the probability that H1 is true. As the probability of observing a true positive depends on the power, multiplied by the probability that H1 is true, we should design studies where both of these values are high. Statistical power can be increased by changes in the design of the study (e.g., by increasing the sample size). The probability that H1 is true depends on the hypothesis you are testing. If the probability that H1 is true is very high from the outset, you are at the risk of testing a hypothesis that is already established with enough certainty. A solution, which might not happen that often in your career, is to come up with the test of a hypothesis that is not trivial, but that after explaining it to peers makes a lot of sense. In other words, they would not have come up with the idea themselves, but after explaining it to them, they think it is extremely plausible. Such creative research ideas will most likely be very rare in your academic career, if you ever have any at all. Not all research needs to be this ground-breaking. It is also extremely valuable to perform <strong>replication and extension studies</strong> where it is relatively likely that H1 is true, but the scientific community still benefits from knowing that findings generalize to different circumstances.</p>
<div id="positive-predictive-value" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Positive predictive value<a class="anchor" aria-label="anchor" href="#positive-predictive-value"><i class="fas fa-link"></i></a>
</h2>
<p>John Ioannides wrote a well known article titled "Why Most Published Research Findings Are False" <span class="citation">(<a href="references.html#ref-ioannidis_why_2005" role="doc-biblioref">Ioannidis, 2005</a>)</span>. At the same time, we have learned that if you set your alpha at 5%, the Type 1 error rate will not be higher than 5% (in the long run). How are these two statements related? Why aren’t 95% of published research findings true? They key to understanding this difference is that two different probabilities are calculated. The Type 1 error rate is the probability of saying there is an effect, when there is no effect. Ioannides calculates the <em>positive predictive value</em> (PPV), which is the conditional probability that if a study turns out to show a statistically significant result, there is actually a true effect. This probability is useful to understand, because people often selectively focus on significant results, and because due to publication bias, in some research areas only significant results are published.</p>
<p>A real-life example where it was useful to understand the concept of the positive predictive value concerned the number of vaccinated and vaccinated people admitted to the hospital with COVID symptoms. In some places equal numbers of patients were vaccinated as unvaccinated. If you do not understand the concept of a positive predictive value, you might believe this reveals that it is equally likely to end up in the hospital, whether you are vaccinated or not. This is incorrect. As Figure <a href="errorcontrol.html#fig:ppvhospital">2.2</a> nicely vizualizes, the probability that is person is vaccinated is very high, and the probability that a vaccinated person ends up in the hospital is much lower than the probability that an unvaccinated person ends up in the hospital. However, if we select only those individuals who end up in the hospital, we are computing a probability <em>conditional</em> on being in the hospital.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ppvhospital"></span>
<img src="images/hospitalvaccinated.jpg" alt="Why there are more vaccinated people in the hospital." width="100%"><p class="caption">
Figure 2.2: Why there are more vaccinated people in the hospital.
</p>
</div>
<p>It is useful to understand what the probability is that, if you have observed a significant result in an experiment, the result is actually a true positive. In other words, in the long run, how many <em>true positives</em> can we expect, among all positive results (both true positives and false positives)? This is known as the Positive Predictive Value (PPV). We can also calculate how many <em>false positives</em> we can expect, among all positive results (again, both true positives and false positives). This is known as the <strong>False Positive Report Probability</strong> <span class="citation">(<a href="references.html#ref-wacholder_assessing_2004" role="doc-biblioref">Wacholder et al., 2004</a>)</span>, sometimes also referred to as the False Positive Risk <span class="citation">(<a href="references.html#ref-colquhoun_false_2019" role="doc-biblioref">Colquhoun, 2019</a>)</span>.</p>
<p><span class="math display">\[PPV = \frac{\text{True}\ \text{Positives}}{(\text{True}\ \text{Positives} +
                                                \text{False}\ \text{Positives})}\]</span></p>
<p><span class="math display">\[FPRP = \frac{\text{False}\ \text{Positives}}{(\text{True}\ \text{Positives}
                                                  + \text{False}\ \text{Positives})}\]</span></p>
<p>The PPV and FPRP combine classic Frequentist concepts of statistical power and alpha levels with prior probabilities that H0 and H1 are true. They depend on the proportion of studies you do where there is an effect (H1 is true), and where there is no effect (H0 is true), in addition to the statistical power, and the alpha level. After all, you can only observe a false positive if the null hypothesis is true, and you can only observe a true positive if the alternative hypothesis is true. Whenever you perform a study, you are either operating in a reality where there is a true effect, or you are operating in a reality where there is no effect – but you don’t know in which reality you are.</p>
<p>When you perform studies, you will be aware of all outcomes of your studies (both the significant and the non-significant findings). When you read the literature, there is publication bias, and you often only have access to significant results. This is when thinking about the PPV (and the FPRP) becomes important. If we set the alpha level to 5%, in the long run 5% of studies where H0 is true (FP + TN) will be significant. But in a literature with only significant results, we do not have access to all true negatives, and it is
possible that the proportion of false positives in the literature is much larger than 5%.</p>
<p>If we continue the example above, we see there are 85 positive results (80 + 5) in the 200 studies. The false positive report probability is 5/85 = 0.0588. At the same time, the alpha of 5% guarantees that (in the long run) 5% of the 100 studies where the null hypothesis is true are Type 1 errors: 5%*100 = 0.05. This is also true. When we do 200 studies, at most 0.05*200 = 10 could possibly be false positives (if H0 was true in all experiments). In the 200 studies we performed (and where H0 was true in only 50% of the studies), the <strong>proportion of false positives for all experiments</strong> is only 2.5%. Thus, for all experiments you do, the proportion of false positives will, in the long run, never be higher than the Type I error rate set by the researcher (e.g., 5% when H0 is true in all experiments), but it can be lower (when H0 is true in less than 100% of the experiments).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ppvexample"></span>
<img src="images/PPVexample.png" alt='Screenshot of the output of the results of the PPV Shiny app by &lt;a href="http://shinyapps.org/apps/PPV/"&gt;Michael Zehetleitner and Felix Schönbrodt &lt;/a&gt;' width="100%"><p class="caption">
Figure 2.3: Screenshot of the output of the results of the PPV Shiny app by <a href="http://shinyapps.org/apps/PPV/">Michael Zehetleitner and Felix Schönbrodt </a>
</p>
</div>
<p><em>(Note: The FDR and FPRP are different abbreviations for the same thing)</em></p>
<p>People often say something like: “<em>Well, we all know 1 in 20 results in the published literature are Type 1 errors</em>”. You should be able to understand this is not true in practice, after learning about the positive predictive value. It also explains why the common <em>p</em>-value <a href="pvalue.html#misconception4">misconception</a> "If you have observed a significant finding, the probability that you have made a Type 1 error (a false positive) is 5%." is not correct. Even when we use a 5% alpha level, it is quite reasonable to assume much more than 5% of significant findings in the published literature are false positives. When in 100% of the studies you perform, the null hypothesis is true, and all studies are published, only <em>then</em> 1 in 20 studies, in the long run, are false positives (and the rest correctly reveal no statistically significant difference). In the scientific literature, the positive predictive value can be quite high, and under specific circumstances, it might even be so high that most published research findings are false. This will happen when researchers examine mostly studies where the null-hypothesis is true, with low power, or when the Type 1 error rate is inflated due to <em>p</em>-hacking or other types of bias.</p>
</div>
<div id="type-1-error-inflation" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Type 1 error inflation<a class="anchor" aria-label="anchor" href="#type-1-error-inflation"><i class="fas fa-link"></i></a>
</h2>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cooking"></span>
<img src="images/babbagecooking.jpg" alt='Quote from the 1830 book by Babbage Reflections on the Decline of Science in England And on Some of Its Causes available &lt;a href="https://www.gutenberg.org/files/1216/1216-h/1216-h.htm"&gt;here&lt;/a&gt;' width="100%"><p class="caption">
Figure 2.4: Quote from the 1830 book by Babbage Reflections on the Decline of Science in England And on Some of Its Causes available <a href="https://www.gutenberg.org/files/1216/1216-h/1216-h.htm">here</a>
</p>
</div>
<p>If you perform multiple comparisons, there is a risk that the Type 1 error rate inflates. When multiple comparisons are planned, in some cases it is possible to control the Type 1 error rate by lowering the alpha level for each individual analysis. The most widely known approach to control for multiple comparisons is the Bonferroni correction where the alpha level is divided by the number of tests that is performed <span class="citation">(<a href="references.html#ref-dunn_multiple_1961" role="doc-biblioref">Dunn, 1961</a>)</span>. However, researchers also often use informal data analysis strategies that inflate the Type 1 error rate. Babbage <span class="citation">(<a href="references.html#ref-babbage_reflections_1830" role="doc-biblioref">1830</a>)</span> already complained about these problematic practices in 1830, and two centuries later, they are still common. Barber <span class="citation">(<a href="references.html#ref-barber_pitfalls_1976" role="doc-biblioref">1976</a>)</span> provides an in depth discussion of a range of approaches, such as eyeballing the data to decide which hypotheses to test (sometimes called 'double dipping'), selectively reporting only those analyses that confirm predictions, and ignoring non-significant results, collecting many variables and performing multitudes of tests, or performing sub-group analyses when the planned analysis yields nonsignificant results, or after a nonsignificant prediction derive a new hypothesis that is supported by the data, and test the hypothesis on the data that the hypothesis was derived from (sometimes called HARKing <span class="citation">(<a href="references.html#ref-kerr_harking_1998" role="doc-biblioref">Kerr, 1998</a>)</span>). Many researchers admit to having used practices that inflate error rates <span class="citation">(<a href="references.html#ref-chin_questionable_2021" role="doc-biblioref">Chin et al., 2021</a>; <a href="references.html#ref-fiedler_questionable_2015" role="doc-biblioref">Fiedler &amp; Schwarz, 2015</a>; <a href="references.html#ref-john_measuring_2012" role="doc-biblioref">John et al., 2012</a>; <a href="references.html#ref-makel_both_2021" role="doc-biblioref">Makel et al., 2021</a>; <a href="references.html#ref-van_de_schoot_use_2021" role="doc-biblioref">van de Schoot et al., 2021</a>)</span>. I myself have used such practices in the first scientific article I published, before I was fully aware of how problematic this was - for an article we published several years later in which we reflect on this, see <span class="citation">Jostmann et al. (<a href="references.html#ref-jostmann_short_2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>For some paradigms, researchers have a lot of flexibility in how to compute the main dependent variable. Elson and colleagues examined 130 publications that use the Competitive Reaction Time Task, in which participants select the duration and intensity of blasts to be delivered to a competitor <span class="citation">(<a href="references.html#ref-elson_press_2014" role="doc-biblioref">Elson et al., 2014</a>)</span>. The task is used to measure 'aggressive behavior' in an ethical manner. To compute the score, researchers can use the duration of a noise blast, the intensity, or a combination therefore, averaged over any number of trials, with several possible transformations of the data. The 130 publications examined reported 157 different quantification strategies in total, showing that most calculations of the dependent variable were unique, used only in a single article. One might wonder why the same authors sometimes use different computations across articles. One possible explanation is that they used this flexibility in the data analysis to find statistically significant results.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:flexiblemeasure"></span>
<img src="images/flexiblemeasure.png" alt='Plot of publications using CRTT (blue) and unique quantifications of the meaure (red). Figure from FlexibleMeasures.com by &lt;a href="https://www.flexiblemeasures.com/crtt/index.php?menu=quantifications"&gt;Malte Elson&lt;/a&gt;' width="100%"><p class="caption">
Figure 2.5: Plot of publications using CRTT (blue) and unique quantifications of the meaure (red). Figure from FlexibleMeasures.com by <a href="https://www.flexiblemeasures.com/crtt/index.php?menu=quantifications">Malte Elson</a>
</p>
</div>
</div>
<div id="optional-stopping" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Optional stopping<a class="anchor" aria-label="anchor" href="#optional-stopping"><i class="fas fa-link"></i></a>
</h2>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:optionalstoppingexample"></span>
<img src="images/optionalstoppingexample.png" alt="Screenshot a scientific paper explicitly admitting to using optional stopping" width="100%"><p class="caption">
Figure 2.6: Screenshot a scientific paper explicitly admitting to using optional stopping
</p>
</div>
<p>One practice that inflates the Type 1 error rate is known as <strong>optional stopping</strong>. In optional stopping, a researcher repeatedly analyzes the data, continues the data collection when the test result is not statistically significant, but stops when a significant effect is observed. The quote from a published article in the figure above is an example where researchers transparently report they used optional stopping, but more commonly people do not disclose the use of optional stopping in their methods sections. Over the last years, many researchers have learned that optional stopping is problematic. This has in some lead to the general idea that you should not collect data, look at whether the results are significant, and stop data collection when the result is significant, or if not, continue data collection. That is not the correct conclusion, and is an example of becoming too inflexible. The correct approach to collect data in batches, called <strong>sequential analysis</strong>, has been extensively developed by statisticians, and is used in many studies. For example, the safety and efficacy of the Pfizer–BioNTech COVID-19 vaccine used an experimental design where they planned to analyze the data 5 times, and controlled the overall Type 1 error rate by lowering the alpha level for each interim analysis.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:interim"></span>
<img src="images/vaccinetrial.png" alt='Screenshot of the &lt;a href="https://www.nejm.org/doi/suppl/10.1056/NEJMoa2034577/suppl_file/nejmoa2034577_protocol.pdf"&gt;planned interim analyses&lt;/a&gt; examining the safety and Efficacy of the BNT162b2 mRNA Covid-19 Vaccine.' width="100%"><p class="caption">
Figure 2.7: Screenshot of the <a href="https://www.nejm.org/doi/suppl/10.1056/NEJMoa2034577/suppl_file/nejmoa2034577_protocol.pdf">planned interim analyses</a> examining the safety and Efficacy of the BNT162b2 mRNA Covid-19 Vaccine.
</p>
</div>
<p>The main lesson is that certain research practices can increase the flexibility and efficiency of studies you perform, when done right, but the same practices can inflate the Type 1 error rate when done wrong. Let’s therefore try to get a better understanding when we are inflating our Type 1 error rate with optional stopping, and how to do this correctly using sequential analysis.</p>
<p>Copy the code below into R and run it. This script will simulate an ongoing data collection. After 10 participants in each condition, a <em>p</em>-value is calculated by performing an independent <em>t</em>-test, and this <em>t</em>-test is then repeated after every additional participant that is collected. Then, all these <em>p</em>-values are plotted as a function of the increasing sample size.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span> <span class="co"># total number of datapoints (per condition) after initial 10</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.0</span> <span class="co"># effect size d</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># store p-values</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># store x-values</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># store y-values</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">+</span> <span class="fl">10</span> <span class="co"># add 10 to number of datapoints</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">10</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span> <span class="co"># for each simulated participants after the first 10</span>
  <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="va">d</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="va">n</span><span class="op">]</span> <span class="co"># Remove first 10 empty p-values</span>

<span class="co"># Create the plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">3</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">n</span><span class="op">)</span>, 
     type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"sample size"</span>, ylab <span class="op">=</span> <span class="st">"p-value"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">p</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.05</span>, col <span class="op">=</span> <span class="st">"darkgrey"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># draw line at p = 0.05</span>

<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="co"># Return lowest p-value from all looks</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"The lowest p-value was observed at sample size"</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"The p-value dropped below 0.05 for the first time at sample size:"</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span><span class="op">)</span>, <span class="st">"NEVER"</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>For example, in the Figure below, you see the <em>p</em>-value plotted on the y-axis (from 0 to 1) and the sample size plotted on the x-axis (from 0 to 200). For this simulation, the true effect size was d = 0, meaning there is no true effect. We can thus only observe true negatives or false positives. As the sample size increases, the <em>p</em>-value slowly moves up and down (remember from the chapter on <a href="#pvalues"><em>p</em>-values</a> that when there is no true effect, <em>p</em>-values are uniformly distributed). In Figure <a href="errorcontrol.html#fig:animatep">2.8</a>, the <em>p</em>-value drops below the grey line (indicating an alpha level 0.05) after collecting 83 participants in each condition, only to drift back upwards to larger <em>p</em>-values. From this figure, if becomes clear that the more often we look at the data, and the larger the total sample size, the higher the probability that one of the analyses will yield a p &lt; <span class="math inline">\(\alpha\)</span>. If resources are infinite, the Type 1 error rate will be 1, and a researcher can always find a significant result through optional stopping.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:animatep"></span>
<img src="02-errorcontrol_files/figure-html/animatep-.gif" alt="Simulated *p*-values for each additional observation when the null is true." width="100%"><p class="caption">
Figure 2.8: Simulated <em>p</em>-values for each additional observation when the null is true.
</p>
</div>
<p>When there <em>is</em> a true effect, we see that <em>p</em>-values also vary, but they will eventually drop to below the alpha level. Due to the variation, we just do not know exactly when. When we perform an a-priori power analysis, we can compute the probability that looking at a specific sample size will yield a significant <em>p</em>-value. In Figure <a href="errorcontrol.html#fig:animatep2">2.9</a> we see the same simulation, but now when there is a true but small effect of d = 0.3. With 200 observations per condition, a sensitivity power analysis reveals that we have 85% power. If we would analyze the data at an interim analysis (e.g., after 150 observations) we would often already find a statistically significant effect (as we would have 74% power). This illustrates a benefit of sequential analyses, where we control error rates, but can stop early at an interim analysis. Sequential analyses are especially useful in large or expensive studies where there is uncertainty about the true effect size.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:animatep2"></span>
<img src="02-errorcontrol_files/figure-html/animatep2-.gif" alt="Simulated *p*-values for each additional observation when d = 0.3." width="100%"><p class="caption">
Figure 2.9: Simulated <em>p</em>-values for each additional observation when d = 0.3.
</p>
</div>
<p>Let's more formally examine the inflation of the Type 1 error rate through optional stopping in a <strong>simulation study</strong>. Copy the code below into R and run the code. Note that the 50000 simulations (needed to get the error rates reasonably accurate) take some time to run.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># total datapoints (per condition)</span>
<span class="va">looks</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># set number of looks at the data</span>
<span class="va">nsims</span> <span class="op">&lt;-</span> <span class="fl">50000</span> <span class="co"># number of simulated studies</span>
<span class="va">alphalevel</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># set alphalevel</span>

<span class="kw">if</span><span class="op">(</span><span class="va">looks</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span>
  <span class="va">look_at_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="va">looks</span>, <span class="va">N</span>, <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="va">looks</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">looks</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>  <span class="kw">else</span> <span class="op">{</span>
    <span class="va">look_at_n</span> <span class="op">&lt;-</span> <span class="va">N</span>
<span class="op">}</span>
<span class="va">look_at_n</span><span class="op">&lt;-</span><span class="va">look_at_n</span><span class="op">[</span><span class="va">look_at_n</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">]</span> <span class="co">#Remove looks at N of 1 or 2</span>
<span class="va">looks</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">look_at_n</span><span class="op">)</span> <span class="co">#if looks are removed, update number of looks</span>

<span class="va">matp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">nsims</span>, ncol <span class="op">=</span> <span class="va">looks</span><span class="op">)</span> <span class="co"># Matrix for p-values l tests</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">nsims</span><span class="op">)</span> <span class="co"># Variable to save pvalues</span>

<span class="co"># Loop data generation for each study, then loop to perform a test for each N</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsims</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">looks</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">matp</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">look_at_n</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">look_at_n</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, 
                         var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co"># perform the t-test, store</span>
  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Loop"</span>, <span class="va">i</span>, <span class="st">"of"</span>, <span class="va">nsims</span>, <span class="st">"\n"</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Save Type 1 error rate smallest p at all looks</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsims</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">matp</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">matp</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;</span> <span class="va">alphalevel</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span>, 
                 <span class="va">matp</span><span class="op">[</span><span class="va">i</span>,<span class="va">looks</span><span class="op">]</span>, <span class="va">matp</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">matp</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;</span> <span class="va">alphalevel</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">p</span>, breaks <span class="op">=</span> <span class="fl">100</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="co"># create plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">nsims</span> <span class="op">/</span> <span class="fl">100</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Type 1 error rates for look 1 to"</span>, <span class="va">looks</span>, <span class="st">":"</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matp</span> <span class="op">&lt;</span> <span class="va">alphalevel</span><span class="op">)</span> <span class="op">/</span> <span class="va">nsims</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Type 1 error rate when only the lowest p-value for all looks is reported:"</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alphalevel</span><span class="op">)</span> <span class="op">/</span> <span class="va">nsims</span><span class="op">)</span></code></pre></div>
<p>This simulation will perform multiple independent <em>t</em>-tests on simulated data, looking multiple times until the maximum sample size is reached. In the first four lines, you can set the most important parameters of the simulation. First, the maximum sample size in each condition (e.g., 100). Then, the number of looks (e.g., 5). At best, you can look at the data after every participant (e.g., with 100 participants, you can look 100 times – or actually 98 times, because you need more than 2 participants in each condition for a <em>t</em>-test!). You can set the number of simulations (the more, the clearer the pattern will be, but the longer the simulation takes), and the alpha level (e.g., 0.05). Since you can only make a Type 1 error when there is no true effect, the effect size is set to 0 in these simulations.</p>
<p>When you perform only a single test, the Type 1 error rate is the probability of finding a <em>p</em>-value lower than your alpha level, when there is no effect. In an optional stopping scenario where you look at the data twice, the Type 1 error rate is the probability of finding a <em>p</em>-value lower than your alpha level at the first look, <strong>and</strong> the probability of <strong>not</strong> finding a <em>p</em>-value lower than your alpha level at the <strong>first</strong> look, but finding a <em>p</em>-value lower than your alpha level at the <strong>second</strong> look. This is a <em>conditional probability</em>, which makes error control a little bit more complex than when multiple looks are completely independent.</p>
<p>So how much does optional stopping inflate the Type 1 error rate? And which <em>p</em>-values can we expect under optional stopping?</p>
<p>Start by running the simulation without changing any values, so simulating 100 participants in each condition, looking 5 times at your data, with an alpha of 0.05. Note the 50.000 simulations take a while! You should see something similar to Figure <a href="errorcontrol.html#fig:optionalstopfig">2.10</a> below (which is based on 500.000 simulations to make the pattern very clear).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:optionalstopfig"></span>
<img src="02-errorcontrol_files/figure-html/optionalstopfig-1.png" alt="Simulation of 500000 studies performing 5 interim analyses at an alpha level of 5%" width="100%"><p class="caption">
Figure 2.10: Simulation of 500000 studies performing 5 interim analyses at an alpha level of 5%
</p>
</div>
<p>We see 100 bars, one for each % (so one for all <em>p</em>-values between 0.00 and 0.01, one for <em>p</em>-values between 0.01 and 0.02, etc.). There is a horizontal line that indicates where all <em>p</em>-values should fall, is they would be uniformly distributed (as they should be when there is no true effect, as explained in the chapter on <a href="#pvalues"><em>p</em>-values</a>).</p>
<p>The distribution of <em>p</em>-values is peculiar. We see that compared to a uniform distributions, a bunch of results just above the alpha threshold of 0.05 are missing, and they seem to have been pulled just below 0.05, where there is a much higher frequency of outcomes compared to when data is not analyzed multiple times as it comes in. Notice how relatively high <em>p</em>-values (e.g., <em>p</em> = 0.04) are more common than lower <em>p</em>-values (e.g., 0.01). We will see in the chapter on <a href="bias">bias detection</a> that statistical techniques such as <em>p</em>-curve analysis can pick up on this pattern.</p>
<p>When using an alpha level of 5% with 5 looks at the data, the overall Type 1 error rate has inflated to 14%. If we lower the alpha level at each interim analysis, the overall Type 1 error rate can be controlled. The shape of the <em>p</em>-value distribution will still look peculiar, but the total number of significant test results will be controlled at the desired alpha level. The well-known Bonferroni correction (i.e., using an alpha level of <span class="math inline">\(\alpha\)</span> / the number of looks), but the <a href="https://en.wikipedia.org/wiki/Pocock_boundary">Pocock correction</a> is slighlty more efficient. For more information on how to perform interim analyses while controlling error rates, see the dedicated chapter on <a href="#sequential">sequential analysis</a>.</p>
</div>
<div id="justifyerrorrate" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Justifying Error Rates<a class="anchor" aria-label="anchor" href="#justifyerrorrate"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>If we reject H0 , we may reject it when it is true; if we accept H0 , we may be accepting it when it is false, that is to say, when really some alternative Bt is true. These two sources of error can rarely be eliminated completely; in some cases it will be more important to avoid the first, in others the second. We are reminded of the old problem considered by LaplaceE of the number of votes in a court of judges that should be needed to convict a prisoner. Is it more serious to convict an innocent man or to acquit a guilty? That will depend upon the consequences of the error ; is the punishment death or fine ; what is the danger to the community of released criminals ; what are the current ethical views on punishment? From the point of view of mathematical theory all that we can do is to show how the risk of the errors may be controlled and minimised. The use of these statistical tools in any given case, in determining just how the balance should be struck, must be left to the investigator.</p>
</blockquote>
<p>Even though in <em>theory</em> the Type 1 and Type 2 error rate should be justified by the researcher, as Neyman and Pearson <span class="citation">(<a href="references.html#ref-neyman_problem_1933" role="doc-biblioref">1933</a>)</span> write above, in <em>practice</em> researchers tend to imitate others. The default use of an alpha level of 0.05 can already be found in work} of Gosset on the <em>t</em>-distribution <span class="citation">(<a href="references.html#ref-cowles_origins_1982" role="doc-biblioref">Cowles &amp; Davis, 1982</a>; <a href="references.html#ref-kennedy-shaffer_before_2019" role="doc-biblioref">Kennedy-Shaffer, 2019</a>)</span>, who believed that a difference of two standard deviations (a z-score of 2) was sufficiently rare. The default use of 80% power (or a 20% Type 2 error rate) is similarly based on personal preferences by <span class="citation">Cohen (<a href="references.html#ref-cohen_statistical_1988" role="doc-biblioref">1988</a>)</span>, who writes:</p>
<blockquote>
<p>It is proposed here as a convention that, when the investigator has no other basis for setting the desired power value, the value .80 be used. This means that beta is set at .20. This value is offered for several reasons (Cohen, 1965, pp. 98-99). The chief among them takes into consideration the implicit convention for alpha of .05. The beta of .20 is chosen with the idea that the general relative seriousness of these two kinds of errors is of the order of .20/.05, i.e., that Type I errors are of the order of four times as serious as Type II errors. This .80 desired power convention is offered with the hope that it will be ignored whenever an investigator can find a basis in his substantive concerns in his specific research investigation to choose a value ad hoc.</p>
</blockquote>
<p>We see that conventions are built on conventions: the norm to aim for 80% power is built on the norm to set the alpha level at 5%. Although there is nothing special about an alpha level of 5%, it is interesting to reflect on why it has become so widely established. <span class="citation">Uygun Tunç et al. (<a href="references.html#ref-uygun_tunc_epistemic_2021" role="doc-biblioref">2021</a>)</span> argue that one possible reason is that, as far as conventions go, an alpha level of 5% might be low enough such that peers take any claims made with this error rate seriously, while at the same time being high enough such that peers will be motivated to perform an independent replication study to increase or decrease our confidence in the claim. Although lower error rates would establish claims more convincingly, this would also require more resources. One might speculate
that in research areas where not every claim is important enough to a careful justification of costs and benefits, 5% has a pragmatic function in facilitating conjectures and refutations in fields that otherwise lack a coordinated approach to knowledge generation, but are faced with limited resources.</p>
<p>Nevertheless, some researchers have proposed to move away from the default use of a 5% alpha level. For example, <span class="citation">Johnson (<a href="references.html#ref-johnson_revised_2013" role="doc-biblioref">2013</a>)</span> proposes a default significance level of 0.005 or 0.001. Others have cautioned against such blanket recommendation because the additional resources required to reduce the Type 1 error rate might not be worth the costs <span class="citation">(<a href="references.html#ref-lakens_justify_2018" role="doc-biblioref">Lakens, Adolfi, et al., 2018</a>)</span>. A lower alpha lever requires a larger sample size to achieve the same sstatistical power. If the sample size can not be increased, a lower alpha level reduces the statistical power, and increases the Type 2 error rate. Whether that is desireable should be evaluated on a case by case basis.</p>
<p>There are two main reasons to abandon the universal use of a 5% alpha level. The first reason to carefully choose an alpha level is that decision-making becomes more efficient <span class="citation">(<a href="references.html#ref-mudge_setting_2012" role="doc-biblioref">Mudge et al., 2012</a>)</span>. If researchers use hypothesis tests to make dichotomous decisions from a methodological falsificationist approach to statistical inferences, and have a certain maximum sample size they are willing or able to collect, it is typically possible to make decisions more efficiently by choosing error rates such that the combined cost of Type 1 and Type 2 errors is minimized. If we aim to either minimize or balance Type 1 and Type 2 error rates for a given sample size and effect size, the alpha level should be set not based on convention, but by weighting the relative cost of both types of errors <span class="citation">(<a href="references.html#ref-maier_justify_2022" role="doc-biblioref">Maier &amp; Lakens, 2022</a>)</span>.</p>
<p>For example, imagine a researcher plans to collect 64 participants per condition to detect a d = 0.5 effect, and weighs the cost of Type 1 errors 4 times as much as Type 2 errors. This is exactly the scenario Cohen (1988) described, and with 64 participants per condition the relative weigfht of Type 1 and Type 2 errors yields a 5% Type 1 error rate and a 20% Type 2 error rate. Now imagine this researchers realizes they have the resources to collect 80 observations instead of just 64. With an interest in an effect size of d = 0.5, the relative weight of Type 1 and Type 2 errors of 4 would be satisfied when they set the alpha level to 0.037 as then the the Type 2 error rate is 0.147. Alternatively, the researcher might have decided to collect 64 observations, but not balance the error rates, but set the alpha level such that the weighted combined error rate is minimized, which is achieved when the alpha level is set to 0.033, as vizualized in Figure <a href="errorcontrol.html#fig:minimizeerror">2.11</a> (for further information, see <span class="citation">Maier &amp; Lakens (<a href="references.html#ref-maier_justify_2022" role="doc-biblioref">2022</a>)</span>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:minimizeerror"></span>
<img src="02-errorcontrol_files/figure-html/minimizeerror-1.png" alt="Weighted combined error rate, minimized at alpha = 0.037." width="100%"><p class="caption">
Figure 2.11: Weighted combined error rate, minimized at alpha = 0.037.
</p>
</div>
<p>Justifying error rates can leads to situations where the alpha level is increased above 0.05, because this leads to more optimal decision making. Winer (1962) writes: “The frequent use of the .05 and .01 levels of significance is a
197 matter of convention having little scientific or logical basis. When the power of tests is likely to be low under these levels of significance, and when Type 1 and Type 2 errors are of approximately equal importance, the .30 and .20 levels of significance may be more appropriate than the .05 and .01 levels.” The reasoning here is that a design that has 70% power for the smallest effect size of interest would not balance the Type 1 and Type 2 error rates in a sensible manner. Of course, such an increase An increase of the alpha level should only be deemed acceptable when authors can justify that the costs of the increase in the Type 1 error rate is sufficiently compensated by the benefit of decreased Type 2 error rate. This will encompass cases where (1) the study will have practical implications that require decision making, (2) a cost-benefit analysis is provided that gives a clear rationale for relatively high costs of a Type 2 error, (3) the probability that H1 is false is relatively low, and (4) it is not feasible to blackuce overall error rates by collecting more data.</p>
<p>One should also carefully reflect on the choice of the alpha level when an experiment achieves very high statistical power for all effect sizes that are considered meaningful. If a study has 99% power for effect sizes of interest, and thus a 1% Type 2 error rate, but uses the default 5% alpha level, it also suffers from a lack of balance, and the use of a lower alpha level would lead to a more balanced decision, and increase the severity of the test.</p>
<p>The second reason is most relevant for large data sets, and is related to <a href="pvalue.html#lindley">Lindley's paradox</a>. As the statistical power increases, some <em>p</em>-values below 0.05 (e.g., <em>p</em> = 0.04) can be more likely when there is <em>no</em> effect than when there <em>is</em> an effect. To prevent situations where a frequentist rejects the null hypothesis based on <em>p</em> &lt; 0.05, when the evidence in the test favors the null hypothesis over the alternative hypothesis, it is recommended to lower the alpha level as a function of the sample size. The need to do so is discussed by <span class="citation">Leamer (<a href="references.html#ref-leamer_specification_1978" role="doc-biblioref">1978</a>)</span>, who writes "The rule of thumb quite popular now, that is, setting the significance level arbitrarily to .05, is shown to be deficient in the sense that from every reasonable viewpoint the significance level should be a decreasing function of sample size." The idea of this approach is to reduce the alpha level such that a Bayes factor or likelihood computed for the a significant results would never be evidence <em>for</em> the null hypothesis (for an online Shiny app to perform such calculations, see <a href="https://shiny.ieis.tue.nl/JustifyAlpha/">here</a> or the app below).</p>
<iframe src="https://shiny.ieis.tue.nl/JustifyAlpha/" width="100%" height="400px" data-external="1">
</iframe>
</div>
<div id="why-you-dont-need-to-adjust-your-alpha-level-for-all-tests-youll-do-in-your-lifetime." class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Why you don't need to adjust your alpha level for all tests you'll do in your lifetime.<a class="anchor" aria-label="anchor" href="#why-you-dont-need-to-adjust-your-alpha-level-for-all-tests-youll-do-in-your-lifetime."><i class="fas fa-link"></i></a>
</h2>
<p>Some researchers criticize corrections for multiple comparisons because one might as well correct for all tests you do in your lifetime [<span class="citation">Perneger (<a href="references.html#ref-perneger_whats_1998" role="doc-biblioref">1998</a>)</span>. If you choose to use a Neyman-Pearson approasch to statistics the only reason to correct for all tests you perform in your lifetime is when all the work you have done in your life tests a single theory, and you would use your last words to decide to accept or reject this theory, as long as only one of all individual tests you have performed yielded a p &lt; α. Researchers rarely work like this.</p>
<p>Instead, in a Neyman-Pearson approach to hypothesis testing, the goal is to use data to make decisions about how to act. Neyman <span class="citation">(<a href="references.html#ref-neyman_inductive_1957" role="doc-biblioref">Neyman, 1957</a>)</span> calls his approach <strong>inductive behavior</strong>. The outcome of an experiment leads one to take different possible actions, which can be either practical (e.g., implement a new procedure, abandon a research line) or scientific (e.g., claim there is or is no effect). From an error-statistical approach <span class="citation">(<a href="references.html#ref-mayo_statistical_2018" role="doc-biblioref">Mayo, 2018</a>)</span> inflated Type 1 error rates mean that it has become very likely that you will be able to claim support for your hypothesis, even when the hypothesis is wrong. This reduces the severity of the test. To prevent this, we need to control our error rate at the level of our claim.</p>
<p>A useful distinction in the literature on multiple testing is a <strong>union-intersection</strong> testing approach, and a <strong>intersection-union</strong> testing approach <span class="citation">(<a href="references.html#ref-dmitrienko_traditional_2013" role="doc-biblioref">Dmitrienko &amp; D’Agostino Sr, 2013</a>)</span>. In a union-intersection approach, a claim is made when <em>at-least-one</em> test is significant. In these cases, a correction for multiple comparisons is required to control the error rate. In a intersection-union approach, a claim is made when all performed tests are statistically significant, and no correction for multiple comparisons is required (and indeed, under some assumptions researchers could even <em>increase</em> the alpha level in a intersection-union approach).</p>
<p>It might seem if researchers can get out of corrections for multiple comparisons by formulating a hypothesis for every possible test they will perform. Indeed, they can. For a ten by ten correlation matrix, a researcher might state they are testing 45 unique predictions, each at an uncorrected alpha level. However, readers might reasonably question whether these 45 tests were predicted by a theory, and if only a few of the 45 tests show a significant result, the meager track record of the predictions should make us doubt the theory they were derived from. There are different ways to control for error rates, the easiest being the Bonferroni correction an the ever-so-slightly less conservative Holm-Bonferroni sequential procedure. When the number of statistical tests becomes substantial, it is sometimes preferable to control false discovery rates, instead of error rates <span class="citation">(<a href="references.html#ref-benjamini_controlling_1995" role="doc-biblioref">Benjamini &amp; Hochberg, 1995</a>)</span>.</p>
</div>
<div id="power-analysis" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Power Analysis<a class="anchor" aria-label="anchor" href="#power-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>So far we have largely focused on Type 1 error control. As was clear from Figure <a href="errorcontrol.html#fig:animatep2">2.9</a>, when there is a true effect <em>p</em>-values will eventually become smaller than an alpha level as the sample size becomes large enough. When designing an experiment the goal is to choose a sample size that provides a desired Type 2 error rate for an effect size of interest. This can be achieved by performing an a-priori power analysis. It is important to highlight that the goal of an a-priori power analysis is <em>not</em> to achieve sufficient power for the true effect size. The true effect size is always unknown when designing a study. The goal of an a-priori power analysis is to achieve sufficient power, given a specific <em>assumption</em> of the effect size a researcher wants to detect. Just like a Type I error rate is the maximum probability of making a Type I error conditional on the assumption that the null hypothesis is true, an a-priori power analysis is computed under the assumption of a specific effect size. It is unknown if this assumption is correct. All a researcher can do is to make sure their assumptions are well justified. Statistical inferences based on a test where the Type II error is controlled are conditional on the assumption of a specific effect size. They allow the inference that, assuming the true effect size is at least as large as that used in the a-priori power analysis, the maximum Type II error rate in a study is not larger than a desired value.</p>
<p>In Figure <a href="errorcontrol.html#fig:powerd">2.12</a> we see the expected distribution of observed standardized effect sizes (Cohen's d) for an independent <em>t</em>-test with 50 observations in each condition. The bell-shaped curve on the left represents the expectations if the null is true, and the red areas in the tail represent Type 1 errors. The bell-shaped curve on the right represents the expectations if the alternative hypothesis is true, and d= 0.5. The vertical line at d = 0.4 represents the <strong>critical effect size</strong>. With this sample size and an alpha level of 0.05, observed effect sizes smaller than d = 0.4 will not be statistically significant. If there is a true effect, these outcomes will be Type 2 errors, illustrated by the blue shaded area. The remainder of the curve reflects true positives, when there is a true effect, and the observed effect sizes is statistically significant. The power of the test is the percentages of the distribution on the right that is larger than the critical value.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:powerd"></span>
<img src="02-errorcontrol_files/figure-html/powerd-1.png" alt="Distribution of d = 0 and d = 0.5 for an independent *t*-test with n = 50." width="100%"><p class="caption">
Figure 2.12: Distribution of d = 0 and d = 0.5 for an independent <em>t</em>-test with n = 50.
</p>
</div>
<p>The issue of Type 2 error control will be discussed in more detail in the chapter on sample size justification. Even thought the topic of Type 2 error control is only briefly discussed here, it is at least as important as Type 1 error control. An informative study should have a high probability of observing an effect if there is an effect. Indeed, the default recommendation to aim for 80% power leaves a surprisingly large (20%) probability of a Type 2 error. If a researcher only cares about not making a decision error, but the researcher does not care about whether this decision error is a false positive or a false negative, an argument could be made that Type 1 and Type 2 errors are weighed equally. Therefore, desiging a study with balanced error rates (e.g., a 5% Type 1 error and 95% power) would make sense.</p>
</div>
<div id="test-yourself-1" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Test Yourself<a class="anchor" aria-label="anchor" href="#test-yourself-1"><i class="fas fa-link"></i></a>
</h2>
<div id="questions-about-the-positive-predictive-value" class="section level3" number="2.7.1">
<h3>
<span class="header-section-number">2.7.1</span> Questions about the positive predictive value<a class="anchor" aria-label="anchor" href="#questions-about-the-positive-predictive-value"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Q1</strong>: In the example at the start of this chapter, we see that we control the Type 1 error rate at 5% by using an alpha of 0.05. Still, when there is a 50% probability that H0 is true, the proportion of false positives for all experiments performed turns out to be much lower, namely 2.5%, or 0.025. Why?</p>
<ol style="list-style-type: upper-alpha">
<li>The proportion of false positives for all experiments we have performed is a variable with a distribution around the true error rate – sometimes it’s higher, sometimes it’s lower, due to random variation.</li>
<li>The proportion of false positives for all experiments we have performed is only 5% when H0 is true for all 200 studies.</li>
<li>The proportion of false positives for all experiments we have performed is only 5% when you have 50% power – if power increases above 50%, the proportion of false positives for all experiments we have performed becomes smaller.</li>
<li>The proportion of false positives for all experiments we have performed is only 5% when you have 100% power, and it becomes smaller if power is lower than 100%.</li>
</ol>
<p><strong>Q2</strong>: What will make the biggest difference in improving the probability that you will find a true positive? Check your answer by shifting the sliders in the online PPV app.</p>
<ol style="list-style-type: upper-alpha">
<li>Increase the % of a-priori true hypotheses</li>
<li>Decrease the % of a-priori true hypotheses</li>
<li>Increase the alpha level</li>
<li>Decrease the alpha level</li>
<li>Increase the power</li>
<li>Decrease the power</li>
</ol>
<p>Increasing the power requires bigger sample sizes, or studying larger effects. Increasing the % of a-priori true hypotheses can be done by making better predictions – for example building on reliable findings, and relying on strong theories. These are useful recommendations if you want to increase the probability of performing studies where you find a statistically significant result.</p>
<p><strong>Q3</strong>: Set the “% of a priori true hypotheses” slider to 50%. Leave the ‘α level’ slider at 5%. Leave the ‘% of p-hacked studies’ slider at 0. The title of Ioannidis’ paper is ‘why most published research findings are false’. One reason might be that studies often have low power. At which value for power is the PPV 50%. In other words, at which level of power is a significant result just as likely to be true, as that it is false?</p>
<ol style="list-style-type: upper-alpha">
<li>80%</li>
<li>50%</li>
<li>20%</li>
<li>5%</li>
</ol>
<p>It seems low power alone is not the best explanation for why most published findings might be false, as it is unlikely that power is low enough in the scientific literature. Ioannidis (2005) discusses some scenarios under which it becomes likely that most published research findings are false. Some of these assume that ‘p-hacked studies’, or studies that show a significant result due to bias, enter the literature. There are good reasons to believe this happens, as we discussed in this chapter. In the ‘presets by Ioannidis’ dropdown menu, you can select some of these situations. Explore all of them, and pay close attention to the ones where the PPV is smaller than 50%.</p>
<p><strong>Q4</strong>: In general, when are most published findings false? Interpret ‘low’ and ‘high’ in the answer options below in relation to the values in the first example in this chapter of 50% probability H1 is true, 5% alpha, 80% power,
and 0% bias.</p>
<ol style="list-style-type: upper-alpha">
<li>When the probability of examining a true hypothesis is low, combined with either low power or substantial bias (e.g., p-hacking).</li>
<li>When the probability of examining a true hypothesis is high, combined with either low power or substantial bias (e.g., p-hacking).</li>
<li>When the alpha level is high, combined with either low power or substantial bias (e.g., p-hacking).</li>
<li>When power is low and p-hacking is high (regardless of the % of true hypotheses one examines).</li>
</ol>
<p><strong>Q5</strong>: Set the “% of a priori true hypotheses” slider to 0%. Set the “% of p-hacked studies” slider to 0%. Set the “α level” slider to 5%. Play around with the power slider. Which statement is true?
<strong>Without <em>p</em>-hacking, when the alpha level is 5%, and when 0% of the hypotheses are true, </strong></p>
<ol style="list-style-type: upper-alpha">
<li>the proportion of false positives for all experiments we have performed is 100%.</li>
<li>the PPV depends on the power of the studies.</li>
<li>regardless of the power, the PPV equals the proportion of false positives for all experiments we have performed.</li>
<li>regardless of the power, the proportion of false positives for all experiments we have performed is 5%, and the PPV is 0% (all significant results are false positives).</li>
</ol>
</div>
<div id="questions-about-optional-stopping" class="section level3" number="2.7.2">
<h3>
<span class="header-section-number">2.7.2</span> Questions about optional stopping<a class="anchor" aria-label="anchor" href="#questions-about-optional-stopping"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Q1</strong>: Run the script that plots the <em>p</em>-value as the sample size increases 20 times, and count how often the lowest <em>p</em>-value ends up below 0.05 (we will calculate the long run probability of this happening through more extensive simulations later).</p>
<p><strong>Q2</strong>: If there is a true effect, we can only observe a true positive or a false negative. Change the effect size from d &lt;- 0.0 to d &lt;- 0.3. This is a relatively small true effect, and with 200 participants in each condition, we have 85% power (or an 85% probability of finding a significant effect). Run the script again. Below is one possible example of the trajectory of <em>p</em>-values as the sample size increases. Run the script 20 times. Take a good look at the variation in the <em>p</em>-value trajectory. Remember that at N = 200, 85% of the times the <em>p</em>-value should have ended up below 0.05. The script returns the sample size the <em>p</em>-value is the lowest (which is often, but not always, at the maximum sample size, when there is a true effect) and the sample size at which the <em>p</em>-value drops below 0.05 for the first time. Which statement is true?</p>
<ol style="list-style-type: upper-alpha">
<li>If the <em>p</em>-value drops below 0.05, it stays below 0.05.</li>
<li>The <em>p</em>-value randomly moves between 0 and 1, and will every now and then end up below 0.05.</li>
<li>The <em>p</em>-value often drops below 0.05 well before 200 participants in each
condition. In around 50% of the simulations, this already happens at N = 100.</li>
<li>The <em>p</em>-value will typically move below 0.05 and stay there for some time,
but given a large enough sample, it will always move back up to <em>p</em> &gt; 0.05.</li>
</ol>
<p><strong>Q3</strong>: Change the effect size d &lt;- 0.8, which can be regarded as a large effect. Run the script 20 times. Take a good look at the variation in the <em>p</em>-value trajectory. Which statement is true?</p>
<ol style="list-style-type: upper-alpha">
<li>The <em>p</em>-value randomly moves between 0 and 1, and will every now and then end up below 0.05.</li>
<li>The <em>p</em>-values drop below and stay below 0.05 much earlier than when the true effect size is 0.3.</li>
<li>
<em>p</em>-values are meaningful when effect sizes are large (e.g., d = 0.8), but meaningless when effect sizes are small (e.g., d = 0.3).</li>
<li>When you examine a large effect, whenever a <em>p</em>-value drops below 0.05, it will always stay below 0.05 as the sample size increases.</li>
</ol>
<p><strong>Q4</strong>: Looking at Figure <a href="errorcontrol.html#fig:optionalstopfig">2.10</a>, which statement is true?</p>
<ol style="list-style-type: upper-alpha">
<li>Optional stopping does not impact the Type 1 error rate.</li>
<li>Optional stopping inflates the Type 1 error rate. We can see this in the first five bars (<em>p</em>-values between 0.00 and 0.05), which are substantially higher than the horizontal line.</li>
<li>Optional stopping inflates the Type 1 error rate. We can see this in the bars just above 0.05, which dip substantially below the uniform distribution that should be present if there is no true effect.</li>
</ol>
<p><strong>Q5</strong>: The script to simulate optional stopping provides written output. One summary gives you the Type 1 error rate for each individual look. One summary gives the Type 1 error rate when optional stopping is used. When running the script with the default values, which statement is true?</p>
<ol style="list-style-type: upper-alpha">
<li>At each look, the Type 1 error rate is higher than the alpha level (0.05).
When using optional stopping (and reporting only the lowest <em>p</em>-value), the Type 1 error rate is higher than 0.05.</li>
<li>At each look, the Type 1 error rate is approximately equal to the alpha level (0.05). When using optional stopping (and reporting only the lowest <em>p</em>-value), the alpha level also approximately equals the alpha level (0.05).</li>
<li>At each look, the Type 1 error rate is approximately equal to the alpha level (0.05). When using optional stopping, the Type 1 error rate is also higher than the alpha level (0.05).</li>
</ol>
<p><strong>Q6</strong>: Change the number of looks in the simulation to <strong>2</strong> (change 'looks &lt;- 5' to 'looks &lt;- 2'), and leave all other settings the same. Run the simulation again. What is the Type 1 error rate using optional stopping with only 1 interim analysis, rounded to 2 digits? (Note that due to small number of simulations, the exact alpha level you get might differ a little bit from the
answer options below).</p>
<ol style="list-style-type: upper-alpha">
<li>0.05</li>
<li>0.08</li>
<li>0.12</li>
<li>0.18</li>
</ol>
<p><strong>Q7</strong>: As Wagenmakers <span class="citation">(<a href="references.html#ref-wagenmakers_practical_2007" role="doc-biblioref">2007</a>)</span> notes: <em>“a user of NHST could always obtain a significant result through optional stopping (i.e., analyzing the data as they accumulate and stopping the experiment whenever the p-value reaches some desired significance level)”</em>. This is correct. It’s true that the <em>p</em>-value will always drop below the alpha level at some point in time. But, we need a rather large number of observations. We can calculate the maximum Type 1 error rate due to optional stopping for any maximum sample size. For example, what is the maximum Type 1 error rate when optional stopping is used when collecting 200 participants in each condition, and looking 200 times (or 198 times, given that you can’t perform a <em>t</em>-test on a sample size of 1 or 2 people)? Set the number of participants to <strong>200</strong>, the number of looks to <strong>200</strong>, the number of simulations to <strong>10000</strong> (this simulation will take even longer!), and the alpha to <strong>0.05</strong>.</p>
<p>What is maximum Type 1 error rate when collecting 200 participants in each
condition of an independent <em>t</em>-test, using optional stopping, rounded to 2
digits? (Note that the simulation will take a while, but still, due to the
relatively small number of simulations, the exact alpha level you get might
differ a little bit from the answer options below – choose the answer option
closest to your result).</p>
<ol style="list-style-type: upper-alpha">
<li>0.05</li>
<li>0.11</li>
<li>0.20</li>
<li>0.41</li>
</ol>
<p><strong>Q8</strong>: At Wikipedia, look at the entry about the Pocock boundary: <a href="https://en.wikipedia.org/wiki/Pocock_boundary" class="uri">https://en.wikipedia.org/wiki/Pocock_boundary</a> . There are ethical reasons to look at the data, while data is being collected. These are clear in medicine, but similar arguments can be made for other research areas (see Lakens, 2014). Researchers often want to look at the data multiple times. This is perfectly fine, as long as they design a study with a number of looks in advance, and control their Type 1 error rate.</p>
<p>The Pocock boundary provides a very easy way to control the type 1 error rate in sequential analyses. Sequential analysis is the formal way to do optional stopping. Researchers should use a slightly lower alpha level for each look, the make sure the overall alpha level (after all looks) is not larger than 5%.</p>
<p>Set the number of participants to <strong>100</strong>, the number of looks to <strong>5</strong>, and
the number of simulations to <strong>50000</strong> (so back to the original script). In the Wikipedia article on the Pocock boundary, find the corrected alpha level for 5 looks at the data. Change the alpha level in the simulation to this value. Run the simulation. Which of the following statements is true?</p>
<ol style="list-style-type: upper-alpha">
<li>The Type 1 error rate at each look is approximately 0.03, and the overall alpha level is approximately 0.05.</li>
<li>The Type 1 error rate at each look is approximately 0.03, and the overall alpha level is approximately 0.15.</li>
<li>The Type 1 error rate at each look is approximately 0.016, and the overall alpha level is approximately 0.05.</li>
<li>The Type 1 error rate at each look is approximately 0.016, and the overall alpha level is approximately 0.08.</li>
</ol>
<p><strong>Q9</strong>: Look at the graph of the <em>p</em>-value distribution when using the Pocock boundary, and compare it to the graph you got when not using the Pocock boundary. You can flip back and forth between plots you have generated in RStudio using the blue arrows on the plots tab. Which statement is true?</p>
<ol style="list-style-type: upper-alpha">
<li>
<strong>Without</strong> Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are
<strong>more</strong> likely than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04). <strong>With</strong>
Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are <strong>also more</strong>
likely than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04).</li>
<li>
<strong>Without</strong> Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are
<strong>more</strong> likely than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04). <strong>With</strong>
Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are <strong>less</strong> likely
than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04).</li>
<li>
<strong>Without</strong> Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are
<strong>less</strong> likely than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04). <strong>With</strong>
Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are <strong>more</strong> likely
than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04).</li>
<li>
<strong>Without</strong> Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are
<strong>less</strong> likely than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04). <strong>With</strong>
Pocock’s boundary, <strong>small</strong> <em>p</em>-values (e.g., <em>p</em> = 0.01) are <strong>also less</strong>
likely than slightly <strong>higher</strong> <em>p</em>-values (<em>p</em> = 0.04).</li>
</ol>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pvalue.html"><span class="header-section-number">1</span> Using p-values to test a hypothesis</a></div>
<div class="next"><a href="likelihoods.html"><span class="header-section-number">3</span> Likelihoods</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#errorcontrol"><span class="header-section-number">2</span> Error control</a></li>
<li><a class="nav-link" href="#positive-predictive-value"><span class="header-section-number">2.1</span> Positive predictive value</a></li>
<li><a class="nav-link" href="#type-1-error-inflation"><span class="header-section-number">2.2</span> Type 1 error inflation</a></li>
<li><a class="nav-link" href="#optional-stopping"><span class="header-section-number">2.3</span> Optional stopping</a></li>
<li><a class="nav-link" href="#justifyerrorrate"><span class="header-section-number">2.4</span> Justifying Error Rates</a></li>
<li><a class="nav-link" href="#why-you-dont-need-to-adjust-your-alpha-level-for-all-tests-youll-do-in-your-lifetime."><span class="header-section-number">2.5</span> Why you don't need to adjust your alpha level for all tests you'll do in your lifetime.</a></li>
<li><a class="nav-link" href="#power-analysis"><span class="header-section-number">2.6</span> Power Analysis</a></li>
<li>
<a class="nav-link" href="#test-yourself-1"><span class="header-section-number">2.7</span> Test Yourself</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#questions-about-the-positive-predictive-value"><span class="header-section-number">2.7.1</span> Questions about the positive predictive value</a></li>
<li><a class="nav-link" href="#questions-about-optional-stopping"><span class="header-section-number">2.7.2</span> Questions about optional stopping</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/Lakens/statistical_inferences/blob/master/02-errorcontrol.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/Lakens/statistical_inferences/edit/master/02-errorcontrol.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Improving Your Statistical Inferences</strong>" was written by Daniel Lakens. It was last built on 2022-03-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
